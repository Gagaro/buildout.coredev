PLIP 11300: Switch to HTML 5 
============================

PLIP ticket: https://dev.plone.org/plone/ticket/11300

Review #2 by Alec Mitchell (alecpm@gmail.com, alecm on irc)

The PLIP was reviewed on Mac OS X 10.6.7 using python 2.6.6 and Google
Chrome 12.0.742.100.


Review steps
------------

- Ran buildout with plip11300-switch-to-html5.cfg.

- Reviewed code differences from trunk in Products.CMFPlone

- Reviewed code differences from trunk in plone.app.layout

- Reviewed code differences from trunk in plonetheme.sunburst

- Ran tests for Products.CMFPlone.

- Ran tests for plone.app.layout.

- Ran tests for plonetheme.sunburst.

- Started instance.

- Ran front page html (logged-in and anonymous) through
  html5.validator.nu and w3c validators.

- Reviewed cod differences from trunk in plone.app.kss,
  Products.ResourceRegistries and kss.core.


Notes and observations
----------------------

- The main html tag appears to be inside of an IE conditional comment,
  but with some additional comment elements in the middle.  This
  smells a bit like a browser hack to me. The latest updates to the
  Paul Irish link appears to be a little cleaner.  They include an IE9
  class just in case, and also use a !(IE) condition (if only for
  additional clarity).  The current conditional tags are a little
  confusing, even if they work and validate.

- The changes in plone.app.layout look reasonable.

- The changes in plonetheme.sunburst look reasonable, but there's a
  merge confilct line hanging around in CHANGES.txt

- The test failure in
  Products.CMFPlone.tests.testMigrationTool.TestMigrationTool.testDoUpgrades
  appears to have been corrected.  There were no other test failures
  in any of the relevant packages.

- The w3c validator complains about the use of an undeclared &mdash;
  entity in the page title.

- The html5.validator.nu validator runs cleanly.

- The changes in plone.app.kss look reasonable.  The KSS base link
  is now type "alternate" and include an attribute
  "data-kss-base-url" which appears to validate. 

- The changes in Products.ResourceRegistries look reasonable.  The kss
  links are type "stylesheet" with custom "data-rel" and "type"
  atteributes, they also appear to validate.

- There don't appear to be any changes in kss.core, which is probably
  for the best.

- KSS features appear to work properly.


Conclusion
----------

I think this PLIP is ready for merge.

I'd like to see a cleaner/clearer version of the conditional comment
hack on the html tag, but it's not a blocker.  The link in the source
provides what appear to be some nice improvements over the current
implementation.  Specifically, half way down in that blog post after
the text "2010.09.07: Update follows!" is the following suggestion:

<!--[if lt IE 7 ]> <html class="ie6"> <![endif]-->
<!--[if IE 7 ]>    <html class="ie7"> <![endif]-->
<!--[if IE 8 ]>    <html class="ie8"> <![endif]-->
<!--[if IE 9 ]>    <html class="ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html class=""> <!--<![endif]-->

This appears to be a little clearer to me and apparently fixes some
minor bugs with the original code.  This is also apparently the latest
code from his HTML5 Boilerplate.

Denys's explanation about the use of modernizr, combined with the fact
that it's already being relied upon by another PLIP, leaves me
satisfied with its inclusion.
