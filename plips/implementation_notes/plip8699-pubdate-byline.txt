PLIP #8699 implementation notes (Make byline use the publication date)
======================================================================

Implementer: Vitaliy Podoba
PLIP text: http://dev.plone.org/ticket/8699

Reference buildout is at git://github.com/plone/buildout.coredev.git; run with
-c plips/plip8699-pubdate-byline.cfg. 

I updated PLIP description a bit according to suggestions I received on plone
devel mailing list:

* basically we display Effective Date if it's been set
* otherwise we fallback to publish transition date taken directly from workflow
  history

In order to complete the task I modified the next packages:

* plone.app.layout: extended document byline viewlet with publication date,
  added tests. All went into dedicated plip branch:
  https://github.com/plone/plone.app.layout/commit/eac4d4596f794f6c3dd32de001be9f597f5e76e2
* plone.app.controlpanel: added 'Display publication date' setting to Security
  control panel, right after 'Show Byline' option. All went into dedicated plip branch:
  https://github.com/plone/plone.app.controlpanel/commit/75aba70d6170901a4a60d9581110eb09ca958eae
* Products.CMFPlone: added new property to portal properties tool to control
  publication date visibility, added tests. All went directly into 4.3 branch
  (master):
  https://github.com/plone/Products.CMFPlone/commit/da0da454c8dbcfbd38e298b09574ec261ccdf344
* plone.app.upgrade: added migration profile 4.2->4.3alpha1 containing above
  mentioned property addition. All went directly into master branch:
  https://github.com/plone/plone.app.upgrade/commit/90d84e1ad17efa211aca172c08ea4ab59ee6fe89

What I haven't done yet:

* should I update plone.app.locales with new i18n strings appeared on Security
  control panel? Or is this a separate process performed by our plone i18n team?
* should I update any documentation pages in order to finish this PLIP?


Test cases are
--------------

1. Switch on publication date on Security panel.
   Add a new document.
   Byline doesn't include publication date.

2. Switch on publication date on Security panel.
   Add a new document.
   Publish document.
   Byline includes publication date and not a modification date.

3. Switch on publication date on Security panel.
   Add a new document.
   Publish document.
   On edit form empty Published Date.
   Publication date should still be displayed in byline, this time
   taken from workflow history.

4. Switch on 'Allow byline for anonymous' on Security panel.
   Switch on publication date on Security panel.
   Add a new document.
   Publish document.
   Anonymous user should see publication date in byline.
   
4. Switch off publication date on Security panel.
   Add a new document.
   Publish document.
   No publication date in byline.
