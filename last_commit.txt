Repository: plone.app.upgrade
Branch: refs/heads/master
Date: 2015-05-29T12:14:55Z
Author: Tom Gross (tomgross) <itconsense@gmail.com>
Commit: https://github.com/plone/plone.app.upgrade/commit/647d32822b98ce2f607b9e7fb3f83d76b8e844ea

conditionally exclude upgrade step with CMFDefault dependency

Files changed:
M CHANGES.rst
M plone/app/upgrade/v40/configure.zcml

diff --git a/CHANGES.rst b/CHANGES.rst
index 542501e..fab7196 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -7,6 +7,8 @@ Changelog
 - Plone 5: upgrade manage portlets js
   [vangheem]
 
+- Remove hard dependency on CMFDefault
+  [tomgross]
 
 1.3.10 (2015-05-13)
 -------------------
diff --git a/plone/app/upgrade/v40/configure.zcml b/plone/app/upgrade/v40/configure.zcml
index 6437c40..a51e4d6 100644
--- a/plone/app/upgrade/v40/configure.zcml
+++ b/plone/app/upgrade/v40/configure.zcml
@@ -1,5 +1,6 @@
 <configure
     xmlns="http://namespaces.zope.org/zope"
+    xmlns:zcml="http://namespaces.zope.org/zcml"
     xmlns:genericsetup="http://namespaces.zope.org/genericsetup"
     i18n_domain="plone">
 
@@ -169,6 +170,7 @@
         profile="Products.CMFPlone:plone">
 
         <genericsetup:upgradeStep
+            zcml:condition="installed Products.CMFDefault"
             title="Upgrade DCMI metadata storage in portal_metadata"
             handler="Products.CMFDefault.upgrade.to22.upgrade_dcmi_metadata"
             />


Repository: plone.app.upgrade
Branch: refs/heads/master
Date: 2015-05-29T12:20:03Z
Author: Tom Gross (tomgross) <itconsense@gmail.com>
Commit: https://github.com/plone/plone.app.upgrade/commit/008f09a4bacfe2b1b0a11366c9894f973f9e40ea

remove CMFDefault as install dependency

Files changed:
M setup.py

diff --git a/setup.py b/setup.py
index 265e131..c64aaa9 100644
--- a/setup.py
+++ b/setup.py
@@ -59,7 +59,6 @@
         'Products.Archetypes',
         'Products.contentmigration',
         'Products.CMFCore',
-        'Products.CMFDefault',
         'Products.CMFDiffTool',
         'Products.CMFEditions',
         'Products.CMFFormController',


Repository: plone.app.upgrade
Branch: refs/heads/master
Date: 2015-05-30T13:41:49+02:00
Author: Timo Stollenwerk (tisto) <tisto@plone.org>
Commit: https://github.com/plone/plone.app.upgrade/commit/d3d0b0ccc71d59bacb55d9d3b0c48772a51704ed

Merge pull request #32 from plone/tomgross-nocmfdefault

Removed hard CMFDefault dependency

Files changed:
M CHANGES.rst
M plone/app/upgrade/v40/configure.zcml
M setup.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 542501e..fab7196 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -7,6 +7,8 @@ Changelog
 - Plone 5: upgrade manage portlets js
   [vangheem]
 
+- Remove hard dependency on CMFDefault
+  [tomgross]
 
 1.3.10 (2015-05-13)
 -------------------
diff --git a/plone/app/upgrade/v40/configure.zcml b/plone/app/upgrade/v40/configure.zcml
index 6437c40..a51e4d6 100644
--- a/plone/app/upgrade/v40/configure.zcml
+++ b/plone/app/upgrade/v40/configure.zcml
@@ -1,5 +1,6 @@
 <configure
     xmlns="http://namespaces.zope.org/zope"
+    xmlns:zcml="http://namespaces.zope.org/zcml"
     xmlns:genericsetup="http://namespaces.zope.org/genericsetup"
     i18n_domain="plone">
 
@@ -169,6 +170,7 @@
         profile="Products.CMFPlone:plone">
 
         <genericsetup:upgradeStep
+            zcml:condition="installed Products.CMFDefault"
             title="Upgrade DCMI metadata storage in portal_metadata"
             handler="Products.CMFDefault.upgrade.to22.upgrade_dcmi_metadata"
             />
diff --git a/setup.py b/setup.py
index 265e131..c64aaa9 100644
--- a/setup.py
+++ b/setup.py
@@ -59,7 +59,6 @@
         'Products.Archetypes',
         'Products.contentmigration',
         'Products.CMFCore',
-        'Products.CMFDefault',
         'Products.CMFDiffTool',
         'Products.CMFEditions',
         'Products.CMFFormController',


