Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2015-09-08T11:58:24-05:00
Author: vangheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/f2330ea0091b9fff0a95bdc1e21b7e8bf06bffee

move colphon and footer out of skins

Files changed:
A Products/CMFPlone/browser/templates/colophon.pt
A Products/CMFPlone/browser/templates/footer.pt
M CHANGES.rst
M Products/CMFPlone/PloneTool.py
M Products/CMFPlone/browser/configure.zcml
D Products/CMFPlone/skins/plone_templates/colophon.pt
D Products/CMFPlone/skins/plone_templates/footer.pt

diff --git a/CHANGES.rst b/CHANGES.rst
index ab9ec3f..cfbbf1f 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,6 +14,9 @@ Changelog
 - Remove no-longer-used properties from portal_properties
   [esteele]
 
+- Move footer and colophon out of skins
+  [vangheem]
+
 - pre-cook resources so we do not write on read for resources generation
   [vangheem]
 
diff --git a/Products/CMFPlone/PloneTool.py b/Products/CMFPlone/PloneTool.py
index 675c2b4..af23d92 100644
--- a/Products/CMFPlone/PloneTool.py
+++ b/Products/CMFPlone/PloneTool.py
@@ -966,6 +966,11 @@ def listMetaTags(self, context):
         site_settings = registry.forInterface(ISiteSchema, prefix="plone", check=False)
         use_all = site_settings.exposeDCMetaTags
 
+        try:
+            use_all = site_settings.exposeDCMetaTags
+        except AttributeError:
+            use_all = False
+
         security_settings = registry.forInterface(
             ISecuritySchema, prefix='plone')
         view_about = security_settings.allow_anon_views_about \
diff --git a/Products/CMFPlone/browser/configure.zcml b/Products/CMFPlone/browser/configure.zcml
index 10dc8c0..135b240 100644
--- a/Products/CMFPlone/browser/configure.zcml
+++ b/Products/CMFPlone/browser/configure.zcml
@@ -214,4 +214,18 @@
       allowed_interface="Products.CMFPlone.interfaces.defaultpage.IDefaultPage"
       />
 
+  <browser:page
+    for="*"
+    name="footer"
+    permission="zope.Public"
+    template="templates/footer.pt"
+    />
+
+  <browser:page
+    for="*"
+    name="colophon"
+    permission="zope.Public"
+    template="templates/colophon.pt"
+    />
+
 </configure>
diff --git a/Products/CMFPlone/browser/templates/colophon.pt b/Products/CMFPlone/browser/templates/colophon.pt
new file mode 100644
index 0000000..cbe0a70
--- /dev/null
+++ b/Products/CMFPlone/browser/templates/colophon.pt
@@ -0,0 +1,18 @@
+<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
+      xmlns:tal="http://xml.zope.org/namespaces/tal"
+      xmlns:metal="http://xml.zope.org/namespaces/metal"
+      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
+      lang="en"
+      tal:omit-tag=""
+      i18n:domain="plone">
+
+  <section class="portlet portletClassic" id="portal-colophon" metal:define-macro="portlet">
+    <div class="portletContent">
+      <a href="http://plone.com" target="_blank"
+         title="This site was built using the Plone Open Source CMS/WCM."
+         i18n:attributes="title title_built_with_plone;"
+         i18n:translate="label_powered_by_plone">
+        Powered by Plone &amp; Python</a>
+    </div>
+  </section>
+</html>
diff --git a/Products/CMFPlone/browser/templates/footer.pt b/Products/CMFPlone/browser/templates/footer.pt
new file mode 100644
index 0000000..03980c9
--- /dev/null
+++ b/Products/CMFPlone/browser/templates/footer.pt
@@ -0,0 +1,35 @@
+<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
+      xmlns:tal="http://xml.zope.org/namespaces/tal"
+      xmlns:metal="http://xml.zope.org/namespaces/metal"
+      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
+      lang="en"
+      tal:omit-tag=""
+      i18n:domain="plone">
+
+  <section class="portlet portletClassic" id="portal-footer-signature" metal:define-macro="portlet">
+    <div class="portletContent">
+      <span i18n:translate="description_copyright" tal:omit-tag="">
+      The
+      <span i18n:name="plonecms" tal:omit-tag="">
+           <a href="http://plone.com" i18n:translate="label_plone_cms">Plone<sup>&reg;</sup> Open Source CMS/WCM</a>
+      </span>
+      is
+      <abbr title="Copyright" i18n:name="copyright" i18n:attributes="title title_copyright;">&copy;</abbr>
+      2000-<tal:year i18n:name="current_year"
+         tal:define="DateTime nocall:modules/DateTime.DateTime;
+                     myTime python:DateTime()"
+         tal:content="python:myTime.year()" />
+      by the
+      <span i18n:name="plonefoundation" tal:omit-tag="">
+           <a href="http://plone.org/foundation" i18n:translate="label_plone_foundation">Plone Foundation</a></span>
+      and friends.
+      </span>
+
+      <span i18n:translate="description_license" tal:omit-tag="">
+      Distributed under the
+           <span i18n:name="license" tal:omit-tag="">
+                <a href="http://creativecommons.org/licenses/GPL/2.0/" i18n:translate="label_gnu_gpl_licence">GNU GPL license</a></span>.
+      </span>
+    </div>
+  </section>
+</html>
diff --git a/Products/CMFPlone/skins/plone_templates/colophon.pt b/Products/CMFPlone/skins/plone_templates/colophon.pt
deleted file mode 100644
index cbe0a70..0000000
--- a/Products/CMFPlone/skins/plone_templates/colophon.pt
+++ /dev/null
@@ -1,18 +0,0 @@
-<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
-      xmlns:tal="http://xml.zope.org/namespaces/tal"
-      xmlns:metal="http://xml.zope.org/namespaces/metal"
-      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
-      lang="en"
-      tal:omit-tag=""
-      i18n:domain="plone">
-
-  <section class="portlet portletClassic" id="portal-colophon" metal:define-macro="portlet">
-    <div class="portletContent">
-      <a href="http://plone.com" target="_blank"
-         title="This site was built using the Plone Open Source CMS/WCM."
-         i18n:attributes="title title_built_with_plone;"
-         i18n:translate="label_powered_by_plone">
-        Powered by Plone &amp; Python</a>
-    </div>
-  </section>
-</html>
diff --git a/Products/CMFPlone/skins/plone_templates/footer.pt b/Products/CMFPlone/skins/plone_templates/footer.pt
deleted file mode 100644
index be906a9..0000000
--- a/Products/CMFPlone/skins/plone_templates/footer.pt
+++ /dev/null
@@ -1,34 +0,0 @@
-<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
-      xmlns:tal="http://xml.zope.org/namespaces/tal"
-      xmlns:metal="http://xml.zope.org/namespaces/metal"
-      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
-      lang="en"
-      tal:omit-tag=""
-      i18n:domain="plone">
-
-  <section class="portlet portletClassic" id="portal-footer-signature" metal:define-macro="portlet">
-    <div class="portletContent">
-      <span i18n:translate="description_copyright" tal:omit-tag="">
-      The
-      <span i18n:name="plonecms" tal:omit-tag="">
-           <a href="http://plone.com" i18n:translate="label_plone_cms">Plone<sup>&reg;</sup> Open Source CMS/WCM</a>
-      </span>
-      is
-      <abbr title="Copyright" i18n:name="copyright" i18n:attributes="title title_copyright;">&copy;</abbr>
-      2000-<tal:year i18n:name="current_year"
-         tal:define="myTime python:DateTime()"
-         tal:content="python:myTime.year()" />
-      by the
-      <span i18n:name="plonefoundation" tal:omit-tag="">
-           <a href="http://plone.org/foundation" i18n:translate="label_plone_foundation">Plone Foundation</a></span>
-      and friends.
-      </span>
-
-      <span i18n:translate="description_license" tal:omit-tag="">
-      Distributed under the
-           <span i18n:name="license" tal:omit-tag="">
-                <a href="http://creativecommons.org/licenses/GPL/2.0/" i18n:translate="label_gnu_gpl_licence">GNU GPL license</a></span>.
-      </span>
-    </div>
-  </section>
-</html>


Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2015-09-08T13:30:16-04:00
Author: Eric Steele (esteele) <eric@esteele.net>
Commit: https://github.com/plone/Products.CMFPlone/commit/d826b53b7a06574c33bc350325882941ae3c6b70

Merge pull request #869 from plone/move-colophon-footer

move colphon and footer out of skins

Files changed:
A Products/CMFPlone/browser/templates/colophon.pt
A Products/CMFPlone/browser/templates/footer.pt
M CHANGES.rst
M Products/CMFPlone/PloneTool.py
M Products/CMFPlone/browser/configure.zcml
D Products/CMFPlone/skins/plone_templates/colophon.pt
D Products/CMFPlone/skins/plone_templates/footer.pt

diff --git a/CHANGES.rst b/CHANGES.rst
index ab9ec3f..cfbbf1f 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,6 +14,9 @@ Changelog
 - Remove no-longer-used properties from portal_properties
   [esteele]
 
+- Move footer and colophon out of skins
+  [vangheem]
+
 - pre-cook resources so we do not write on read for resources generation
   [vangheem]
 
diff --git a/Products/CMFPlone/PloneTool.py b/Products/CMFPlone/PloneTool.py
index 675c2b4..af23d92 100644
--- a/Products/CMFPlone/PloneTool.py
+++ b/Products/CMFPlone/PloneTool.py
@@ -966,6 +966,11 @@ def listMetaTags(self, context):
         site_settings = registry.forInterface(ISiteSchema, prefix="plone", check=False)
         use_all = site_settings.exposeDCMetaTags
 
+        try:
+            use_all = site_settings.exposeDCMetaTags
+        except AttributeError:
+            use_all = False
+
         security_settings = registry.forInterface(
             ISecuritySchema, prefix='plone')
         view_about = security_settings.allow_anon_views_about \
diff --git a/Products/CMFPlone/browser/configure.zcml b/Products/CMFPlone/browser/configure.zcml
index 10dc8c0..135b240 100644
--- a/Products/CMFPlone/browser/configure.zcml
+++ b/Products/CMFPlone/browser/configure.zcml
@@ -214,4 +214,18 @@
       allowed_interface="Products.CMFPlone.interfaces.defaultpage.IDefaultPage"
       />
 
+  <browser:page
+    for="*"
+    name="footer"
+    permission="zope.Public"
+    template="templates/footer.pt"
+    />
+
+  <browser:page
+    for="*"
+    name="colophon"
+    permission="zope.Public"
+    template="templates/colophon.pt"
+    />
+
 </configure>
diff --git a/Products/CMFPlone/browser/templates/colophon.pt b/Products/CMFPlone/browser/templates/colophon.pt
new file mode 100644
index 0000000..cbe0a70
--- /dev/null
+++ b/Products/CMFPlone/browser/templates/colophon.pt
@@ -0,0 +1,18 @@
+<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
+      xmlns:tal="http://xml.zope.org/namespaces/tal"
+      xmlns:metal="http://xml.zope.org/namespaces/metal"
+      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
+      lang="en"
+      tal:omit-tag=""
+      i18n:domain="plone">
+
+  <section class="portlet portletClassic" id="portal-colophon" metal:define-macro="portlet">
+    <div class="portletContent">
+      <a href="http://plone.com" target="_blank"
+         title="This site was built using the Plone Open Source CMS/WCM."
+         i18n:attributes="title title_built_with_plone;"
+         i18n:translate="label_powered_by_plone">
+        Powered by Plone &amp; Python</a>
+    </div>
+  </section>
+</html>
diff --git a/Products/CMFPlone/browser/templates/footer.pt b/Products/CMFPlone/browser/templates/footer.pt
new file mode 100644
index 0000000..03980c9
--- /dev/null
+++ b/Products/CMFPlone/browser/templates/footer.pt
@@ -0,0 +1,35 @@
+<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
+      xmlns:tal="http://xml.zope.org/namespaces/tal"
+      xmlns:metal="http://xml.zope.org/namespaces/metal"
+      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
+      lang="en"
+      tal:omit-tag=""
+      i18n:domain="plone">
+
+  <section class="portlet portletClassic" id="portal-footer-signature" metal:define-macro="portlet">
+    <div class="portletContent">
+      <span i18n:translate="description_copyright" tal:omit-tag="">
+      The
+      <span i18n:name="plonecms" tal:omit-tag="">
+           <a href="http://plone.com" i18n:translate="label_plone_cms">Plone<sup>&reg;</sup> Open Source CMS/WCM</a>
+      </span>
+      is
+      <abbr title="Copyright" i18n:name="copyright" i18n:attributes="title title_copyright;">&copy;</abbr>
+      2000-<tal:year i18n:name="current_year"
+         tal:define="DateTime nocall:modules/DateTime.DateTime;
+                     myTime python:DateTime()"
+         tal:content="python:myTime.year()" />
+      by the
+      <span i18n:name="plonefoundation" tal:omit-tag="">
+           <a href="http://plone.org/foundation" i18n:translate="label_plone_foundation">Plone Foundation</a></span>
+      and friends.
+      </span>
+
+      <span i18n:translate="description_license" tal:omit-tag="">
+      Distributed under the
+           <span i18n:name="license" tal:omit-tag="">
+                <a href="http://creativecommons.org/licenses/GPL/2.0/" i18n:translate="label_gnu_gpl_licence">GNU GPL license</a></span>.
+      </span>
+    </div>
+  </section>
+</html>
diff --git a/Products/CMFPlone/skins/plone_templates/colophon.pt b/Products/CMFPlone/skins/plone_templates/colophon.pt
deleted file mode 100644
index cbe0a70..0000000
--- a/Products/CMFPlone/skins/plone_templates/colophon.pt
+++ /dev/null
@@ -1,18 +0,0 @@
-<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
-      xmlns:tal="http://xml.zope.org/namespaces/tal"
-      xmlns:metal="http://xml.zope.org/namespaces/metal"
-      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
-      lang="en"
-      tal:omit-tag=""
-      i18n:domain="plone">
-
-  <section class="portlet portletClassic" id="portal-colophon" metal:define-macro="portlet">
-    <div class="portletContent">
-      <a href="http://plone.com" target="_blank"
-         title="This site was built using the Plone Open Source CMS/WCM."
-         i18n:attributes="title title_built_with_plone;"
-         i18n:translate="label_powered_by_plone">
-        Powered by Plone &amp; Python</a>
-    </div>
-  </section>
-</html>
diff --git a/Products/CMFPlone/skins/plone_templates/footer.pt b/Products/CMFPlone/skins/plone_templates/footer.pt
deleted file mode 100644
index be906a9..0000000
--- a/Products/CMFPlone/skins/plone_templates/footer.pt
+++ /dev/null
@@ -1,34 +0,0 @@
-<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
-      xmlns:tal="http://xml.zope.org/namespaces/tal"
-      xmlns:metal="http://xml.zope.org/namespaces/metal"
-      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
-      lang="en"
-      tal:omit-tag=""
-      i18n:domain="plone">
-
-  <section class="portlet portletClassic" id="portal-footer-signature" metal:define-macro="portlet">
-    <div class="portletContent">
-      <span i18n:translate="description_copyright" tal:omit-tag="">
-      The
-      <span i18n:name="plonecms" tal:omit-tag="">
-           <a href="http://plone.com" i18n:translate="label_plone_cms">Plone<sup>&reg;</sup> Open Source CMS/WCM</a>
-      </span>
-      is
-      <abbr title="Copyright" i18n:name="copyright" i18n:attributes="title title_copyright;">&copy;</abbr>
-      2000-<tal:year i18n:name="current_year"
-         tal:define="myTime python:DateTime()"
-         tal:content="python:myTime.year()" />
-      by the
-      <span i18n:name="plonefoundation" tal:omit-tag="">
-           <a href="http://plone.org/foundation" i18n:translate="label_plone_foundation">Plone Foundation</a></span>
-      and friends.
-      </span>
-
-      <span i18n:translate="description_license" tal:omit-tag="">
-      Distributed under the
-           <span i18n:name="license" tal:omit-tag="">
-                <a href="http://creativecommons.org/licenses/GPL/2.0/" i18n:translate="label_gnu_gpl_licence">GNU GPL license</a></span>.
-      </span>
-    </div>
-  </section>
-</html>


