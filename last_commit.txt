Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2015-08-12T16:46:57+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.CMFPlone/commit/62d2164afcea269b16ae2ac3ed197d09decfb493

PloneControlPanel: do not call deleteActions needlessly.

When unregistering a configlet or application that does not exist,
we simply return.

Files changed:
M Products/CMFPlone/PloneControlPanel.py

diff --git a/Products/CMFPlone/PloneControlPanel.py b/Products/CMFPlone/PloneControlPanel.py
index 9faa3d6..abe1c2e 100644
--- a/Products/CMFPlone/PloneControlPanel.py
+++ b/Products/CMFPlone/PloneControlPanel.py
@@ -146,12 +146,16 @@ def _id(v):
     def unregisterConfiglet(self, id):
         actids = [o.id for o in self.listActions()]
         selection = [actids.index(a) for a in actids if a == id]
+        if not selection:
+            return
         self.deleteActions(selection)
 
     security.declareProtected(ManagePortal, 'unregisterApplication')
     def unregisterApplication(self, appId):
         acts = list(self.listActions())
         selection = [acts.index(a) for a in acts if a.appId == appId]
+        if not selection:
+            return
         self.deleteActions(selection)
 
     def _extractAction(self, properties, index):


