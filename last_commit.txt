Repository: plone.app.contenttypes
Branch: refs/heads/master
Date: 2015-03-21T08:30:34+01:00
Author: Timo Stollenwerk (tisto) <tisto@plone.org>
Commit: https://github.com/plone/plone.app.contenttypes/commit/88f03d2df860865f5fa509b6c0a29cc0708293b2

Make collection robot tests run more reliably. Make sure we wait until the patterns are fully loaded.

Files changed:
M plone/app/contenttypes/tests/robot/test_collection_location_criterion.robot
M plone/app/contenttypes/tests/robot/test_collection_short_name_criterion.robot

diff --git a/plone/app/contenttypes/tests/robot/test_collection_location_criterion.robot b/plone/app/contenttypes/tests/robot/test_collection_location_criterion.robot
index 8259f7b..298444d 100644
--- a/plone/app/contenttypes/tests/robot/test_collection_location_criterion.robot
+++ b/plone/app/contenttypes/tests/robot/test_collection_location_criterion.robot
@@ -2,6 +2,7 @@
 
 Resource  plone/app/robotframework/keywords.robot
 Resource  plone/app/contenttypes/tests/robot/keywords.txt
+Resource  Products/CMFPlone/tests/robot/keywords.txt
 
 Variables  plone/app/contenttypes/tests/robot/variables.py
 
@@ -47,20 +48,20 @@ a folder '${folder-id}' with a document '${document-title}'
 
 I set the collection's relative location criterion to
     [Arguments]  ${criterion}
-    Go to  ${PLONE_URL}/my-collection
-    Click Edit
-
+    Go to  ${PLONE_URL}/my-collection/edit
+    Wait until page contains  Edit Collection
+    patterns are loaded
     I set the criteria index in row 1 to the option 'Location'
     I set the criteria operator in row 1 to the option 'Relative path'
     I set the criteria value in row 1 to the text '${criterion}'
-
     Click Button  Save
     Wait until page contains  Changes saved
 
 I set the collection's absolute location criterion to
     [Arguments]  ${criterion}
-    Go to  ${PLONE_URL}/my-collection
-    Click Edit
+    Go to  ${PLONE_URL}/my-collection/edit
+    Wait until page contains  Edit Collection
+    patterns are loaded
 
     I set the criteria index in row 1 to the option 'Location'
     I set the criteria operator in row 1 to the option 'Absolute path'
diff --git a/plone/app/contenttypes/tests/robot/test_collection_short_name_criterion.robot b/plone/app/contenttypes/tests/robot/test_collection_short_name_criterion.robot
index ab1e1b6..55bb18b 100644
--- a/plone/app/contenttypes/tests/robot/test_collection_short_name_criterion.robot
+++ b/plone/app/contenttypes/tests/robot/test_collection_short_name_criterion.robot
@@ -2,6 +2,7 @@
 
 Resource  plone/app/robotframework/keywords.robot
 Resource  plone/app/contenttypes/tests/robot/keywords.txt
+Resource  Products/CMFPlone/tests/robot/keywords.txt
 
 Test Setup  Run keywords  Open test browser
 Test Teardown  Close all browsers
@@ -24,8 +25,9 @@ Test Short name (id) Criterion
 
 I set the collection short name (id) criterion to
     [Arguments]  ${criterion}
-    Go to  ${PLONE_URL}/my-collection
-    Click Edit
+    Go to  ${PLONE_URL}/my-collection/edit
+    Wait until page contains  Edit Collection
+    patterns are loaded
 
     I set the criteria index in row 1 to the option 'Short name'
     I set the criteria operator in row 1 to the option 'Is'


