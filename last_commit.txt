Repository: plone.app.event


Branch: refs/heads/master
Date: 2015-06-23T01:08:09+02:00
Author: Johannes Raggam (thet) <raggam-nl@adm.at>
Commit: https://github.com/plone/plone.app.event/commit/44d6f48dce49afbd0b30dc1f660d38e2be76bf57

BBB portlets: do the version comparison with LooseVersion, so that Plone-style development version numbers like 2.5.4.dev0 also work.

Files changed:
M CHANGES.rst
M plone/app/event/bbb/portlets/portlet_calendar.py
M plone/app/event/bbb/portlets/portlet_events.py

diff --git a/CHANGES.rst b/CHANGES.rst
index f619d03..4a9065c 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,6 +4,10 @@ Changelog
 2.0a13 (unreleased)
 -------------------
 
+- BBB portlets: do the version comparison with LooseVersion, so that
+  Plone-style development version numbers like ``2.5.4.dev0`` also work.
+  [thet]
+
 - For the event portlet, cache the list of events on the request
   (plone.memoize.view) instead of the instance, which creates a write
   transaction.
diff --git a/plone/app/event/bbb/portlets/portlet_calendar.py b/plone/app/event/bbb/portlets/portlet_calendar.py
index b44845a..e153b9d 100644
--- a/plone/app/event/bbb/portlets/portlet_calendar.py
+++ b/plone/app/event/bbb/portlets/portlet_calendar.py
@@ -1,16 +1,15 @@
-from distutils.version import StrictVersion
-import pkg_resources
-
 from Products.Five.browser.pagetemplatefile import ViewPageTemplateFile
+from distutils.version import LooseVersion
+from plone.app.event.portlets.portlet_calendar import Assignment
+from plone.app.event.portlets.portlet_calendar import ICalendarPortlet
+from plone.app.event.portlets.portlet_calendar import Renderer as RendererBase
 from plone.app.portlets import PloneMessageFactory as _
+import pkg_resources
 
-from plone.app.event.portlets.portlet_calendar import Renderer as RendererBase
-from plone.app.event.portlets.portlet_calendar import ICalendarPortlet
-from plone.app.event.portlets.portlet_calendar import Assignment
 
+version = LooseVersion(pkg_resources.require("plone.app.portlets")[0].version)
+wanted = LooseVersion('3.0')
 
-version = StrictVersion(pkg_resources.require("plone.app.portlets")[0].version)
-wanted = StrictVersion('3.0')
 
 if version >= wanted:
     P_A_PORTLETS_PRE_3 = False
diff --git a/plone/app/event/bbb/portlets/portlet_events.py b/plone/app/event/bbb/portlets/portlet_events.py
index 7eb6896..d1c6ceb 100644
--- a/plone/app/event/bbb/portlets/portlet_events.py
+++ b/plone/app/event/bbb/portlets/portlet_events.py
@@ -1,16 +1,15 @@
-from distutils.version import StrictVersion
-import pkg_resources
-
 from Products.Five.browser.pagetemplatefile import ViewPageTemplateFile
-from plone.app.portlets import PloneMessageFactory as _
-
-from plone.app.event.portlets.portlet_events import Renderer as RendererBase
+from distutils.version import LooseVersion
 from plone.app.event.portlets.portlet_events import Assignment
 from plone.app.event.portlets.portlet_events import IEventsPortlet
+from plone.app.event.portlets.portlet_events import Renderer as RendererBase
+from plone.app.portlets import PloneMessageFactory as _
+import pkg_resources
+
 
+version = LooseVersion(pkg_resources.require("plone.app.portlets")[0].version)
+wanted = LooseVersion('3.0')
 
-version = StrictVersion(pkg_resources.require("plone.app.portlets")[0].version)
-wanted = StrictVersion('3.0')
 
 if version >= wanted:
     P_A_PORTLETS_PRE_3 = False


