Repository: Products.CMFPlone
Branch: refs/heads/master
Date: 2015-06-02T16:07:51+02:00
Author: Ramon Navarro Bosch () <ramon@iMac-de-Ramon.local>
Commit: https://github.com/plone/Products.CMFPlone/commit/f0fb73abf555974f367115a3cd76693c59bc670d

Adding a templates field so is possible to define templates for tinymce, if its accepted documentation on Plone5 doc will be placed to enable this feature without any need of code, just registry configuration

Files changed:
M Products/CMFPlone/interfaces/controlpanel.py
M Products/CMFPlone/patterns/__init__.py

diff --git a/Products/CMFPlone/interfaces/controlpanel.py b/Products/CMFPlone/interfaces/controlpanel.py
index fa71c76..6613121 100644
--- a/Products/CMFPlone/interfaces/controlpanel.py
+++ b/Products/CMFPlone/interfaces/controlpanel.py
@@ -546,6 +546,14 @@ class ITinyMCEPluginSchema(Interface):
         }, indent=4).decode('utf8')
     )
 
+    templates = schema.Text(
+        title=_("label_tinymce_templates", default=u"Templates"),
+        description=_("help_tinymce_templates", default=(
+            u"Enter the list of templates in json format \
+                http://www.tinymce.com/wiki.php/Plugin:template")),
+        required=False,
+        default=u"")
+
     toolbar = schema.Text(
         title=_("label_tinymce_toolbar", default=u"Toolbar"),
         description=_("help_tinymce_toolbar", default=(
diff --git a/Products/CMFPlone/patterns/__init__.py b/Products/CMFPlone/patterns/__init__.py
index 8ccc57f..a129463 100644
--- a/Products/CMFPlone/patterns/__init__.py
+++ b/Products/CMFPlone/patterns/__init__.py
@@ -164,6 +164,12 @@ def get_tiny_config(self):
         if settings.menu:
             tiny_config['menu'] = json.loads(settings.menu)
 
+        if hasattr(settings, 'templates') and settings.templates:
+            try:
+                tiny_config['templates'] = json.loads(settings.templates)
+            except ValueError:
+                pass
+
         return tiny_config
 
 


Repository: Products.CMFPlone
Branch: refs/heads/master
Date: 2015-06-02T11:34:59-05:00
Author: Nathan Van Gheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/710d4e9d3d58cfc118f73c6c7b0204e1ab19d7e6

Merge pull request #592 from plone/tinymce-templates

Adding a templates field so is possible to define templates for tinymâ€¦

Files changed:
M Products/CMFPlone/interfaces/controlpanel.py
M Products/CMFPlone/patterns/__init__.py

diff --git a/Products/CMFPlone/interfaces/controlpanel.py b/Products/CMFPlone/interfaces/controlpanel.py
index fa71c76..6613121 100644
--- a/Products/CMFPlone/interfaces/controlpanel.py
+++ b/Products/CMFPlone/interfaces/controlpanel.py
@@ -546,6 +546,14 @@ class ITinyMCEPluginSchema(Interface):
         }, indent=4).decode('utf8')
     )
 
+    templates = schema.Text(
+        title=_("label_tinymce_templates", default=u"Templates"),
+        description=_("help_tinymce_templates", default=(
+            u"Enter the list of templates in json format \
+                http://www.tinymce.com/wiki.php/Plugin:template")),
+        required=False,
+        default=u"")
+
     toolbar = schema.Text(
         title=_("label_tinymce_toolbar", default=u"Toolbar"),
         description=_("help_tinymce_toolbar", default=(
diff --git a/Products/CMFPlone/patterns/__init__.py b/Products/CMFPlone/patterns/__init__.py
index 8ccc57f..a129463 100644
--- a/Products/CMFPlone/patterns/__init__.py
+++ b/Products/CMFPlone/patterns/__init__.py
@@ -164,6 +164,12 @@ def get_tiny_config(self):
         if settings.menu:
             tiny_config['menu'] = json.loads(settings.menu)
 
+        if hasattr(settings, 'templates') and settings.templates:
+            try:
+                tiny_config['templates'] = json.loads(settings.templates)
+            except ValueError:
+                pass
+
         return tiny_config
 
 


