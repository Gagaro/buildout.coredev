Repository: plone.app.content


Branch: refs/heads/master
Date: 2015-08-03T13:36:13+02:00
Author: Cillian de RÃ³iste (cillianderoiste) <deroiste@syslab.com>
Commit: https://github.com/plone/plone.app.content/commit/1b3a16ba27154eb5292e64ae5856ce0f87af5952

DeleteConfirmation.handle_delete: ensure the title is unicode

To reproduce the issue:
Create a folder with a unicode character in the title, and try to delete
it via the @@delete_confirmation view. A UnicodeDecodeError is thrown on
line 72.

Files changed:
M CHANGES.rst
M plone/app/content/browser/actions.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 5967cf7..bf97070 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -22,6 +22,9 @@ Changelog
 - When clicking cancel on the delete_confirmation got to the view_url.
   [ale-rt]
 
+- Fix deletion of objects with unicode charaters in the title.
+  [cillianderoiste]
+
 
 3.0.7 (2015-07-18)
 ------------------
diff --git a/plone/app/content/browser/actions.py b/plone/app/content/browser/actions.py
index 0c1f94e..f7375c5 100644
--- a/plone/app/content/browser/actions.py
+++ b/plone/app/content/browser/actions.py
@@ -5,6 +5,7 @@
 from OFS.CopySupport import CopyError
 from Products.CMFCore.utils import getToolByName
 from Products.CMFPlone import PloneMessageFactory as _
+from Products.CMFPlone.utils import safe_unicode
 from Products.Five.browser import BrowserView
 from Products.Five.browser.pagetemplatefile import ViewPageTemplateFile
 from Products.statusmessages.interfaces import IStatusMessage
@@ -61,7 +62,7 @@ def items_to_delete(self):
 
     @button.buttonAndHandler(_(u'Delete'), name='Delete')
     def handle_delete(self, action):
-        title = self.context.Title()
+        title = safe_unicode(self.context.Title())
         parent = aq_parent(aq_inner(self.context))
 
         # has the context object been acquired from a place it should not have


Repository: plone.app.content


Branch: refs/heads/master
Date: 2015-08-03T15:28:24+02:00
Author: Eric BREHAULT (ebrehault) <ebrehault@gmail.com>
Commit: https://github.com/plone/plone.app.content/commit/9285a79c590731a2b48fcc29ce653ace8dcd26b1

Merge pull request #48 from cillianderoiste/unicode-title-delete

Bugfix: allow deletion of items with unicode characters in the title

Files changed:
M CHANGES.rst
M plone/app/content/browser/actions.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 5967cf7..bf97070 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -22,6 +22,9 @@ Changelog
 - When clicking cancel on the delete_confirmation got to the view_url.
   [ale-rt]
 
+- Fix deletion of objects with unicode charaters in the title.
+  [cillianderoiste]
+
 
 3.0.7 (2015-07-18)
 ------------------
diff --git a/plone/app/content/browser/actions.py b/plone/app/content/browser/actions.py
index 0c1f94e..f7375c5 100644
--- a/plone/app/content/browser/actions.py
+++ b/plone/app/content/browser/actions.py
@@ -5,6 +5,7 @@
 from OFS.CopySupport import CopyError
 from Products.CMFCore.utils import getToolByName
 from Products.CMFPlone import PloneMessageFactory as _
+from Products.CMFPlone.utils import safe_unicode
 from Products.Five.browser import BrowserView
 from Products.Five.browser.pagetemplatefile import ViewPageTemplateFile
 from Products.statusmessages.interfaces import IStatusMessage
@@ -61,7 +62,7 @@ def items_to_delete(self):
 
     @button.buttonAndHandler(_(u'Delete'), name='Delete')
     def handle_delete(self, action):
-        title = self.context.Title()
+        title = safe_unicode(self.context.Title())
         parent = aq_parent(aq_inner(self.context))
 
         # has the context object been acquired from a place it should not have


