Repository: plone.theme
Branch: refs/heads/master
Date: 2015-04-13T23:06:33+02:00
Author: Patrick Gerken (do3cc) <do3cc@patrick-gerken.de>
Commit: https://github.com/plone/plone.theme/commit/6eb2f4f335e3ab203c5c393097f08ea0c2e3e947

Fix tests to work with new plone.app.testing

Files changed:
M plone/theme/tests/testBrowserLayerPrecedence.py

diff --git a/plone/theme/tests/testBrowserLayerPrecedence.py b/plone/theme/tests/testBrowserLayerPrecedence.py
index c562b7d..73e4ac7 100644
--- a/plone/theme/tests/testBrowserLayerPrecedence.py
+++ b/plone/theme/tests/testBrowserLayerPrecedence.py
@@ -50,6 +50,9 @@ def _get_request_interfaces(self):
         setDefaultSkin(request)
         orig_iro = list(directlyProvidedBy(request).__iro__)
         directlyProvides(request, [self.additive_layer] + orig_iro)
+        # Reset markers so that we can still register new skins and browserlayers
+        del request._plonebrowserlayer_
+        del request._plonetheme_
         notify(BeforeTraverseEvent(self.portal, request))
         iro = list(request.__provides__.__iro__)
         return iro


