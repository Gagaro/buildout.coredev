Repository: plone.app.querystring


Branch: refs/heads/master
Date: 2015-10-14T23:06:11+02:00
Author: Franz Gerhard Reinisch (fgrcon) <franz@fgrcon.net>
Commit: https://github.com/plone/plone.app.querystring/commit/09dec416f8f4a9762b70285b1d4157c133e39f16

fix resultview icons, https://github.com/plone/Products.CMFPlone/issues/1151

Files changed:
M CHANGES.rst
M plone/app/querystring/results.pt

diff --git a/CHANGES.rst b/CHANGES.rst
index 440092d..9c0e8a6 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,6 +4,10 @@ Changelog
 1.3.9 (unreleased)
 ------------------
 
+- fix resultview icons
+  https://github.com/plone/Products.CMFPlone/issues/1151
+  [fgrcon]
+
 - Add upgrade step to fix Subject index for existing collections
   [ezvirtual]
 
diff --git a/plone/app/querystring/results.pt b/plone/app/querystring/results.pt
index 147fa16..98fbb26 100644
--- a/plone/app/querystring/results.pt
+++ b/plone/app/querystring/results.pt
@@ -7,7 +7,8 @@
                  limited_results python:context[:25];
                  original_context nocall:options/original_context|nocall:context;
                  toLocalizedTime nocall:original_context/@@plone/toLocalizedTime;
-                 pas_member original_context/@@pas_member"
+                 pas_member original_context/@@pas_member;
+                 normalize nocall: context/@@plone/normalizeString;"
     i18n:domain="plone">
 
     <span i18n:translate="batch_x_items_matching_your_criteria">
@@ -25,13 +26,16 @@
 
         <dl class="searchResults" tal:condition="limited_results">
             <tal:results repeat="item limited_results">
-                <tal:entry tal:define="author python:pas_member.info(item.Creator())">
+                <tal:entry tal:define="author python:pas_member.info(item.Creator());
+                	                   item_state python:'state-'+item.review_state();
+                	                   item_type python:'contenttype-'+normalize(item.portal_type)">
                     <dt>
-                      <img tal:replace="structure item/getIcon" />
+                      
                        <a
                          href="#"
+                         
                          tal:attributes="href item/getURL;
-                                         class item/review_state"
+                                         class  string:$item_state $item_type"
                          tal:content="item/Title" />
                         <span class="documentByLine">
                             <span class="documentAuthor"


Repository: plone.app.querystring


Branch: refs/heads/master
Date: 2015-10-17T04:51:48-05:00
Author: Nathan Van Gheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/plone.app.querystring/commit/df50674f08fdcd3f1d5d76fda20d0f09fca13975

Merge pull request #55 from fgrcon/master

fix resultview icons,â€¦

Files changed:
M CHANGES.rst
M plone/app/querystring/results.pt

diff --git a/CHANGES.rst b/CHANGES.rst
index 440092d..9c0e8a6 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,6 +4,10 @@ Changelog
 1.3.9 (unreleased)
 ------------------
 
+- fix resultview icons
+  https://github.com/plone/Products.CMFPlone/issues/1151
+  [fgrcon]
+
 - Add upgrade step to fix Subject index for existing collections
   [ezvirtual]
 
diff --git a/plone/app/querystring/results.pt b/plone/app/querystring/results.pt
index 147fa16..98fbb26 100644
--- a/plone/app/querystring/results.pt
+++ b/plone/app/querystring/results.pt
@@ -7,7 +7,8 @@
                  limited_results python:context[:25];
                  original_context nocall:options/original_context|nocall:context;
                  toLocalizedTime nocall:original_context/@@plone/toLocalizedTime;
-                 pas_member original_context/@@pas_member"
+                 pas_member original_context/@@pas_member;
+                 normalize nocall: context/@@plone/normalizeString;"
     i18n:domain="plone">
 
     <span i18n:translate="batch_x_items_matching_your_criteria">
@@ -25,13 +26,16 @@
 
         <dl class="searchResults" tal:condition="limited_results">
             <tal:results repeat="item limited_results">
-                <tal:entry tal:define="author python:pas_member.info(item.Creator())">
+                <tal:entry tal:define="author python:pas_member.info(item.Creator());
+                	                   item_state python:'state-'+item.review_state();
+                	                   item_type python:'contenttype-'+normalize(item.portal_type)">
                     <dt>
-                      <img tal:replace="structure item/getIcon" />
+                      
                        <a
                          href="#"
+                         
                          tal:attributes="href item/getURL;
-                                         class item/review_state"
+                                         class  string:$item_state $item_type"
                          tal:content="item/Title" />
                         <span class="documentByLine">
                             <span class="documentAuthor"


