Repository: mockup


Branch: refs/heads/master
Date: 2015-08-10T09:32:39-05:00
Author: Sam Schwartz (obct537) <obct537@gmail.com>
Commit: https://github.com/plone/mockup/commit/cec7d933e2fae442cd544cfca1a1867fb0027ace

Added relative url setting to the lessbuidler

Files changed:
M mockup/patterns/thememapper/pattern.js

diff --git a/mockup/patterns/thememapper/pattern.js b/mockup/patterns/thememapper/pattern.js
index 38bf85d..f0d4137 100644
--- a/mockup/patterns/thememapper/pattern.js
+++ b/mockup/patterns/thememapper/pattern.js
@@ -412,6 +412,7 @@ define([
         type: 'POST',
         data: {
           path: self.lessPaths['save'],
+          relativeUrls: true,
           data: styles,
           _authenticator: utils.getAuthenticator()
         },


Repository: mockup


Branch: refs/heads/master
Date: 2015-08-10T13:56:37-05:00
Author: Sam Schwartz (obct537) <obct537@gmail.com>
Commit: https://github.com/plone/mockup/commit/6b90a9be346c8ce2cb9025b88eb7d70477f0bd78

Fixed 'less is undefined' error when not in dev mode

Files changed:
M mockup/patterns/thememapper/js/lessbuilderview.js

diff --git a/mockup/patterns/thememapper/js/lessbuilderview.js b/mockup/patterns/thememapper/js/lessbuilderview.js
index 319a06d..11ffe4f 100644
--- a/mockup/patterns/thememapper/js/lessbuilderview.js
+++ b/mockup/patterns/thememapper/js/lessbuilderview.js
@@ -130,8 +130,8 @@ define([
           };
           iframe.styles = [];
         },
-        onLoad: function(self) {
-          less.pageLoadFinished.then(
+        onLoad: function(iframe) {
+          iframe.window.less.pageLoadFinished.then(
             function() {
               var $ = window.parent.$;
               var iframe = window.iframe['lessc'];


Repository: mockup


Branch: refs/heads/master
Date: 2015-08-10T14:27:06-05:00
Author: Nathan Van Gheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/mockup/commit/587d898ac9bb24c8134bc56f5b94a1c0ec744ccc

Merge pull request #550 from plone/relative_urls

Relative urls

Files changed:
M mockup/patterns/thememapper/js/lessbuilderview.js
M mockup/patterns/thememapper/pattern.js

diff --git a/mockup/patterns/thememapper/js/lessbuilderview.js b/mockup/patterns/thememapper/js/lessbuilderview.js
index 319a06d..11ffe4f 100644
--- a/mockup/patterns/thememapper/js/lessbuilderview.js
+++ b/mockup/patterns/thememapper/js/lessbuilderview.js
@@ -130,8 +130,8 @@ define([
           };
           iframe.styles = [];
         },
-        onLoad: function(self) {
-          less.pageLoadFinished.then(
+        onLoad: function(iframe) {
+          iframe.window.less.pageLoadFinished.then(
             function() {
               var $ = window.parent.$;
               var iframe = window.iframe['lessc'];
diff --git a/mockup/patterns/thememapper/pattern.js b/mockup/patterns/thememapper/pattern.js
index 38bf85d..f0d4137 100644
--- a/mockup/patterns/thememapper/pattern.js
+++ b/mockup/patterns/thememapper/pattern.js
@@ -412,6 +412,7 @@ define([
         type: 'POST',
         data: {
           path: self.lessPaths['save'],
+          relativeUrls: true,
           data: styles,
           _authenticator: utils.getAuthenticator()
         },


