Repository: plone.app.dexterity


Branch: refs/heads/master
Date: 2015-10-16T14:12:23+02:00
Author: Franz Gerhard Reinisch (fgrcon) <franz@fgrcon.net>
Commit: https://github.com/plone/plone.app.dexterity/commit/c9239c4b0c44778b1812bfbd0d8d3e3fed179405

fix icons in dexterity types list
https://github.com/plone/Products.CMFPlone/issues/1151
https://github.com/plone/Products.CMFPlone/issues/1013

Files changed:
M plone/app/dexterity/browser/types_listing_row.pt

diff --git a/plone/app/dexterity/browser/types_listing_row.pt b/plone/app/dexterity/browser/types_listing_row.pt
index 54d1666..3c4aaa0 100644
--- a/plone/app/dexterity/browser/types_listing_row.pt
+++ b/plone/app/dexterity/browser/types_listing_row.pt
@@ -1,28 +1,23 @@
 <tal:block define="tups view/getCombinedWidgets;
                    portal context/@@plone_portal_state/portal;
                    layout portal/@@plone_layout;
-                   getIcon python:layout.getIcon;
                    niceTitles view/getNiceTitles"
            repeat="tup tups">
 
   <td tal:define="error python:tup[0].error;
-                  idx repeat/tup/index"
+                  idx repeat/tup/index;
+                  normalize nocall: context/@@plone/normalizeString;"
       tal:attributes="class python:'field' + (error and ' error' or '') + (tup[0].__name__ == 'view_item_count' and ' count' or '')">
     <tal:block repeat="widget tup">
 
-    <img
-       tal:define="fti view/getContent;
-                   icon python:getIcon(fti);"
-       tal:condition="python:icon and idx == 1"
-       tal:attributes="src icon/url"
-       width="16"
-       height="16"
-       />
+
 
     <a href=""
-       tal:define="link python:view.context.context.link(view.getContent(), widget.field.__name__)"
+       tal:define="link python:view.context.context.link(view.getContent(), widget.field.__name__);
+                   item_type_class python:'contenttype-' + normalize(view.getContent().Title())"
        tal:omit-tag="python:widget.mode == 'input' or link is None"
-       tal:attributes="href link">
+       tal:attributes="href link;
+                       class string:$item_type_class">
 
       <span class="error" tal:omit-tag="not:error">
         <div tal:condition="error" tal:replace="structure error/render" />


Repository: plone.app.dexterity


Branch: refs/heads/master
Date: 2015-10-16T14:14:35+02:00
Author: Franz Gerhard Reinisch (fgrcon) <franz@fgrcon.net>
Commit: https://github.com/plone/plone.app.dexterity/commit/4759d75b3d1c6c324d2de087a5113c52e5d24f3b

changenote #1151

Files changed:
M CHANGES.rst

diff --git a/CHANGES.rst b/CHANGES.rst
index e4e48e7..0fddacb 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,6 +4,10 @@ Changelog
 2.1.15 (unreleased)
 -------------------
 
+- fix icons in dexterity types list
+  plone/Products.CMFPlone#1151, plone/Products.CMFPlone#1013
+  [fgrcon]
+
 - No longer rely on deprecated ``bobobase_modification_time`` from
   ``Persistence.Persistent``.
   [thet]


Repository: plone.app.dexterity


Branch: refs/heads/master
Date: 2015-10-19T00:08:00+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.forcada@freitag.de>
Commit: https://github.com/plone/plone.app.dexterity/commit/d4d4729b17fb890216e018abaac0a9ea8ecabc9b

Merge pull request #188 from fgrcon/master

fix icons in dexterity types list

Files changed:
M CHANGES.rst
M plone/app/dexterity/browser/types_listing_row.pt

diff --git a/CHANGES.rst b/CHANGES.rst
index e4e48e7..0fddacb 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,6 +4,10 @@ Changelog
 2.1.15 (unreleased)
 -------------------
 
+- fix icons in dexterity types list
+  plone/Products.CMFPlone#1151, plone/Products.CMFPlone#1013
+  [fgrcon]
+
 - No longer rely on deprecated ``bobobase_modification_time`` from
   ``Persistence.Persistent``.
   [thet]
diff --git a/plone/app/dexterity/browser/types_listing_row.pt b/plone/app/dexterity/browser/types_listing_row.pt
index 54d1666..3c4aaa0 100644
--- a/plone/app/dexterity/browser/types_listing_row.pt
+++ b/plone/app/dexterity/browser/types_listing_row.pt
@@ -1,28 +1,23 @@
 <tal:block define="tups view/getCombinedWidgets;
                    portal context/@@plone_portal_state/portal;
                    layout portal/@@plone_layout;
-                   getIcon python:layout.getIcon;
                    niceTitles view/getNiceTitles"
            repeat="tup tups">
 
   <td tal:define="error python:tup[0].error;
-                  idx repeat/tup/index"
+                  idx repeat/tup/index;
+                  normalize nocall: context/@@plone/normalizeString;"
       tal:attributes="class python:'field' + (error and ' error' or '') + (tup[0].__name__ == 'view_item_count' and ' count' or '')">
     <tal:block repeat="widget tup">
 
-    <img
-       tal:define="fti view/getContent;
-                   icon python:getIcon(fti);"
-       tal:condition="python:icon and idx == 1"
-       tal:attributes="src icon/url"
-       width="16"
-       height="16"
-       />
+
 
     <a href=""
-       tal:define="link python:view.context.context.link(view.getContent(), widget.field.__name__)"
+       tal:define="link python:view.context.context.link(view.getContent(), widget.field.__name__);
+                   item_type_class python:'contenttype-' + normalize(view.getContent().Title())"
        tal:omit-tag="python:widget.mode == 'input' or link is None"
-       tal:attributes="href link">
+       tal:attributes="href link;
+                       class string:$item_type_class">
 
       <span class="error" tal:omit-tag="not:error">
         <div tal:condition="error" tal:replace="structure error/render" />


