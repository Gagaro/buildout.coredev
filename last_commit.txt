Repository: borg.localrole
Branch: refs/heads/3.0.x
Date: 2015-05-27T16:56:55+02:00
Author: Gaudenz Steinlin () <gaudenz.steinlin@cirrax.com>
Commit: https://github.com/plone/borg.localrole/commit/a192bb3373b28f869676f68ee059f8784003f75d

Revert "Add reference to fixed issue"

This reverts commit 5ef16122b45b92be746195c41c34ece47f7d2026.

Files changed:
M CHANGES.txt

diff --git a/CHANGES.txt b/CHANGES.txt
index 4827d29..36e3a50 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -3,7 +3,7 @@ Changelog
 
 3.0.3 - unreleased
 ------------------
-- Don't use id(obj) in cache keys, fixes https://dev.plone.org/ticket/9915
+- Don't use id(obj) in cache keys
   [gaudenz]
 
 3.0.2 - 2010-10-27


Repository: borg.localrole
Branch: refs/heads/3.0.x
Date: 2015-05-27T16:56:57+02:00
Author: Gaudenz Steinlin () <gaudenz.steinlin@cirrax.com>
Commit: https://github.com/plone/borg.localrole/commit/77479a7738d92b35deb765da5ff127e29ba354dd

Revert "Don't use id(obj) in cache keys"

This reverts commit d4a4cd99f8dc2ff8043429f7ecacf503efe5ef99.

Files changed:
M CHANGES.txt
M borg/localrole/workspace.py

diff --git a/CHANGES.txt b/CHANGES.txt
index 36e3a50..d4d8e36 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -3,8 +3,7 @@ Changelog
 
 3.0.3 - unreleased
 ------------------
-- Don't use id(obj) in cache keys
-  [gaudenz]
+
 
 3.0.2 - 2010-10-27
 ------------------
diff --git a/borg/localrole/workspace.py b/borg/localrole/workspace.py
index 710ce52..b7c6d76 100644
--- a/borg/localrole/workspace.py
+++ b/borg/localrole/workspace.py
@@ -122,7 +122,7 @@ def clra_cache_key(method, self, user, obj, object_roles):
     try:
         oid = obj.getPhysicalPath()
     except AttributeError:
-        raise DontCache
+        oid = id(obj)
     return (user.getId(), oid, tuple(object_roles))
 
 def store_on_request(method, self, user, obj, object_roles):


