Repository: Products.TinyMCE


Branch: refs/heads/1.3.x
Date: 2015-09-18T17:39:59+02:00
Author: Luca Fabbri (keul) <luca@keul.it>
Commit: https://github.com/plone/Products.TinyMCE/commit/b1047dd41c33aeded792ec07386fe33dbe673f84

Moved utility globals outside the getValidtags method

Files changed:
M HISTORY.rst
M Products/TinyMCE/utility.py

diff --git a/HISTORY.rst b/HISTORY.rst
index 2d3a4a1..65aca73 100644
--- a/HISTORY.rst
+++ b/HISTORY.rst
@@ -5,7 +5,9 @@ HISTORY
 1.3.14 (unreleased)
 -------------------
 
-- Nothing changed yet.
+- Moved utility globals outside the ``getValidElements`` method.
+  This will make TinyMCE lot easyer to be customized also through simple patches
+  [keul] 
 
 
 1.3.13 (2015-07-30)
diff --git a/Products/TinyMCE/utility.py b/Products/TinyMCE/utility.py
index 5d5f458..4586ffa 100644
--- a/Products/TinyMCE/utility.py
+++ b/Products/TinyMCE/utility.py
@@ -42,6 +42,23 @@ class IBaseObject(Interface):
 PMF = MessageFactory('plone')
 BUTTON_WIDTHS = {'style': 150, 'forecolor': 32, 'backcolor': 32, 'tablecontrols': 285}
 
+XHTML_TAGS = set(
+    'a abbr acronym address area b base bdo big blockquote body br '
+    'button caption cite code col colgroup dd del div dfn dl dt em '
+    'fieldset form h1 h2 h3 h4 h5 h6 head hr html i img input ins kbd '
+    'label legend li link map meta noscript object ol optgroup option '
+    'p param pre q samp script select small span strong style sub sup '
+    'table tbody td textarea tfoot th thead title tr tt ul var'.split())
+
+CORE_ATTRS = set(
+    'id style title class'.split())
+
+I18N_ATTRS = set(
+    'lang dir'.split())
+
+FOCUS_ATTRS = set(
+    'accesskey tabindex'.split())
+
 
 try:
     from plone.app.textfield.interfaces import IRichText
@@ -392,23 +409,6 @@ def getValidElements(self):
         if safe_html.get_parameter_value('disable_transform'):
             return {'*': ['*']}
 
-        XHTML_TAGS = set(
-            'a abbr acronym address area b base bdo big blockquote body br '
-            'button caption cite code col colgroup dd del div dfn dl dt em '
-            'fieldset form h1 h2 h3 h4 h5 h6 head hr html i img input ins kbd '
-            'label legend li link map meta noscript object ol optgroup option '
-            'p param pre q samp script select small span strong style sub sup '
-            'table tbody td textarea tfoot th thead title tr tt ul var'.split())
-
-        CORE_ATTRS = set(
-            'id style title class'.split())
-
-        I18N_ATTRS = set(
-            'lang dir'.split())
-
-        FOCUS_ATTRS = set(
-            'accesskey tabindex'.split())
-
         COMMON_ATTRS = CORE_ATTRS | I18N_ATTRS
 
         valid_elements = {


Repository: Products.TinyMCE


Branch: refs/heads/1.3.x
Date: 2015-09-18T18:31:19+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.TinyMCE/commit/54ae129a82c33e5cf8a466a2dfce4b2e125c592c

Merge pull request #115 from plone/1.3.x-external-globals

Moved utility globals outside the getValidtags method

Files changed:
M HISTORY.rst
M Products/TinyMCE/utility.py

diff --git a/HISTORY.rst b/HISTORY.rst
index 2d3a4a1..65aca73 100644
--- a/HISTORY.rst
+++ b/HISTORY.rst
@@ -5,7 +5,9 @@ HISTORY
 1.3.14 (unreleased)
 -------------------
 
-- Nothing changed yet.
+- Moved utility globals outside the ``getValidElements`` method.
+  This will make TinyMCE lot easyer to be customized also through simple patches
+  [keul] 
 
 
 1.3.13 (2015-07-30)
diff --git a/Products/TinyMCE/utility.py b/Products/TinyMCE/utility.py
index 5d5f458..4586ffa 100644
--- a/Products/TinyMCE/utility.py
+++ b/Products/TinyMCE/utility.py
@@ -42,6 +42,23 @@ class IBaseObject(Interface):
 PMF = MessageFactory('plone')
 BUTTON_WIDTHS = {'style': 150, 'forecolor': 32, 'backcolor': 32, 'tablecontrols': 285}
 
+XHTML_TAGS = set(
+    'a abbr acronym address area b base bdo big blockquote body br '
+    'button caption cite code col colgroup dd del div dfn dl dt em '
+    'fieldset form h1 h2 h3 h4 h5 h6 head hr html i img input ins kbd '
+    'label legend li link map meta noscript object ol optgroup option '
+    'p param pre q samp script select small span strong style sub sup '
+    'table tbody td textarea tfoot th thead title tr tt ul var'.split())
+
+CORE_ATTRS = set(
+    'id style title class'.split())
+
+I18N_ATTRS = set(
+    'lang dir'.split())
+
+FOCUS_ATTRS = set(
+    'accesskey tabindex'.split())
+
 
 try:
     from plone.app.textfield.interfaces import IRichText
@@ -392,23 +409,6 @@ def getValidElements(self):
         if safe_html.get_parameter_value('disable_transform'):
             return {'*': ['*']}
 
-        XHTML_TAGS = set(
-            'a abbr acronym address area b base bdo big blockquote body br '
-            'button caption cite code col colgroup dd del div dfn dl dt em '
-            'fieldset form h1 h2 h3 h4 h5 h6 head hr html i img input ins kbd '
-            'label legend li link map meta noscript object ol optgroup option '
-            'p param pre q samp script select small span strong style sub sup '
-            'table tbody td textarea tfoot th thead title tr tt ul var'.split())
-
-        CORE_ATTRS = set(
-            'id style title class'.split())
-
-        I18N_ATTRS = set(
-            'lang dir'.split())
-
-        FOCUS_ATTRS = set(
-            'accesskey tabindex'.split())
-
         COMMON_ATTRS = CORE_ATTRS | I18N_ATTRS
 
         valid_elements = {


