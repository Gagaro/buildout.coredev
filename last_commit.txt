Repository: plone.app.iterate


Branch: refs/heads/master
Date: 2015-09-20T02:44:21+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.iterate/commit/233c3d4f2238c01c61521aa00ed7cf5f50346ff3

Fixed test to pass with recent plone.app.content change.

This requires the cmf.ModifyPortalContent permission for the
content_status_history page.

Files changed:
M CHANGES.rst
M plone/app/iterate/tests/browser.rst

diff --git a/CHANGES.rst b/CHANGES.rst
index 8bddaaa..0c7eb86 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,7 +4,10 @@ Changelog
 3.1.2 (unreleased)
 ------------------
 
-- Nothing changed yet.
+- Fixed test to pass with recent plone.app.content change
+  that requires the cmf.ModifyPortalContent permission for the
+  content_status_history page.
+  [maurits]
 
 
 3.1.1 (2015-08-20)
diff --git a/plone/app/iterate/tests/browser.rst b/plone/app/iterate/tests/browser.rst
index 6814c29..6c3d9c5 100644
--- a/plone/app/iterate/tests/browser.rst
+++ b/plone/app/iterate/tests/browser.rst
@@ -107,15 +107,20 @@ therefore our Editor lacks permissions to modify the original::
     ...
     LinkNotFoundError
 
-The Editor could, however, retract the original to gain permissions
-again and check in (and then possibly request for review)::
+The Editor could, however, ask someone to retract the original so he
+gains permissions again and check in (and then possibly request for
+review)::
 
     >>> browser = z2.Browser(app)
-    >>> browser.addHeader('Authorization', 'Basic editor:secret')
+    >>> browser.addHeader('Authorization',
+    ...                   'Basic %s:%s' % (SITE_OWNER_NAME, SITE_OWNER_PASSWORD))
     >>> browser.open(portal.absolute_url() + '/hello-world')
     >>> browser.getLink("Published").click()
     >>> browser.getControl("Retract").click()
     >>> browser.getControl("Save").click()
+    >>> browser = z2.Browser(app)
+    >>> browser.addHeader('Authorization', 'Basic editor:secret')
+    >>> browser.open(portal.absolute_url() + '/hello-world')
     >>> browser.getLink("working copy").click()
     >>> browser.getLink("Check in").click()
     >>> browser.getControl("Check in").click()


