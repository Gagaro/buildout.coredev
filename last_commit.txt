Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2015-09-30T16:24:38+02:00
Author: Patrick Gerken (do3cc) <do3cc@patrick-gerken.de>
Commit: https://github.com/plone/plone.app.upgrade/commit/0ab47d6b4d6914e70574fb0aac12ec933dd51d71

Handle case of environment with CMFPlacefulworkflow

Files changed:
M plone/app/upgrade/__init__.py

diff --git a/plone/app/upgrade/__init__.py b/plone/app/upgrade/__init__.py
index 23c5cc0..3815aeb 100644
--- a/plone/app/upgrade/__init__.py
+++ b/plone/app/upgrade/__init__.py
@@ -140,7 +140,12 @@ def getNonInstallableProducts(self):
 
 # To solve the __iro__ problem because CMFPlacefulWorkflow interfaces changed on 1.6.1
 try:
+    pkg_resources.get_distribution('Products.CMFPlacefulWorkflow')
     from Products.CMFPlacefulWorkflow.interfaces import portal_placeful_workflow
+except pkg_resources.DistributionNotFound:
+    # No package in this environment requires CMFPlacefulWorkflow,
+    # so no patching necessary
+    pass
 except:
     from Products.CMFPlacefulWorkflow import interfaces
     alias_module('Products.CMFPlacefulWorkflow.interfaces.portal_placeful_workflow', interfaces)


Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2015-09-30T16:24:38+02:00
Author: Patrick Gerken (do3cc) <do3cc@patrick-gerken.de>
Commit: https://github.com/plone/plone.app.upgrade/commit/53183422b3a07406a3bfa96346f686e9af4302cd

Revert "add Products.CMFPlacefulWorkflow as dep as __init__ requires this"

This reverts commit 0da7c6cc10279bcbc7b478a349b874231ec0c729.

Files changed:
M setup.py

diff --git a/setup.py b/setup.py
index fa23d99..802ca43 100644
--- a/setup.py
+++ b/setup.py
@@ -61,7 +61,6 @@
         'Products.CMFDiffTool',
         'Products.CMFEditions',
         'Products.CMFFormController',
-        'Products.CMFPlacefulWorkflow',
         'Products.CMFQuickInstallerTool',
         'Products.CMFUid',
         'Products.DCWorkflow',


Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2015-10-01T10:54:17+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.upgrade/commit/f917b60d8c6d8109707b185358aff59e7847a05e

Merge pull request #34 from plone/do3cc_bla

Alternative solution to the dependency issue WARNING below

Files changed:
M plone/app/upgrade/__init__.py
M setup.py

diff --git a/plone/app/upgrade/__init__.py b/plone/app/upgrade/__init__.py
index 23c5cc0..3815aeb 100644
--- a/plone/app/upgrade/__init__.py
+++ b/plone/app/upgrade/__init__.py
@@ -140,7 +140,12 @@ def getNonInstallableProducts(self):
 
 # To solve the __iro__ problem because CMFPlacefulWorkflow interfaces changed on 1.6.1
 try:
+    pkg_resources.get_distribution('Products.CMFPlacefulWorkflow')
     from Products.CMFPlacefulWorkflow.interfaces import portal_placeful_workflow
+except pkg_resources.DistributionNotFound:
+    # No package in this environment requires CMFPlacefulWorkflow,
+    # so no patching necessary
+    pass
 except:
     from Products.CMFPlacefulWorkflow import interfaces
     alias_module('Products.CMFPlacefulWorkflow.interfaces.portal_placeful_workflow', interfaces)
diff --git a/setup.py b/setup.py
index fa23d99..802ca43 100644
--- a/setup.py
+++ b/setup.py
@@ -61,7 +61,6 @@
         'Products.CMFDiffTool',
         'Products.CMFEditions',
         'Products.CMFFormController',
-        'Products.CMFPlacefulWorkflow',
         'Products.CMFQuickInstallerTool',
         'Products.CMFUid',
         'Products.DCWorkflow',


