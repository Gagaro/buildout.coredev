Repository: plone.app.event


Branch: refs/heads/master
Date: 2015-09-22T03:06:22+02:00
Author: Johannes Raggam (thet) <raggam-nl@adm.at>
Commit: https://github.com/plone/plone.app.event/commit/ae4fdb9fd235a6393b6bfc905feaef74176eb224

Plone 4 compatibility for get_default_page import.

Files changed:
M CHANGES.rst
M plone/app/event/browser/event_listing.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 68a4330..b60d548 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,8 +4,8 @@ Changelog
 2.0.3 (unreleased)
 ------------------
 
-- Nothing changed yet.
-
+- Plone 4 compatibility for ``get_default_page`` import.
+  [thet]
 
 2.0.2 (2015-09-21)
 ------------------
diff --git a/plone/app/event/browser/event_listing.py b/plone/app/event/browser/event_listing.py
index be1223a..e8435e2 100644
--- a/plone/app/event/browser/event_listing.py
+++ b/plone/app/event/browser/event_listing.py
@@ -18,11 +18,16 @@
 from plone.app.querystring import queryparser
 from plone.memoize import view
 from plone.uuid.interfaces import IUUID
-from Products.CMFPlone.defaultpage import get_default_page
 from zope.component import getMultiAdapter
 from zope.contentprovider.interfaces import IContentProvider
 
 try:
+    from Products.CMFPlone.defaultpage import get_default_page
+except ImportError:
+    # Plone 4
+    from plone.app.layout.navigation.defaultpage import getDefaultPage as get_default_page  # noqa
+
+try:
     from plone.app.contenttypes.behaviors.collection import ISyndicatableCollection as ICollection  # noqa
 except ImportError:
     ICollection = None


Repository: plone.app.event


Branch: refs/heads/master
Date: 2015-09-22T04:42:36+02:00
Author: Johannes Raggam (thet) <raggam-nl@adm.at>
Commit: https://github.com/plone/plone.app.event/commit/e4338bc9070fef017cba07055bdf058f27cc0f47

Merge pull request #202 from plone/thet-defaultpage-plone4

Plone 4 compatibility for get_default_page import.

Files changed:
M CHANGES.rst
M plone/app/event/browser/event_listing.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 68a4330..b60d548 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,8 +4,8 @@ Changelog
 2.0.3 (unreleased)
 ------------------
 
-- Nothing changed yet.
-
+- Plone 4 compatibility for ``get_default_page`` import.
+  [thet]
 
 2.0.2 (2015-09-21)
 ------------------
diff --git a/plone/app/event/browser/event_listing.py b/plone/app/event/browser/event_listing.py
index be1223a..e8435e2 100644
--- a/plone/app/event/browser/event_listing.py
+++ b/plone/app/event/browser/event_listing.py
@@ -18,11 +18,16 @@
 from plone.app.querystring import queryparser
 from plone.memoize import view
 from plone.uuid.interfaces import IUUID
-from Products.CMFPlone.defaultpage import get_default_page
 from zope.component import getMultiAdapter
 from zope.contentprovider.interfaces import IContentProvider
 
 try:
+    from Products.CMFPlone.defaultpage import get_default_page
+except ImportError:
+    # Plone 4
+    from plone.app.layout.navigation.defaultpage import getDefaultPage as get_default_page  # noqa
+
+try:
     from plone.app.contenttypes.behaviors.collection import ISyndicatableCollection as ICollection  # noqa
 except ImportError:
     ICollection = None


