Repository: plone.app.users


Branch: refs/heads/master
Date: 2015-07-25T23:18:43-05:00
Author: vangheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/plone.app.users/commit/151fd134882b9d1b40acb08062d348a148d30f94

Disable toolbar buttons on personal preferences closes https://github.com/plone/Products.CMFPlone/issues/746

Files changed:
M CHANGES.rst
M plone/app/users/browser/personalpreferences.py
M plone/app/users/browser/userdatapanel.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 705daa4..19adaad 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,6 +4,9 @@ CHANGES
 2.3.1 (unreleased)
 ------------------
 
+- Disable toolbar buttons on personal preferences
+  [vangheem]
+
 - Remove extra spaces in userschema.xml messages to avoid i18n extraction
   warnings.
   [vincentfretin]
diff --git a/plone/app/users/browser/personalpreferences.py b/plone/app/users/browser/personalpreferences.py
index 818abd8..94f11fc 100644
--- a/plone/app/users/browser/personalpreferences.py
+++ b/plone/app/users/browser/personalpreferences.py
@@ -9,13 +9,13 @@
 from zope.schema import Choice
 
 try:
-    import plone.app.event  # nopep8
+    import plone.app.event  # noqa
     HAS_PAE = True
 except ImportError:
     HAS_PAE = False
 
 try:
-    import plone.app.vocabularies.datetimerelated  # nopep8
+    import plone.app.vocabularies.datetimerelated  # noqa
     HAS_DT_VOCAB = True
 except ImportError:
     HAS_DT_VOCAB = False
@@ -99,6 +99,10 @@ def updateWidgets(self):
             u"Use site default"
         )
 
+    def __call__(self):
+        self.request.set('disable_border', 1)
+        return super(PersonalPreferencesPanel, self).__call__()
+
 
 class PersonalPreferencesConfiglet(PersonalPreferencesPanel):
     """Control panel version of the personal preferences panel"""
diff --git a/plone/app/users/browser/userdatapanel.py b/plone/app/users/browser/userdatapanel.py
index 2cfa369..bbba4c0 100644
--- a/plone/app/users/browser/userdatapanel.py
+++ b/plone/app/users/browser/userdatapanel.py
@@ -93,6 +93,10 @@ def description(self):
                 default='Change your personal information'
             )
 
+    def __call__(self):
+        self.request.set('disable_border', 1)
+        return super(UserDataPanel, self).__call__()
+
 
 class UserDataConfiglet(UserDataPanel):
     """Control panel version of the userdata panel"""


Repository: plone.app.users


Branch: refs/heads/master
Date: 2015-07-26T00:35:08-05:00
Author: Nathan Van Gheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/plone.app.users/commit/7f7b5249bb7ef6fb95c5a250bf08a9e18889c7e6

Merge pull request #45 from plone/hide-toolbar-preferences

Disable toolbar buttons on personal preferences

Files changed:
M CHANGES.rst
M plone/app/users/browser/personalpreferences.py
M plone/app/users/browser/userdatapanel.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 705daa4..19adaad 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,6 +4,9 @@ CHANGES
 2.3.1 (unreleased)
 ------------------
 
+- Disable toolbar buttons on personal preferences
+  [vangheem]
+
 - Remove extra spaces in userschema.xml messages to avoid i18n extraction
   warnings.
   [vincentfretin]
diff --git a/plone/app/users/browser/personalpreferences.py b/plone/app/users/browser/personalpreferences.py
index 818abd8..94f11fc 100644
--- a/plone/app/users/browser/personalpreferences.py
+++ b/plone/app/users/browser/personalpreferences.py
@@ -9,13 +9,13 @@
 from zope.schema import Choice
 
 try:
-    import plone.app.event  # nopep8
+    import plone.app.event  # noqa
     HAS_PAE = True
 except ImportError:
     HAS_PAE = False
 
 try:
-    import plone.app.vocabularies.datetimerelated  # nopep8
+    import plone.app.vocabularies.datetimerelated  # noqa
     HAS_DT_VOCAB = True
 except ImportError:
     HAS_DT_VOCAB = False
@@ -99,6 +99,10 @@ def updateWidgets(self):
             u"Use site default"
         )
 
+    def __call__(self):
+        self.request.set('disable_border', 1)
+        return super(PersonalPreferencesPanel, self).__call__()
+
 
 class PersonalPreferencesConfiglet(PersonalPreferencesPanel):
     """Control panel version of the personal preferences panel"""
diff --git a/plone/app/users/browser/userdatapanel.py b/plone/app/users/browser/userdatapanel.py
index 2cfa369..bbba4c0 100644
--- a/plone/app/users/browser/userdatapanel.py
+++ b/plone/app/users/browser/userdatapanel.py
@@ -93,6 +93,10 @@ def description(self):
                 default='Change your personal information'
             )
 
+    def __call__(self):
+        self.request.set('disable_border', 1)
+        return super(UserDataPanel, self).__call__()
+
 
 class UserDataConfiglet(UserDataPanel):
     """Control panel version of the userdata panel"""


