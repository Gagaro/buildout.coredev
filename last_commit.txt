Repository: plone.app.querystring


Branch: refs/heads/master
Date: 2015-09-18T22:14:12+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.querystring/commit/1e84811f821615a9dc00e2fe608f80951769054a

Check if key is in the catalog indexes, for mapSortableIndexes.

Files changed:
M plone/app/querystring/registryreader.py

diff --git a/plone/app/querystring/registryreader.py b/plone/app/querystring/registryreader.py
index 3a49c28..4db677e 100644
--- a/plone/app/querystring/registryreader.py
+++ b/plone/app/querystring/registryreader.py
@@ -108,7 +108,7 @@ def mapSortableIndexes(self, values):
         catalog = getToolByName(getSite(), 'portal_catalog')._catalog
         sortables = {}
         for key, field in values.get('%s.field' % self.prefix).iteritems():
-            if field['sortable'] and \
+            if field['sortable'] and key in catalog.indexes and \
                not IZCTextIndex.providedBy(catalog.getIndex(key)):
                 sortables[key] = values.get('%s.field.%s' % (self.prefix, key))
         values['sortable'] = sortables


