Repository: mockup


Branch: refs/heads/master
Date: 2015-09-03T15:18:22-05:00
Author: vangheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/mockup/commit/a64d440d8a22544fb1914a7f610e65c43b446290

fix case where file could be undefined caused by https://github.com/plone/mockup/commit/2b843802149986b7bb09e25abf1ed3e63f17e3e0

Files changed:
M mockup/patterns/upload/pattern.js

diff --git a/mockup/patterns/upload/pattern.js b/mockup/patterns/upload/pattern.js
index d523c59..1f28e51 100644
--- a/mockup/patterns/upload/pattern.js
+++ b/mockup/patterns/upload/pattern.js
@@ -99,7 +99,7 @@ define([
         var items = oe.clipboardData.items;
         if (items) {
           for (var i = 0; i < items.length; i++) {
-            if (items[i].type.indexOf("image") !== -1) {
+            if (items[i].type.indexOf('image') !== -1) {
               var blob = items[i].getAsFile();
               self.dropzone.addFile(blob);
             }
@@ -381,14 +381,11 @@ define([
           processing = false;
         }
 
-        if (processing){
-          var file = self.dropzone.files[0];
-
-          if (file.status === Dropzone.ERROR){
-            // Put the file back as "queued" for retrying
-            file.status = Dropzone.QUEUED;
-            processing = false;
-          }
+        var file = self.dropzone.files[0];
+        if (processing && file.status === Dropzone.ERROR){
+          // Put the file back as "queued" for retrying
+          file.status = Dropzone.QUEUED;
+          processing = false;
         }
 
         if (!processing){


Repository: mockup


Branch: refs/heads/master
Date: 2015-09-03T15:24:25-05:00
Author: Sam Schwartz (obct537) <schwas45@uwosh.edu>
Commit: https://github.com/plone/mockup/commit/d38afd7f0ecfe6112253428d74d0559a43aed1a3

Merge pull request #566 from plone/file-processing-fixes

fix case where file could be undefined

Files changed:
M mockup/patterns/upload/pattern.js

diff --git a/mockup/patterns/upload/pattern.js b/mockup/patterns/upload/pattern.js
index d523c59..1f28e51 100644
--- a/mockup/patterns/upload/pattern.js
+++ b/mockup/patterns/upload/pattern.js
@@ -99,7 +99,7 @@ define([
         var items = oe.clipboardData.items;
         if (items) {
           for (var i = 0; i < items.length; i++) {
-            if (items[i].type.indexOf("image") !== -1) {
+            if (items[i].type.indexOf('image') !== -1) {
               var blob = items[i].getAsFile();
               self.dropzone.addFile(blob);
             }
@@ -381,14 +381,11 @@ define([
           processing = false;
         }
 
-        if (processing){
-          var file = self.dropzone.files[0];
-
-          if (file.status === Dropzone.ERROR){
-            // Put the file back as "queued" for retrying
-            file.status = Dropzone.QUEUED;
-            processing = false;
-          }
+        var file = self.dropzone.files[0];
+        if (processing && file.status === Dropzone.ERROR){
+          // Put the file back as "queued" for retrying
+          file.status = Dropzone.QUEUED;
+          processing = false;
         }
 
         if (!processing){


