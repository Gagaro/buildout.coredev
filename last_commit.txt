Repository: plone.app.contenttypes


Branch: refs/heads/master
Date: 2015-09-11T12:42:12+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.contenttypes/commit/832799337f5002ce76f7849f71604d23407bf8be

migrate next-previous-navigation

Files changed:
M CHANGES.rst
M docs/README.rst
M plone/app/contenttypes/migration/migration.py

diff --git a/CHANGES.rst b/CHANGES.rst
index fdf9d02..ad9d16b 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,7 +4,9 @@ Changelog
 1.2.1 (unreleased)
 ------------------
 
-- Nothing changed yet.
+- Migrate next-previous-navigation.
+  Fix https://github.com/plone/plone.app.contenttypes/issues/267
+  [pbauer]
 
 
 1.2.0 (2015-09-07)
diff --git a/docs/README.rst b/docs/README.rst
index 8d453ec..90324b3 100644
--- a/docs/README.rst
+++ b/docs/README.rst
@@ -32,7 +32,7 @@ It contains the following types:
 * Link
 * News Item
 
-The main difference from a users perspective is that these types are extendable through-the-web. This means you can add or remove fields and behaviors using the control-panel "Dexterity Content Types" (``/@@dexterity-types``).
+The main difference from a users perspective is that these types are editable and extendable through-the-web. This means you can add or remove fields and behaviors using the control-panel "Dexterity Content Types" (``/@@dexterity-types``).
 
 **Warning: Using plone.app.contenttypes on a site with existing Archetypes-based content requires migrating the sites content. Please see the chapter "Migration".**
 
@@ -96,11 +96,11 @@ If you install plone.app.contenttypes on a fresh site (i.e. when no content has
 Uninstalling
 ------------
 
-Uninstalling the default-types is not supported in Plone 5. If you really want to switch back to Archetypes-based types you have to to the following:
+Uninstalling the default-types is not officially supported in Plone 5. If you really want to switch back to Archetypes-based types you have to to the following:
 
 * Go to the ZMI
 * In portal_types delete the default-types
-* In portal_setup navigate to the tab 'import', select the profile 'Archetypes Content Types for Plone' and install all step including dependencies.
+* In portal_setup navigate to the tab 'import', select the profile 'Archetypes Content Types for Plone' and install all steps including dependencies.
 
 Any content you created based on plone.app.contenttypes will no longer be editable until you reinstall plone.app.contenttypes.
 
diff --git a/plone/app/contenttypes/migration/migration.py b/plone/app/contenttypes/migration/migration.py
index a0a846d..013b3ec 100644
--- a/plone/app/contenttypes/migration/migration.py
+++ b/plone/app/contenttypes/migration/migration.py
@@ -31,6 +31,7 @@
 from plone.app.contenttypes.migration.field_migrators import \
     migrate_simplefield
 from plone.app.contenttypes.upgrades import LISTING_VIEW_MAPPING
+from plone.app.dexterity.behaviors.nextprevious import INextPreviousToggle
 from plone.dexterity.interfaces import IDexterityContent
 from plone.dexterity.interfaces import IDexterityFTI
 from zope.component import adapter
@@ -175,6 +176,11 @@ def migrate_contentrules(self):
     def migrate_leadimage(self):
         migrate_leadimage(self.old, self.new)
 
+    def migrate_nextprevious(self):
+        if self.old.getNextPreviousEnabled():
+            if INextPreviousToggle.providedBy(self.new):
+                self.new.nextPreviousEnabled = True
+
     def last_migrate_comments(self):
         """Migrate the plone.app.discussion comments.
            Comments were stored on the portal, get them and


