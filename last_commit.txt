Repository: Products.CMFPlone
Branch: refs/heads/master
Date: 2015-02-02T14:05:49+01:00
Author: Patrick Gerken (do3cc) <do3cc@patrick-gerken.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/efb09393356299b4e948c0372309e985c2fcf626

Fail explicitly if locales are missing.

Else tests fail without good error messages.

Files changed:
M Products/CMFPlone/tests/testUnicodeSplitter.py

diff --git a/Products/CMFPlone/tests/testUnicodeSplitter.py b/Products/CMFPlone/tests/testUnicodeSplitter.py
index 3c31eeb..116dcaf 100644
--- a/Products/CMFPlone/tests/testUnicodeSplitter.py
+++ b/Products/CMFPlone/tests/testUnicodeSplitter.py
@@ -1,7 +1,6 @@
 # -*- coding: utf-8 -*-
 import unittest
 from Products.CMFPlone.tests import PloneTestCase
-
 from Products.CMFPlone.UnicodeSplitter import Splitter
 from Products.CMFPlone.UnicodeSplitter import CaseNormalizer
 
@@ -21,10 +20,12 @@ def _setlocale(*names):
         try:
             locale.setlocale(locale.LC_ALL, name)
             break
-        except locale.Error:
+        except locale.Error, e:
             pass
     else:
-        return None
+        raise e.__class__("Unsupported locale. These tests need at least one "
+                          "of the following locales available on your system",
+                          str(LATIN1))
     return saved
 
 


Repository: Products.CMFPlone
Branch: refs/heads/master
Date: 2015-02-12T15:35:17-06:00
Author: Nathan Van Gheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/b01a89a8637e518fba2d1df6ed15164ee2e8a9d7

Merge pull request #366 from do3cc/unicode_explicit_failure_50_cherry

Fail explicitly if locales are missing.

Files changed:
M Products/CMFPlone/tests/testUnicodeSplitter.py

diff --git a/Products/CMFPlone/tests/testUnicodeSplitter.py b/Products/CMFPlone/tests/testUnicodeSplitter.py
index 3c31eeb..116dcaf 100644
--- a/Products/CMFPlone/tests/testUnicodeSplitter.py
+++ b/Products/CMFPlone/tests/testUnicodeSplitter.py
@@ -1,7 +1,6 @@
 # -*- coding: utf-8 -*-
 import unittest
 from Products.CMFPlone.tests import PloneTestCase
-
 from Products.CMFPlone.UnicodeSplitter import Splitter
 from Products.CMFPlone.UnicodeSplitter import CaseNormalizer
 
@@ -21,10 +20,12 @@ def _setlocale(*names):
         try:
             locale.setlocale(locale.LC_ALL, name)
             break
-        except locale.Error:
+        except locale.Error, e:
             pass
     else:
-        return None
+        raise e.__class__("Unsupported locale. These tests need at least one "
+                          "of the following locales available on your system",
+                          str(LATIN1))
     return saved
 
 


