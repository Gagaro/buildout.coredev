Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2015-08-05T01:12:13+02:00
Author: Eric BREHAULT (ebrehault) <ebrehault@gmail.com>
Commit: https://github.com/plone/plone.app.upgrade/commit/35954bb747bcbc786b12c51ce0e1e5e050732ff8

Turn @@tinymce-controlpanel content_css field into a list

Files changed:
A plone/app/upgrade/v50/profiles/to_beta4/registry.xml
M CHANGES.rst
M plone/app/upgrade/v50/betas.py
M plone/app/upgrade/v50/configure.zcml
M plone/app/upgrade/v50/profiles.zcml

diff --git a/CHANGES.rst b/CHANGES.rst
index d5325c9..452129f 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,7 +4,8 @@ Changelog
 1.3.13 (unreleased)
 -------------------
 
-- Nothing changed yet.
+- Turn @@tinymce-controlpanel ``content_css`` field into a list
+  [ebrehault]
 
 
 1.3.12 (2015-07-23)
diff --git a/plone/app/upgrade/v50/betas.py b/plone/app/upgrade/v50/betas.py
index ea35560..1bbf12a 100644
--- a/plone/app/upgrade/v50/betas.py
+++ b/plone/app/upgrade/v50/betas.py
@@ -259,3 +259,8 @@ def to50beta3(context):
     ][0]
     configlet.title = "Content Settings"
     configlet.url_expr = "string:${portal_url}/@@content-controlpanel"
+
+
+def to50beta4(context):
+    """5.0beta3 -> 5.0beta4"""
+    loadMigrationProfile(context, 'profile-plone.app.upgrade.v50:to50beta4')
diff --git a/plone/app/upgrade/v50/configure.zcml b/plone/app/upgrade/v50/configure.zcml
index a6ad68e..17252bf 100644
--- a/plone/app/upgrade/v50/configure.zcml
+++ b/plone/app/upgrade/v50/configure.zcml
@@ -142,5 +142,17 @@
            />
 
     </gs:upgradeSteps>
+    <gs:upgradeSteps
+        source="5006"
+        destination="5007"
+        profile="Products.CMFPlone:plone">
+
+       <gs:upgradeStep
+           title="Run to50beta4 upgrade profile"
+           description=""
+           handler=".betas.to50beta4"
+           />
+
+    </gs:upgradeSteps>
 
 </configure>
diff --git a/plone/app/upgrade/v50/profiles.zcml b/plone/app/upgrade/v50/profiles.zcml
index 7c00e9c..0fd0372 100644
--- a/plone/app/upgrade/v50/profiles.zcml
+++ b/plone/app/upgrade/v50/profiles.zcml
@@ -47,4 +47,13 @@
       for="Products.CMFPlone.interfaces.IMigratingPloneSiteRoot"
       provides="Products.GenericSetup.interfaces.EXTENSION"
       />
+
+  <genericsetup:registerProfile
+      name="to50beta4"
+      title="Upgrade profile for Plone 5006 to Plone 5.0b4"
+      description=""
+      directory="profiles/to_beta4"
+      for="Products.CMFPlone.interfaces.IMigratingPloneSiteRoot"
+      provides="Products.GenericSetup.interfaces.EXTENSION"
+      />
 </configure>
diff --git a/plone/app/upgrade/v50/profiles/to_beta4/registry.xml b/plone/app/upgrade/v50/profiles/to_beta4/registry.xml
new file mode 100644
index 0000000..796dadf
--- /dev/null
+++ b/plone/app/upgrade/v50/profiles/to_beta4/registry.xml
@@ -0,0 +1,10 @@
+<?xml version="1.0"?>
+<registry>
+  <records interface="Products.CMFPlone.interfaces.ITinyMCESchema"
+           prefix="plone">
+    <value key="content_css">
+      <element>++plone++static/components/tinymce-builded/js/tinymce/skins/lightgray/content.min.css</element>
+    </value>
+  </records>
+
+</registry>
\ No newline at end of file


Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2015-08-05T07:46:05+02:00
Author: Eric BREHAULT (ebrehault) <ebrehault@gmail.com>
Commit: https://github.com/plone/plone.app.upgrade/commit/206595e7650bd91bf08d6741b32313f3cb02329e

Merge pull request #41 from plone/ebr-tiny-css-content-list

Turn @@tinymce-controlpanel content_css field into a list

Files changed:
A plone/app/upgrade/v50/profiles/to_beta4/registry.xml
M CHANGES.rst
M plone/app/upgrade/v50/betas.py
M plone/app/upgrade/v50/configure.zcml
M plone/app/upgrade/v50/profiles.zcml

diff --git a/CHANGES.rst b/CHANGES.rst
index d5325c9..452129f 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,7 +4,8 @@ Changelog
 1.3.13 (unreleased)
 -------------------
 
-- Nothing changed yet.
+- Turn @@tinymce-controlpanel ``content_css`` field into a list
+  [ebrehault]
 
 
 1.3.12 (2015-07-23)
diff --git a/plone/app/upgrade/v50/betas.py b/plone/app/upgrade/v50/betas.py
index ea35560..1bbf12a 100644
--- a/plone/app/upgrade/v50/betas.py
+++ b/plone/app/upgrade/v50/betas.py
@@ -259,3 +259,8 @@ def to50beta3(context):
     ][0]
     configlet.title = "Content Settings"
     configlet.url_expr = "string:${portal_url}/@@content-controlpanel"
+
+
+def to50beta4(context):
+    """5.0beta3 -> 5.0beta4"""
+    loadMigrationProfile(context, 'profile-plone.app.upgrade.v50:to50beta4')
diff --git a/plone/app/upgrade/v50/configure.zcml b/plone/app/upgrade/v50/configure.zcml
index a6ad68e..17252bf 100644
--- a/plone/app/upgrade/v50/configure.zcml
+++ b/plone/app/upgrade/v50/configure.zcml
@@ -142,5 +142,17 @@
            />
 
     </gs:upgradeSteps>
+    <gs:upgradeSteps
+        source="5006"
+        destination="5007"
+        profile="Products.CMFPlone:plone">
+
+       <gs:upgradeStep
+           title="Run to50beta4 upgrade profile"
+           description=""
+           handler=".betas.to50beta4"
+           />
+
+    </gs:upgradeSteps>
 
 </configure>
diff --git a/plone/app/upgrade/v50/profiles.zcml b/plone/app/upgrade/v50/profiles.zcml
index 7c00e9c..0fd0372 100644
--- a/plone/app/upgrade/v50/profiles.zcml
+++ b/plone/app/upgrade/v50/profiles.zcml
@@ -47,4 +47,13 @@
       for="Products.CMFPlone.interfaces.IMigratingPloneSiteRoot"
       provides="Products.GenericSetup.interfaces.EXTENSION"
       />
+
+  <genericsetup:registerProfile
+      name="to50beta4"
+      title="Upgrade profile for Plone 5006 to Plone 5.0b4"
+      description=""
+      directory="profiles/to_beta4"
+      for="Products.CMFPlone.interfaces.IMigratingPloneSiteRoot"
+      provides="Products.GenericSetup.interfaces.EXTENSION"
+      />
 </configure>
diff --git a/plone/app/upgrade/v50/profiles/to_beta4/registry.xml b/plone/app/upgrade/v50/profiles/to_beta4/registry.xml
new file mode 100644
index 0000000..796dadf
--- /dev/null
+++ b/plone/app/upgrade/v50/profiles/to_beta4/registry.xml
@@ -0,0 +1,10 @@
+<?xml version="1.0"?>
+<registry>
+  <records interface="Products.CMFPlone.interfaces.ITinyMCESchema"
+           prefix="plone">
+    <value key="content_css">
+      <element>++plone++static/components/tinymce-builded/js/tinymce/skins/lightgray/content.min.css</element>
+    </value>
+  </records>
+
+</registry>
\ No newline at end of file


