Repository: plone.app.caching
Branch: refs/heads/master
Date: 2015-06-04T14:40:42-05:00
Author: vangheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/plone.app.caching/commit/cadd435512afbe0d28185b3967624172032f4f99

tweak

Files changed:
M plone/app/caching/browser/controlpanel.pt
M plone/app/caching/browser/import.pt
M plone/app/caching/browser/purge.pt
M plone/app/caching/browser/ramcache.pt

diff --git a/plone/app/caching/browser/controlpanel.pt b/plone/app/caching/browser/controlpanel.pt
index d1f541c..13146f1 100644
--- a/plone/app/caching/browser/controlpanel.pt
+++ b/plone/app/caching/browser/controlpanel.pt
@@ -8,13 +8,13 @@
 
 <body>
 
-<div metal:fill-slot="prefs_configlet_content">
+<div metal:fill-slot="prefs_configlet_main">
 
 <script type="text/javascript">
 (function($) {
 
+    if($.fn.prepOverlay){
     $().ready(function() {
-    debugger;
         $('a.editGlobalOperationParameters, a.editRulesetOperationParameters').prepOverlay({
             subtype: 'ajax',
             filter: '#content>*:not(div.configlet),dl.portalMessage.error,dl.portalMessage.info',
@@ -23,32 +23,62 @@
             noform: 'close'
         });
     });
+    }
 
 })(jQuery);
 </script>
 
-        <div class="documentContent" id="content">
-            <a name="documentContent"></a>
-
-            <div metal:use-macro="context/global_statusmessage/macros/portal_message">
-            Portal status message
-            </div>
-            <div class="portalMessage info"
-                tal:condition="not: view/settings/enabled">
-                <strong i18n:translate="">
-                    Info
-                </strong>
-                <span tal:omit-tag=""
-                    i18n:translate="label_caching_first_time_here?">
-                    First time here? We recommend that you get started by
-                    <a href="@@caching-controlpanel-import"
-                       tal:attributes="href string:${context/absolute_url}/@@caching-controlpanel-import"
-                       title="Import caching rules"
-                       i18n:name="link"
-                       i18n:translate="label_caching_first_time_here_link"
-                       >importing a preconfigured caching set of rules</a>.
-                </span>
+    <metal:override fill-slot="content-title">
+        <metal:override define-slot="content-title">
+            <div class="autotabs">
+                <ul class="formTabs autotoc-nav">
+                    <li class="formTab firstFormTab">
+                        <a href=""
+                           class="active selected"
+                           tal:attributes="href string:${portal_url}/@@caching-controlpanel"
+                           i18n:translate="label_settings">Change settings</a>
+                      </li>
+                      <li class="formTab">
+                        <a href=""
+                           tal:attributes="href string:${portal_url}/@@caching-controlpanel-import"
+                           i18n:translate="label_import">Import settings</a>
+                      </li>
+                      <li tal:condition="view/purgingEnabled" class="formTab">
+                        <a href=""
+                           tal:attributes="href string:${portal_url}/@@caching-controlpanel-purge"
+                           i18n:translate="label_purging">Purge caching proxy</a>
+                      </li>
+                      <li class="formTab lastFormTab">
+                        <a href=""
+                           tal:attributes="href string:${portal_url}/@@caching-controlpanel-ramcache"
+                           i18n:translate="label_ramcache">RAM cache</a>
+                      </li>
+                </ul>
             </div>
+        </metal:override>
+    </metal:override>
+
+    <div class="portalMessage info"
+        tal:condition="not: view/settings/enabled">
+        <strong i18n:translate="">
+            Info
+        </strong>
+        <span tal:omit-tag=""
+            i18n:translate="label_caching_first_time_here?">
+            First time here? We recommend that you get started by
+            <a href="@@caching-controlpanel-import"
+               tal:attributes="href string:${context/absolute_url}/@@caching-controlpanel-import"
+               title="Import caching rules"
+               i18n:name="link"
+               i18n:translate="label_caching_first_time_here_link"
+               >importing a preconfigured caching set of rules</a>.
+        </span>
+    </div>
+
+    <div metal:use-macro="context/global_statusmessage/macros/portal_message">
+    Portal status message
+    </div>
+
 
             <div class="configlet">
 
@@ -61,35 +91,15 @@
                     cached.
                 </p>
 
+
                 <form
                     name="settings"
                     method="post"
-                    class="enableUnloadProtection autotabs"
+                    class="enableFormTabbing enableUnloadProtection pat-autotoc"
+                    data-pat-autotoc="levels: legend; section: fieldset; className: autotabs"
                     tal:attributes="action request/URL"
                     tal:define="errors view/errors">
-                    <ul class="formTabs autotoc-nav">
-                        <li class="formTab firstFormTab">
-                            <a href=""
-                               class="active selected"
-                               tal:attributes="href string:${portal_url}/@@caching-controlpanel"
-                               i18n:translate="label_settings">Change settings</a>
-                          </li>
-                          <li class="formTab">
-                            <a href=""
-                               tal:attributes="href string:${portal_url}/@@caching-controlpanel-import"
-                               i18n:translate="label_import">Import settings</a>
-                          </li>
-                          <li tal:condition="view/purgingEnabled" class="formTab">
-                            <a href=""
-                               tal:attributes="href string:${portal_url}/@@caching-controlpanel-purge"
-                               i18n:translate="label_purging">Purge caching proxy</a>
-                          </li>
-                          <li class="formTab lastFormTab">
-                            <a href=""
-                               tal:attributes="href string:${portal_url}/@@caching-controlpanel-ramcache"
-                               i18n:translate="label_ramcache">RAM cache</a>
-                          </li>
-                    </ul>
+
 
                     <!-- Field set: global settings -->
                     <fieldset id="fieldset-global-settings">
@@ -661,7 +671,5 @@
                 </form>
             </div>
         </div>
-    </div>
-
 </body>
 </html>
diff --git a/plone/app/caching/browser/import.pt b/plone/app/caching/browser/import.pt
index b481fff..8d04167 100644
--- a/plone/app/caching/browser/import.pt
+++ b/plone/app/caching/browser/import.pt
@@ -8,10 +8,37 @@
 
 <body>
 
-<div metal:fill-slot="prefs_configlet_content">
-
-        <div class="documentContent" id="content">
-            <a name="documentContent"></a>
+<div metal:fill-slot="prefs_configlet_main">
+
+    <metal:override fill-slot="content-title">
+        <metal:override define-slot="content-title">
+            <div class="autotabs">
+                <ul class="formTabs autotoc-nav">
+                    <li class="formTab firstFormTab">
+                        <a href=""
+                           tal:attributes="href string:${portal_url}/@@caching-controlpanel"
+                           i18n:translate="label_settings">Change settings</a>
+                      </li>
+                      <li class="formTab">
+                        <a href=""
+                           class="active selected"
+                           tal:attributes="href string:${portal_url}/@@caching-controlpanel-import"
+                           i18n:translate="label_import">Import settings</a>
+                      </li>
+                      <li tal:condition="view/purgingEnabled" class="formTab">
+                        <a href=""
+                           tal:attributes="href string:${portal_url}/@@caching-controlpanel-purge"
+                           i18n:translate="label_purging">Purge caching proxy</a>
+                      </li>
+                      <li class="formTab lastFormTab">
+                        <a href=""
+                           tal:attributes="href string:${portal_url}/@@caching-controlpanel-ramcache"
+                           i18n:translate="label_ramcache">RAM cache</a>
+                      </li>
+                </ul>
+            </div>
+        </metal:override>
+    </metal:override>
 
             <div metal:use-macro="context/global_statusmessage/macros/portal_message">
             Portal status message
@@ -37,31 +64,8 @@
                 </p>
 
                 <form name="profiles" tal:attributes="action request/URL" method="post"
-                    class="enableUnloadProtection autotabs"
+                    class="enableUnloadProtection"
                     tal:define="errors view/errors">
-                    <ul class="formTabs autotoc-nav">
-                        <li class="formTab firstFormTab">
-                            <a href=""
-                               tal:attributes="href string:${portal_url}/@@caching-controlpanel"
-                               i18n:translate="label_settings">Change settings</a>
-                          </li>
-                          <li class="formTab">
-                            <a href=""
-                               class="active selected"
-                               tal:attributes="href string:${portal_url}/@@caching-controlpanel-import"
-                               i18n:translate="label_import">Import settings</a>
-                          </li>
-                          <li tal:condition="view/purgingEnabled" class="formTab">
-                            <a href=""
-                               tal:attributes="href string:${portal_url}/@@caching-controlpanel-purge"
-                               i18n:translate="label_purging">Purge caching proxy</a>
-                          </li>
-                          <li class="formTab lastFormTab">
-                            <a href=""
-                               tal:attributes="href string:${portal_url}/@@caching-controlpanel-ramcache"
-                               i18n:translate="label_ramcache">RAM cache</a>
-                          </li>
-                    </ul>
 
                     <div class="field">
 
@@ -123,7 +127,6 @@
 
                 </form>
             </div>
-        </div>
     </div>
 
 </body>
diff --git a/plone/app/caching/browser/purge.pt b/plone/app/caching/browser/purge.pt
index 728443f..9c7602b 100644
--- a/plone/app/caching/browser/purge.pt
+++ b/plone/app/caching/browser/purge.pt
@@ -8,10 +8,37 @@
 
 <body>
 
-<div metal:fill-slot="prefs_configlet_content">
-
-        <div class="documentContent" id="content">
-            <a name="documentContent"></a>
+<div metal:fill-slot="prefs_configlet_main">
+
+    <metal:override fill-slot="content-title">
+        <metal:override define-slot="content-title">
+            <div class="autotabs">
+                <ul class="formTabs autotoc-nav">
+                    <li class="formTab firstFormTab">
+                        <a href=""
+                           tal:attributes="href string:${portal_url}/@@caching-controlpanel"
+                           i18n:translate="label_settings">Change settings</a>
+                      </li>
+                      <li class="formTab">
+                        <a href=""
+                           tal:attributes="href string:${portal_url}/@@caching-controlpanel-import"
+                           i18n:translate="label_import">Import settings</a>
+                      </li>
+                      <li tal:condition="view/purgingEnabled" class="formTab">
+                        <a href=""
+                           class="active selected"
+                           tal:attributes="href string:${portal_url}/@@caching-controlpanel-purge"
+                           i18n:translate="label_purging">Purge caching proxy</a>
+                      </li>
+                      <li class="formTab lastFormTab">
+                        <a href=""
+                           tal:attributes="href string:${portal_url}/@@caching-controlpanel-ramcache"
+                           i18n:translate="label_ramcache">RAM cache</a>
+                      </li>
+                </ul>
+            </div>
+        </metal:override>
+    </metal:override>
 
             <div metal:use-macro="context/global_statusmessage/macros/portal_message">
             Portal status message
@@ -49,32 +76,9 @@
                 </div>
 
                 <form name="purge" tal:attributes="action string:${request/URL}" method="post"
-                    class="enableUnloadProtection autotabs"
+                    class="enableUnloadProtection"
                     tal:define="errors view/errors">
-                    <ul class="formTabs autotoc-nav">
-                        <li class="formTab firstFormTab">
-                            <a href=""
-                               tal:attributes="href string:${portal_url}/@@caching-controlpanel"
-                               i18n:translate="label_settings">Change settings</a>
-                          </li>
-                          <li class="formTab">
-                            <a href=""
-                               tal:attributes="href string:${portal_url}/@@caching-controlpanel-import"
-                               i18n:translate="label_import">Import settings</a>
-                          </li>
-                          <li tal:condition="view/purgingEnabled" class="formTab">
-                            <a href=""
-                               class="active selected"
-                               tal:attributes="href string:${portal_url}/@@caching-controlpanel-purge"
-                               i18n:translate="label_purging">Purge caching proxy</a>
-                          </li>
-                          <li class="formTab lastFormTab">
-                            <a href=""
-                               tal:attributes="href string:${portal_url}/@@caching-controlpanel-ramcache"
-                               i18n:translate="label_ramcache">RAM cache</a>
-                          </li>
-                    </ul>
-
+                    
                     <div tal:define="error errors/urls | nothing"
                          tal:attributes="class python:'field error' if error else 'field'">
 
@@ -127,7 +131,6 @@
 
                 </form>
             </div>
-        </div>
 
 </div>
 </body>
diff --git a/plone/app/caching/browser/ramcache.pt b/plone/app/caching/browser/ramcache.pt
index cff74cd..8f087c1 100644
--- a/plone/app/caching/browser/ramcache.pt
+++ b/plone/app/caching/browser/ramcache.pt
@@ -8,9 +8,37 @@
 
 <body>
 
-<div metal:fill-slot="prefs_configlet_content">
-        <div class="documentContent" id="content">
-            <a name="documentContent"></a>
+<div metal:fill-slot="prefs_configlet_main">
+
+      <metal:override fill-slot="content-title">
+        <metal:override define-slot="content-title">
+            <div class="autotabs">
+                <ul class="formTabs autotoc-nav">
+                    <li class="formTab firstFormTab">
+                        <a href=""
+                           tal:attributes="href string:${portal_url}/@@caching-controlpanel"
+                           i18n:translate="label_settings">Change settings</a>
+                      </li>
+                      <li class="formTab">
+                        <a href=""
+                           tal:attributes="href string:${portal_url}/@@caching-controlpanel-import"
+                           i18n:translate="label_import">Import settings</a>
+                      </li>
+                      <li tal:condition="view/purgingEnabled" class="formTab">
+                        <a href=""
+                           tal:attributes="href string:${portal_url}/@@caching-controlpanel-purge"
+                           i18n:translate="label_purging">Purge caching proxy</a>
+                      </li>
+                      <li class="formTab lastFormTab">
+                        <a href=""
+                           class="active selected"
+                           tal:attributes="href string:${portal_url}/@@caching-controlpanel-ramcache"
+                           i18n:translate="label_ramcache">RAM cache</a>
+                      </li>
+                </ul>
+            </div>
+        </metal:override>
+    </metal:override>
 
             <div metal:use-macro="context/global_statusmessage/macros/portal_message">
             Portal status message
@@ -35,32 +63,9 @@
                 </p>
 
                 <form name="purge" tal:attributes="action string:${request/URL}" method="post"
-                    class="enableUnloadProtection autotabs"
+                    class="enableUnloadProtection"
                     tal:define="errors view/errors">
-                    <ul class="formTabs autotoc-nav">
-                        <li class="formTab firstFormTab">
-                            <a href=""
-                               tal:attributes="href string:${portal_url}/@@caching-controlpanel"
-                               i18n:translate="label_settings">Change settings</a>
-                          </li>
-                          <li class="formTab">
-                            <a href=""
-                               tal:attributes="href string:${portal_url}/@@caching-controlpanel-import"
-                               i18n:translate="label_import">Import settings</a>
-                          </li>
-                          <li tal:condition="view/purgingEnabled" class="formTab">
-                            <a href=""
-                               tal:attributes="href string:${portal_url}/@@caching-controlpanel-purge"
-                               i18n:translate="label_purging">Purge caching proxy</a>
-                          </li>
-                          <li class="formTab lastFormTab">
-                            <a href=""
-                               class="active selected"
-                               tal:attributes="href string:${portal_url}/@@caching-controlpanel-ramcache"
-                               i18n:translate="label_ramcache">RAM cache</a>
-                          </li>
-                    </ul>
-
+                    
                   <table tal:define="stats view/ramCache/getStatistics"
                          class="listing nosort" summary="RAM cache statistics"
                          i18n:attributes="summary heading_ramcache_stats;">
@@ -95,7 +100,6 @@
 
                 </form>
             </div>
-        </div>
 
 </div>
 </body>


