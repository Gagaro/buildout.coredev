Repository: plone.app.querystring


Branch: refs/heads/master
Date: 2015-08-20T12:15:45+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.querystring/commit/a6596377a6886b51b3ac989aac2bd247bf511750

Revert "Use selection.all for portal_types, review_state and Creator operations."

This reverts commit 7b0835a78a1857820f17d141b6911804d273c0ef.

Breaks Topic migration tests in plone.app.contenttypes.

Files changed:
M CHANGES.rst
M plone/app/querystring/profiles.zcml
M plone/app/querystring/profiles/default/metadata.xml
M plone/app/querystring/profiles/default/registry.xml
M plone/app/querystring/upgrades.zcml
D plone/app/querystring/profiles/upgrades/to_9/registry.xml

diff --git a/CHANGES.rst b/CHANGES.rst
index 72c272b..0583b8d 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -7,9 +7,6 @@ Changelog
 - Hide upgrade-profiles when creating a new site.
   [pbauer]
 
-- Use selection.all for portal_types, review_state and Creator operations.
-  [frapell]
-
 - Actually convert the value to a datetime for the DateIndex query modifier.
   [frapell]
 
diff --git a/plone/app/querystring/profiles.zcml b/plone/app/querystring/profiles.zcml
index be2354a..23689a3 100644
--- a/plone/app/querystring/profiles.zcml
+++ b/plone/app/querystring/profiles.zcml
@@ -57,12 +57,4 @@
         provides="Products.GenericSetup.interfaces.EXTENSION"
         />
 
-    <genericsetup:registerProfile
-        name="upgrade_to_9"
-        title="Querystring Upgrade profile to v9"
-        description=""
-        directory="profiles/upgrades/to_9"
-        provides="Products.GenericSetup.interfaces.EXTENSION"
-        />
-
  </configure>
diff --git a/plone/app/querystring/profiles/default/metadata.xml b/plone/app/querystring/profiles/default/metadata.xml
index dd8af24..d3f9949 100644
--- a/plone/app/querystring/profiles/default/metadata.xml
+++ b/plone/app/querystring/profiles/default/metadata.xml
@@ -1,6 +1,6 @@
 <?xml version="1.0"?>
 <metadata>
-  <version>9</version>
+  <version>7</version>
   <dependencies>
       <dependency>profile-plone.app.registry:default</dependency>
   </dependencies>
diff --git a/plone/app/querystring/profiles/default/registry.xml b/plone/app/querystring/profiles/default/registry.xml
index 4e4f744..0aa4744 100644
--- a/plone/app/querystring/profiles/default/registry.xml
+++ b/plone/app/querystring/profiles/default/registry.xml
@@ -280,7 +280,6 @@
         <value key="sortable">True</value>
         <value key="operations">
             <element>plone.app.querystring.operation.string.is</element>
-            <element>plone.app.querystring.operation.selection.any</element>
             <element>plone.app.querystring.operation.string.currentUser</element>
         </value>
        <value key="group" i18n:translate="">Metadata</value>
@@ -444,7 +443,7 @@
         <value key="enabled">True</value>
         <value key="sortable">False</value>
         <value key="operations">
-            <element>plone.app.querystring.operation.selection.any</element>
+            <element>plone.app.querystring.operation.selection.is</element>
         </value>
         <value key="vocabulary">plone.app.vocabularies.ReallyUserFriendlyTypes</value>
        <value key="group" i18n:translate="">Metadata</value>
@@ -470,7 +469,7 @@
         <value key="enabled">True</value>
         <value key="sortable">True</value>
         <value key="operations">
-            <element>plone.app.querystring.operation.selection.any</element>
+            <element>plone.app.querystring.operation.selection.is</element>
         </value>
         <value key="vocabulary">plone.app.vocabularies.WorkflowStates</value>
        <value key="group" i18n:translate="">Metadata</value>
diff --git a/plone/app/querystring/profiles/upgrades/to_9/registry.xml b/plone/app/querystring/profiles/upgrades/to_9/registry.xml
deleted file mode 100644
index 702f5bc..0000000
--- a/plone/app/querystring/profiles/upgrades/to_9/registry.xml
+++ /dev/null
@@ -1,44 +0,0 @@
-<registry xmlns:i18n="http://xml.zope.org/namespaces/i18n"
-          i18n:domain="plone">
-
-    <records interface="plone.app.querystring.interfaces.IQueryField"
-             prefix="plone.app.querystring.field.portal_type">
-        <value key="title" i18n:translate="">Type</value>
-        <value key="description" i18n:translate="">An item's type (e.g. Event)</value>
-        <value key="enabled">True</value>
-        <value key="sortable">False</value>
-        <value key="operations">
-            <element>plone.app.querystring.operation.selection.any</element>
-        </value>
-        <value key="vocabulary">plone.app.vocabularies.ReallyUserFriendlyTypes</value>
-       <value key="group" i18n:translate="">Metadata</value>
-    </records>
-
-    <records interface="plone.app.querystring.interfaces.IQueryField"
-             prefix="plone.app.querystring.field.review_state">
-        <value key="title" i18n:translate="">Review state</value>
-        <value key="description" i18n:translate="">An item's workflow state (e.g.published)</value>
-        <value key="enabled">True</value>
-        <value key="sortable">True</value>
-        <value key="operations">
-            <element>plone.app.querystring.operation.selection.any</element>
-        </value>
-        <value key="vocabulary">plone.app.vocabularies.WorkflowStates</value>
-       <value key="group" i18n:translate="">Metadata</value>
-    </records>
-
-    <records interface="plone.app.querystring.interfaces.IQueryField"
-             prefix="plone.app.querystring.field.Creator">
-        <value key="title" i18n:translate="">Creator</value>
-        <value key="description" i18n:translate="">The person that created an item</value>
-        <value key="enabled">True</value>
-        <value key="sortable">True</value>
-        <value key="operations">
-            <element>plone.app.querystring.operation.string.is</element>
-            <element>plone.app.querystring.operation.selection.any</element>
-            <element>plone.app.querystring.operation.string.currentUser</element>
-        </value>
-       <value key="group" i18n:translate="">Metadata</value>
-    </records>
-
-</registry>
\ No newline at end of file
diff --git a/plone/app/querystring/upgrades.zcml b/plone/app/querystring/upgrades.zcml
index 68de125..a261c70 100644
--- a/plone/app/querystring/upgrades.zcml
+++ b/plone/app/querystring/upgrades.zcml
@@ -71,14 +71,4 @@
         />
   </genericsetup:upgradeSteps>
 
-  <genericsetup:upgradeSteps
-      source="8"
-      destination="9"
-      profile="plone.app.querystring:default">
-    <genericsetup:upgradeDepends
-        title="Change portal_types, review_state and Creator operations to use selection.all"
-        import_profile="plone.app.querystring:upgrade_to_9"
-        />
-  </genericsetup:upgradeSteps>
-
 </configure>


Repository: plone.app.querystring


Branch: refs/heads/master
Date: 2015-08-20T12:16:41+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.querystring/commit/91d3a7bb06c4653ed5e1bd78e8526801d1b0c35f

metadata.xml should be at version 8

Files changed:
M plone/app/querystring/profiles/default/metadata.xml

diff --git a/plone/app/querystring/profiles/default/metadata.xml b/plone/app/querystring/profiles/default/metadata.xml
index d3f9949..288415a 100644
--- a/plone/app/querystring/profiles/default/metadata.xml
+++ b/plone/app/querystring/profiles/default/metadata.xml
@@ -1,6 +1,6 @@
 <?xml version="1.0"?>
 <metadata>
-  <version>7</version>
+  <version>8</version>
   <dependencies>
       <dependency>profile-plone.app.registry:default</dependency>
   </dependencies>


