Repository: Products.CMFEditions
Branch: refs/heads/master
Date: 2015-04-24T09:24:10+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/Products.CMFEditions/commit/1e415bc4a67b1560e5426325a1a7516ce5ae1cda

Drop use of python:exists() in template

Files changed:
M CHANGES.rst
M Products/CMFEditions/browser/diff.pt

diff --git a/CHANGES.rst b/CHANGES.rst
index 552287b..a314fc8 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,6 +4,9 @@ Changelog
 2.2.13 (unreleased)
 -------------------
 
+- Drop use of python:exists() in templates.
+  [pbauer]
+
 - Replace deprecated JavaScript functions with their jQuery equivalents.
   [thet]
 
diff --git a/Products/CMFEditions/browser/diff.pt b/Products/CMFEditions/browser/diff.pt
index 7e2853b..ee2a930 100644
--- a/Products/CMFEditions/browser/diff.pt
+++ b/Products/CMFEditions/browser/diff.pt
@@ -121,15 +121,22 @@
                   This field has no inline difference view.
                 </p>
 
-                <div class="fieldDiff code-diff" style="display: none">
-                  <pre tal:condition="exists:diff/html_diff" tal:content="structure python:diff.html_diff(wrapcolumn=80)">
+                <div class="fieldDiff code-diff"
+                     style="display: none"
+                     tal:define="has_html_diff diff/html_diff | nothing;
+                                 has_ndiff diff/ndiff |Â nothing">
+                  <pre tal:condition="exists:diff/html_diff"
+                       tal:content="structure python:diff.html_diff(wrapcolumn=80)">
                     HTML formatted differences
                   </pre>
 
-                  <pre class="fieldDiff code-diff" tal:condition="python:not exists('diff/html_diff') and exists('diff/ndiff')" tal:content="diff/ndiff">
+                  <pre class="fieldDiff code-diff"
+                       tal:condition="python:not has_html_diff and has_ndiff"
+                       tal:content="diff/ndiff">
                     ndiff formatted differences
                   </pre>
-                  <p class="fieldDiff" tal:condition="python:not exists('diff/html_diff') and not exists('diff/ndiff')">
+                  <p class="fieldDiff"
+                     tal:condition="python:not has_html_diff and not has_ndiff">
                     This field has no code difference view.
                   </p>
                 </div>


