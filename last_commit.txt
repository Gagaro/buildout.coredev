Repository: plone.app.theming
Branch: refs/heads/1.1.x
Date: 2015-03-19T15:12:04+01:00
Author: Vincent Fretin (vincentfretin) <vincent.fretin@gmail.com>
Commit: https://github.com/plone/plone.app.theming/commit/2f260629ef7b5c56e7cb4d1000ca4176a08a4034

Add an error log if the subrequest failed (probably a relative xi:include) instead of silently returning None (and so having a xi:include returning nothing).

Files changed:
M docs/HISTORY.txt
M src/plone/app/theming/utils.py

diff --git a/docs/HISTORY.txt b/docs/HISTORY.txt
index 5eb93fe..f5a53ec 100644
--- a/docs/HISTORY.txt
+++ b/docs/HISTORY.txt
@@ -4,7 +4,10 @@ Changelog
 1.1.5 (unreleased)
 ------------------
 
-- Nothing changed yet.
+- Add an error log if the subrequest failed (probably a relative xi:include)
+  instead of silently returning None (and so having a xi:include returning
+  nothing).
+  [vincentfretin]
 
 
 1.1.4 (2015-02-24)
diff --git a/src/plone/app/theming/utils.py b/src/plone/app/theming/utils.py
index 1b278a3..1c28b01 100644
--- a/src/plone/app/theming/utils.py
+++ b/src/plone/app/theming/utils.py
@@ -1,3 +1,4 @@
+import logging
 import Globals
 
 import pkg_resources
@@ -46,6 +47,8 @@
 from Products.CMFCore.interfaces import ISiteRoot
 from Products.CMFPlone.utils import safe_unicode
 
+LOGGER = logging.getLogger('plone.app.theming')
+
 
 class NetworkResolver(etree.Resolver):
     """Resolver for network urls
@@ -115,6 +118,7 @@ def resolve(self, system_url, public_id, context):
 
         response = subrequest(system_url, root=root)
         if response.status != 200:
+            LOGGER.error("Couldn't resolve %s", system_url)
             return None
         result = response.getBody()
         content_type = response.headers.get('content-type')


