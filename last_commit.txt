Repository: borg.localrole
Branch: refs/heads/master
Date: 2015-05-27T15:32:05+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/borg.localrole/commit/065e42ea529399ef2255f958694a9224dac92162

Reverting commits which are breaking tests, are not pulled in via Pull Requests and also had not a valid connected plone contributor username.

Revert "Add reference to fixed issue"
This reverts commit 4d504d6e00593bb70ed3b10853e807d2bdb95e3e.

Revert "Don't use id(obj) in cache keys"
This reverts commit 342347d231f4ac34fa1a5d6910eda420711f6f65.

Files changed:
M CHANGES.txt
M borg/localrole/workspace.py

diff --git a/CHANGES.txt b/CHANGES.txt
index 401451e..039a6f1 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -4,8 +4,7 @@ Changelog
 3.1.2 (unreleased)
 ------------------
 
-- Don't use id(obj) in cache keys, fixes https://dev.plone.org/ticket/9915
-  [gaudenz]
+- Nothing changed yet.
 
 
 3.1.1 (2014-10-23)
diff --git a/borg/localrole/workspace.py b/borg/localrole/workspace.py
index 6506568..a1bea37 100644
--- a/borg/localrole/workspace.py
+++ b/borg/localrole/workspace.py
@@ -123,7 +123,7 @@ def clra_cache_key(method, self, user, obj, object_roles):
     try:
         oid = obj.getPhysicalPath()
     except AttributeError:
-        raise DontCache
+        oid = id(obj)
     return (user.getId(), oid, tuple(object_roles))
 
 


