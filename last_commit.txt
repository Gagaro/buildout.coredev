Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2015-10-13T17:57:23+03:00
Author: petschki (petschki) <pedrotschki@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/ec2c04b9d06502164523c6be1ecd7a714dfef752

compress generated css files

Files changed:
M CHANGES.rst
M Products/CMFPlone/_scripts/_generate_gruntfile.py

diff --git a/CHANGES.rst b/CHANGES.rst
index a46ceff..85f1bf0 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -8,6 +8,9 @@ Changelog
 5.0.1 (unreleased)
 ------------------
 
+- compress generated bundle css file when running plone-compile-resource
+  [petschki]
+
 - Add new commandline argument to plone-compile-resource: --compile-dir
   [petschki]
 
diff --git a/Products/CMFPlone/_scripts/_generate_gruntfile.py b/Products/CMFPlone/_scripts/_generate_gruntfile.py
index 43d2931..990de83 100644
--- a/Products/CMFPlone/_scripts/_generate_gruntfile.py
+++ b/Products/CMFPlone/_scripts/_generate_gruntfile.py
@@ -120,6 +120,7 @@
 less_config = """
             "{name}": {{
                 options: {{
+                    compress: true,
                     paths: {less_paths},
                     strictMath: false,
                     sourceMap: true,
@@ -325,8 +326,8 @@ def resource_to_dir(resource, file_type='.js'):
 
     if compile_path:
         target_name = bundle.__prefix__.split('/').pop()
-        css_target_name = target_name + 'css'
-        js_target_name = target_name + 'js'
+        css_target_name = target_name + 'min.css'
+        js_target_name = target_name + 'min.js'
         css_target_path = js_target_path = os.path.abspath(compile_path)
     else:
         if bundle.csscompilation:


Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2015-10-13T19:39:19+03:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/e12575ffdc9b224ed7631dc4d73b4b7365b9e92b

Merge pull request #1162 from plone/improve_generator_script

compress generated css files

Files changed:
M CHANGES.rst
M Products/CMFPlone/_scripts/_generate_gruntfile.py

diff --git a/CHANGES.rst b/CHANGES.rst
index a46ceff..85f1bf0 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -8,6 +8,9 @@ Changelog
 5.0.1 (unreleased)
 ------------------
 
+- compress generated bundle css file when running plone-compile-resource
+  [petschki]
+
 - Add new commandline argument to plone-compile-resource: --compile-dir
   [petschki]
 
diff --git a/Products/CMFPlone/_scripts/_generate_gruntfile.py b/Products/CMFPlone/_scripts/_generate_gruntfile.py
index 43d2931..990de83 100644
--- a/Products/CMFPlone/_scripts/_generate_gruntfile.py
+++ b/Products/CMFPlone/_scripts/_generate_gruntfile.py
@@ -120,6 +120,7 @@
 less_config = """
             "{name}": {{
                 options: {{
+                    compress: true,
                     paths: {less_paths},
                     strictMath: false,
                     sourceMap: true,
@@ -325,8 +326,8 @@ def resource_to_dir(resource, file_type='.js'):
 
     if compile_path:
         target_name = bundle.__prefix__.split('/').pop()
-        css_target_name = target_name + 'css'
-        js_target_name = target_name + 'js'
+        css_target_name = target_name + 'min.css'
+        js_target_name = target_name + 'min.js'
         css_target_path = js_target_path = os.path.abspath(compile_path)
     else:
         if bundle.csscompilation:


