Repository: mockup
Branch: refs/heads/master
Date: 2015-03-19T15:44:25-05:00
Author: vangheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/mockup/commit/4546f95a797afb0c97e8e47d5d08e7bc7f14d053

bring package.json and bower.json to root so we can install this with bower again

Files changed:
A .bowerrc
A Makefile
A bower.json
A mockup/node_modules
A package.json
M .travis.yml
M CHANGES.rst
M mockup/Gruntfile.js
M mockup/index.html
D mockup/Makefile
D mockup/bower.json
D mockup/package.json

diff --git a/.bowerrc b/.bowerrc
new file mode 100644
index 0000000..efb8c79
--- /dev/null
+++ b/.bowerrc
@@ -0,0 +1,3 @@
+{
+  "directory" : "mockup/bower_components"
+}
diff --git a/.travis.yml b/.travis.yml
index f085097..31ffad1 100644
--- a/.travis.yml
+++ b/.travis.yml
@@ -17,7 +17,6 @@ env:
     - BROWSERS="SL_IPad"
     - BROWSERS="SL_Android"
 install:
-  - cd mockup
   - travis_retry make bootstrap
   - echo "Host github.com" >> ~/.ssh/config
   - echo "   StrictHostKeyChecking no" >> ~/.ssh/config
diff --git a/CHANGES.rst b/CHANGES.rst
index 3c2f390..442dc38 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,6 +4,9 @@ Changelog
 2.0.0 (unreleased)
 ------------------
 
+- make sure mockup can be installable with bower again
+  [vangheem]
+
 - Bring back TinyMCE ``sed`` and ``copy`` from ``mockup`` into ``mockup-core``.
   If we create bundles from an external package based on patterns from mockup,
   we don't want to care about the sed and copy tasks too. Instead, those should
diff --git a/Makefile b/Makefile
new file mode 100644
index 0000000..09e4556
--- /dev/null
+++ b/Makefile
@@ -0,0 +1,119 @@
+GIT = git
+NPM = npm
+NODE_VERSION = $(shell node -v)
+NODE_VERSION_MAJ = $(shell echo $(NODE_VERSION) | cut -f1 -d. | cut -f2 -dv )
+NODE_VERSION_MIN = $(shell echo $(NODE_VERSION) | cut -f2 -d.)
+NODE_VERSION_LT_011 = $(shell [ $(NODE_VERSION_MAJ) -eq 0 -a $(NODE_VERSION_MIN) -lt 11 ] && echo true)
+
+GRUNT = ./node_modules/grunt-cli/bin/grunt
+BOWER = ./node_modules/bower/bin/bower
+NODE_PATH = ./node_modules
+
+DEBUG =
+ifeq ($(debug), true)
+	DEBUG = --debug
+endif
+VERBOSE =
+ifeq ($(verbose), true)
+	VERBOSE = --verbose
+endif
+
+
+all: test-once bundles docs
+
+stamp-npm: package.json
+	npm install
+	touch stamp-npm
+
+stamp-bower: stamp-npm bower.json
+	$(BOWER) install
+	touch stamp-bower
+
+bundles: stamp-bower bundle-widgets bundle-structure bundle-plone
+	# ----------------------------------------------------------------------- #
+	# cp build/widgets* path/to/plone.app.widgets/plone/app/widgets/static
+	# cp build/structure* path/to/wildcard.foldercontents/wildcard/foldercontents/static
+	# cp build/plone* path/to/Products.CMFPlone/Products/CMFPlone/static
+	# ----------------------------------------------------------------------- #
+
+bundle-widgets:
+	mkdir -p build
+	NODE_PATH=$(NODE_PATH) $(GRUNT) bundle-widgets $(DEBUG) $(VERBOSE) --gruntfile=mockup/Gruntfile.js
+
+bundle-structure:
+	NODE_PATH=$(NODE_PATH) $(GRUNT) bundle-structure $(DEBUG) $(VERBOSE) --gruntfile=mockup/Gruntfile.js
+
+bundle-plone:
+	mkdir -p build
+	NODE_PATH=$(NODE_PATH) $(GRUNT) bundle-plone $(DEBUG) $(VERBOSE) --gruntfile=mockup/Gruntfile.js
+
+bundle-filemanager:
+	NODE_PATH=$(NODE_PATH) $(GRUNT) bundle-filemanager $(DEBUG) $(VERBOSE) --gruntfile=mockup/Gruntfile.js
+
+bundle-resourceregistry:
+	NODE_PATH=$(NODE_PATH) $(GRUNT) bundle-resourceregistry $(DEBUG) $(VERBOSE) --gruntfile=mockup/Gruntfile.js
+
+docs:
+	if test ! -d docs; then $(GIT) clone git://github.com/plone/mockup.git -b gh-pages docs; fi
+	rm -rf docs/dev
+	NODE_PATH=$(NODE_PATH) $(GRUNT) bundle-docs $(DEBUG) $(VERBOSE) --gruntfile=mockup/Gruntfile.js
+
+bootstrap-common:
+	mkdir -p build
+
+bootstrap: bootstrap-common
+	@echo node version: $(NODE_VERSION)
+ifeq ($(NODE_VERSION_LT_011),true)
+	# for node < v0.11.x
+	$(NPM) link --prefix=.
+	# remove lib/node_modules, which contains a symlink to the project root.
+	# This leads to infinite recursion at the grunt copy task on make docs.
+	rm -rf lib/node_modules
+else
+	$(NPM) link
+endif
+	NODE_PATH=$(NODE_PATH) $(BOWER) install --config.interactive=0
+	NODE_PATH=$(NODE_PATH) $(GRUNT) sed:bootstrap $(DEBUG) $(VERBOSE) --gruntfile=mockup/Gruntfile.js
+
+bootstrap-nix: clean bootstrap-common
+	nix-build default.nix -A build -o nixenv
+	ln -s nixenv/lib/node_modules/mockup/node_modules
+	ln -s nixenv/bower_components
+
+jshint:
+	NODE_PATH=$(NODE_PATH) $(GRUNT) jshint jscs $(DEBUG) $(VERBOSE) --gruntfile=mockup/Gruntfile.js
+
+watch:
+	NODE_PATH=$(NODE_PATH) $(GRUNT) watch $(DEBUG) $(VERBOSE) --gruntfile=mockup/Gruntfile.js
+
+test:
+	NODE_PATH=$(NODE_PATH) $(GRUNT) test $(DEBUG) $(VERBOSE) --gruntfile=mockup/Gruntfile.js --pattern=$(pattern)
+
+test-once: stamp-bower
+	NODE_PATH=$(NODE_PATH) $(GRUNT) test_once $(DEBUG) $(VERBOSE) --gruntfile=mockup/Gruntfile.js --pattern=$(pattern)
+
+test-dev:
+	NODE_PATH=$(NODE_PATH) $(GRUNT) test_dev $(DEBUG) $(VERBOSE) --gruntfile=mockup/Gruntfile.js --pattern=$(pattern)
+
+test-serve:
+	NODE_PATH=$(NODE_PATH) $(GRUNT) test_serve $(DEBUG) $(VERBOSE) --gruntfile=mockup/Gruntfile.js --pattern=$(pattern)
+
+test-ci:
+	NODE_PATH=$(NODE_PATH) $(GRUNT) test_ci $(DEBUG) $(VERBOSE) --gruntfile=mockup/Gruntfile.js
+
+clean:
+	mkdir -p build
+	rm -rf build
+	rm -rf node_modules
+	rm -rf mockup/bower_components
+	rm -f stamp-npm stamp-bower
+	rm -rf node_modules src/bower_components
+
+clean-deep: clean
+	if test -f $(BOWER); then $(BOWER) cache clean; fi
+	if test -f $(NPM); then $(NPM) cache clean; fi
+
+publish-docs:
+	echo -e "Publishing 'docs' bundle!\n"; cd docs; git add -fA .; git commit -m "Travis build $(TRAVIS_BUILD_NUMBER) pushed to 'docs'."; git push -fq https://$(GH_TOKEN)@github.com/plone/mockup.git gh-pages > /dev/null; cd ..;
+
+.PHONY: bundle bundle-widgets bundle-structure bundle-plone docs bootstrap bootstrap-nix jshint test test-once test-dev test-ci publish-docs clean clean-deep
diff --git a/bower.json b/bower.json
new file mode 100644
index 0000000..0f21da1
--- /dev/null
+++ b/bower.json
@@ -0,0 +1,36 @@
+{
+  "name": "mockup",
+  "description": "A collection of client side patterns for faster and easier web development",
+  "dependencies": {
+    "ace-builds": "1.1.7",
+    "backbone": "1.1.2",
+    "backbone.paginator": "0.8.1",
+    "bootstrap": "3.2.0",
+    "console-polyfill": "0.1.2",
+    "dropzone": "3.10.2",
+    "es5-shim": "4.0.3",
+    "jqtree": "0.22.0",
+    "jquery": "1.11.1",
+    "jquery-form": "3.46.0",
+    "jquery.cookie": "1.4.1",
+    "lodash": "2.4.1",
+    "logging": "",
+    "mockup-core": "2.1.5",
+    "moment": "2.8.3",
+    "pickadate": "3.4.0",
+    "requirejs-text": "2.0.12",
+    "select2": "3.5.1",
+    "tinymce-builded": "4.1.6",
+    "patternslib": "2.0.8",
+    "jquery.recurrenceinput.js": "v1.3"
+  },
+  "devDependencies": {
+    "expect": "0.3.1",
+    "sinonjs": "1.10.2"
+  },
+  "resolutions": {
+    "jquery": "1.11.1",
+    "select2": "3.5.1",
+    "patternslib": "2.0.8"
+  }
+}
diff --git a/mockup/Gruntfile.js b/mockup/Gruntfile.js
index 46e88cd..222f27b 100644
--- a/mockup/Gruntfile.js
+++ b/mockup/Gruntfile.js
@@ -30,12 +30,12 @@ module.exports = function(grunt) {
       docs: {
         files: [
           { expand: true, src: 'index.html', dest: 'docs/dev/' },
-          { expand: true, src: '*.md', dest: 'docs/dev/' },
+          { expand: true, src: '../*.md', dest: 'docs/dev/' },
           { expand: true, src: 'js/**', dest: 'docs/dev/' },
           { expand: true, src: 'tests/**', dest: 'docs/dev/' },
           { expand: true, src: 'lib/**', dest: 'docs/dev/' },
           { expand: true, src: 'bower_components/**', dest: 'docs/dev/' },
-          { expand: true, src: 'node_modules/requirejs/require.js', dest: 'docs/dev/' },
+          { expand: true, src: '../node_modules/requirejs/require.js', dest: 'docs/dev/' },
           { expand: true, src: 'build/**', dest: 'docs/dev/' },
           { expand: true, src: 'less/**', dest: 'docs/dev/' }
         ]
@@ -73,7 +73,7 @@ module.exports = function(grunt) {
   mockup.initGrunt(grunt, {
     sed: {
       bootstrap: {
-        path: 'node_modules/lcov-result-merger/index.js',
+        path: '../node_modules/lcov-result-merger/index.js',
         pattern: 'throw new Error\\(\'Unknown Prefix ',
         replacement: '//throw// new Error(\'Unknown Prefix '
       }
diff --git a/mockup/Makefile b/mockup/Makefile
deleted file mode 100644
index cfd344a..0000000
--- a/mockup/Makefile
+++ /dev/null
@@ -1,119 +0,0 @@
-GIT = git
-NPM = npm
-NODE_VERSION = $(shell node -v)
-NODE_VERSION_MAJ = $(shell echo $(NODE_VERSION) | cut -f1 -d. | cut -f2 -dv )
-NODE_VERSION_MIN = $(shell echo $(NODE_VERSION) | cut -f2 -d.)
-NODE_VERSION_LT_011 = $(shell [ $(NODE_VERSION_MAJ) -eq 0 -a $(NODE_VERSION_MIN) -lt 11 ] && echo true)
-
-GRUNT = ./node_modules/grunt-cli/bin/grunt
-BOWER = ./node_modules/bower/bin/bower
-NODE_PATH = ./node_modules
-
-DEBUG =
-ifeq ($(debug), true)
-	DEBUG = --debug
-endif
-VERBOSE =
-ifeq ($(verbose), true)
-	VERBOSE = --verbose
-endif
-
-
-all: test-once bundles docs
-
-stamp-npm: package.json
-	npm install
-	touch stamp-npm
-
-stamp-bower: stamp-npm bower.json
-	$(BOWER) install
-	touch stamp-bower
-
-bundles: stamp-bower bundle-widgets bundle-structure bundle-plone
-	# ----------------------------------------------------------------------- #
-	# cp build/widgets* path/to/plone.app.widgets/plone/app/widgets/static
-	# cp build/structure* path/to/wildcard.foldercontents/wildcard/foldercontents/static
-	# cp build/plone* path/to/Products.CMFPlone/Products/CMFPlone/static
-	# ----------------------------------------------------------------------- #
-
-bundle-widgets:
-	mkdir -p build
-	NODE_PATH=$(NODE_PATH) $(GRUNT) bundle-widgets $(DEBUG) $(VERBOSE)
-
-bundle-structure:
-	NODE_PATH=$(NODE_PATH) $(GRUNT) bundle-structure $(DEBUG) $(VERBOSE)
-
-bundle-plone:
-	mkdir -p build
-	NODE_PATH=$(NODE_PATH) $(GRUNT) bundle-plone $(DEBUG) $(VERBOSE)
-
-bundle-filemanager:
-	NODE_PATH=$(NODE_PATH) $(GRUNT) bundle-filemanager $(DEBUG) $(VERBOSE)
-
-bundle-resourceregistry:
-	NODE_PATH=$(NODE_PATH) $(GRUNT) bundle-resourceregistry $(DEBUG) $(VERBOSE)
-
-docs:
-	if test ! -d docs; then $(GIT) clone git://github.com/plone/mockup.git -b gh-pages docs; fi
-	rm -rf docs/dev
-	NODE_PATH=$(NODE_PATH) $(GRUNT) bundle-docs $(DEBUG) $(VERBOSE)
-
-bootstrap-common:
-	mkdir -p build
-
-bootstrap: clean bootstrap-common
-	@echo node version: $(NODE_VERSION)
-ifeq ($(NODE_VERSION_LT_011),true)
-	# for node < v0.11.x
-	$(NPM) link --prefix=.
-	# remove lib/node_modules, which contains a symlink to the project root.
-	# This leads to infinite recursion at the grunt copy task on make docs.
-	rm -rf lib/node_modules
-else
-	$(NPM) link
-endif
-	NODE_PATH=$(NODE_PATH) $(BOWER) install --config.interactive=0
-	NODE_PATH=$(NODE_PATH) $(GRUNT) sed:bootstrap $(DEBUG) $(VERBOSE)
-
-bootstrap-nix: clean bootstrap-common
-	nix-build default.nix -A build -o nixenv
-	ln -s nixenv/lib/node_modules/mockup/node_modules
-	ln -s nixenv/bower_components
-
-jshint:
-	NODE_PATH=$(NODE_PATH) $(GRUNT) jshint jscs $(DEBUG) $(VERBOSE)
-
-watch:
-	NODE_PATH=$(NODE_PATH) $(GRUNT) watch $(DEBUG) $(VERBOSE)
-
-test:
-	NODE_PATH=$(NODE_PATH) $(GRUNT) test $(DEBUG) $(VERBOSE) --pattern=$(pattern)
-
-test-once: stamp-bower
-	NODE_PATH=$(NODE_PATH) $(GRUNT) test_once $(DEBUG) $(VERBOSE) --pattern=$(pattern)
-
-test-dev:
-	NODE_PATH=$(NODE_PATH) $(GRUNT) test_dev $(DEBUG) $(VERBOSE) --pattern=$(pattern)
-
-test-serve:
-	NODE_PATH=$(NODE_PATH) $(GRUNT) test_serve $(DEBUG) $(VERBOSE) --pattern=$(pattern)
-
-test-ci:
-	NODE_PATH=$(NODE_PATH) $(GRUNT) test_ci $(DEBUG) $(VERBOSE)
-
-clean:
-	mkdir -p build
-	rm -rf build
-	rm -rf node_modules
-	rm -rf bower_components
-	rm -f stamp-npm stamp-bower
-	rm -rf node_modules src/bower_components
-
-clean-deep: clean
-	if test -f $(BOWER); then $(BOWER) cache clean; fi
-	if test -f $(NPM); then $(NPM) cache clean; fi
-
-publish-docs:
-	echo -e "Publishing 'docs' bundle!\n"; cd docs; git add -fA .; git commit -m "Travis build $(TRAVIS_BUILD_NUMBER) pushed to 'docs'."; git push -fq https://$(GH_TOKEN)@github.com/plone/mockup.git gh-pages > /dev/null; cd ..;
-
-.PHONY: bundle bundle-widgets bundle-structure bundle-plone docs bootstrap bootstrap-nix jshint test test-once test-dev test-ci publish-docs clean clean-deep
diff --git a/mockup/bower.json b/mockup/bower.json
deleted file mode 100644
index 0f21da1..0000000
--- a/mockup/bower.json
+++ /dev/null
@@ -1,36 +0,0 @@
-{
-  "name": "mockup",
-  "description": "A collection of client side patterns for faster and easier web development",
-  "dependencies": {
-    "ace-builds": "1.1.7",
-    "backbone": "1.1.2",
-    "backbone.paginator": "0.8.1",
-    "bootstrap": "3.2.0",
-    "console-polyfill": "0.1.2",
-    "dropzone": "3.10.2",
-    "es5-shim": "4.0.3",
-    "jqtree": "0.22.0",
-    "jquery": "1.11.1",
-    "jquery-form": "3.46.0",
-    "jquery.cookie": "1.4.1",
-    "lodash": "2.4.1",
-    "logging": "",
-    "mockup-core": "2.1.5",
-    "moment": "2.8.3",
-    "pickadate": "3.4.0",
-    "requirejs-text": "2.0.12",
-    "select2": "3.5.1",
-    "tinymce-builded": "4.1.6",
-    "patternslib": "2.0.8",
-    "jquery.recurrenceinput.js": "v1.3"
-  },
-  "devDependencies": {
-    "expect": "0.3.1",
-    "sinonjs": "1.10.2"
-  },
-  "resolutions": {
-    "jquery": "1.11.1",
-    "select2": "3.5.1",
-    "patternslib": "2.0.8"
-  }
-}
diff --git a/mockup/index.html b/mockup/index.html
index ff52446..76d2d39 100644
--- a/mockup/index.html
+++ b/mockup/index.html
@@ -20,14 +20,14 @@
   <![endif]-->
 
   <script src="node_modules/requirejs/require.js"></script>
-  <script src="js/config.js"></script>
+  <script src="mockup/js/config.js"></script>
   <script>
     window.DEBUG = true;
     require(['mockup-bundles-docs']);
   </script>
 </head>
 
-<body data-i18ncatalogurl="/tests/json/i18n.json">
+<body data-i18ncatalogurl="/mockup/tests/json/i18n.json">
 </body>
 
 </html>
diff --git a/mockup/node_modules b/mockup/node_modules
new file mode 120000
index 0000000..68a084a
--- /dev/null
+++ b/mockup/node_modules
@@ -0,0 +1 @@
+../node_modules
\ No newline at end of file
diff --git a/mockup/package.json b/mockup/package.json
deleted file mode 100644
index 7c2c5f7..0000000
--- a/mockup/package.json
+++ /dev/null
@@ -1,60 +0,0 @@
-{
-  "name": "mockup",
-  "version": "2.0.0",
-  "description": "A collection of client side patterns for faster and easier web development",
-  "homepage": "http://plone.github.io/mockup",
-  "devDependencies": {
-    "bower": "~1.3.2",
-    "chai": "^1.10.0",
-    "coveralls": "~2.10.0",
-    "extend": "~1.2.1",
-    "grunt": "~0.4.4",
-    "grunt-cli": "~0.1.13",
-    "grunt-contrib-copy": "~0.5.0",
-    "grunt-contrib-jshint": "~0.10.0",
-    "grunt-contrib-less": "~0.11.0",
-    "grunt-contrib-requirejs": "~0.4.3",
-    "grunt-contrib-uglify": "~0.4.0",
-    "grunt-contrib-watch": "~0.6.1",
-    "grunt-karma": "~0.8.2",
-    "grunt-sed": "~0.1.1",
-    "karma": "~0.12.9",
-    "karma-chai": "^0.1.0",
-    "karma-chrome-launcher": "~0.1.3",
-    "karma-coverage": "~0.2.1",
-    "karma-firefox-launcher": "~0.1.4",
-    "karma-junit-reporter": "~0.2.2",
-    "karma-mocha": "~0.1.3",
-    "karma-phantomjs-launcher": "~0.1.4",
-    "karma-requirejs": "~0.2.1",
-    "karma-sauce-launcher": "~0.2.10",
-    "karma-script-launcher": "~0.1.0",
-    "karma-spec-reporter": "0.0.16",
-    "lcov-result-merger": "~0.0.2",
-    "less": "~1.7.0",
-    "mocha": "~1.18.2",
-    "phantomjs": "^1.9.13",
-    "requirejs": "~2.1.11"
-  },
-  "maintainers": [
-    {
-      "name": "Plone Foundation",
-      "email": "plone-developers@lists.sourceforge.net",
-      "url": "http://plone.org"
-    }
-  ],
-  "repository": {
-    "type": "git",
-    "url": "https://github.com/plone/mockup.git"
-  },
-  "bugs": {
-    "url": "https://github.com/plone/mockup/issues",
-    "email": "plone-developers@lists.sourceforge.net"
-  },
-  "licenses": [
-    {
-      "type": "BSD",
-      "url": "http://opensource.org/licenses/BSD-3-Clause"
-    }
-  ]
-}
diff --git a/package.json b/package.json
new file mode 100644
index 0000000..7c2c5f7
--- /dev/null
+++ b/package.json
@@ -0,0 +1,60 @@
+{
+  "name": "mockup",
+  "version": "2.0.0",
+  "description": "A collection of client side patterns for faster and easier web development",
+  "homepage": "http://plone.github.io/mockup",
+  "devDependencies": {
+    "bower": "~1.3.2",
+    "chai": "^1.10.0",
+    "coveralls": "~2.10.0",
+    "extend": "~1.2.1",
+    "grunt": "~0.4.4",
+    "grunt-cli": "~0.1.13",
+    "grunt-contrib-copy": "~0.5.0",
+    "grunt-contrib-jshint": "~0.10.0",
+    "grunt-contrib-less": "~0.11.0",
+    "grunt-contrib-requirejs": "~0.4.3",
+    "grunt-contrib-uglify": "~0.4.0",
+    "grunt-contrib-watch": "~0.6.1",
+    "grunt-karma": "~0.8.2",
+    "grunt-sed": "~0.1.1",
+    "karma": "~0.12.9",
+    "karma-chai": "^0.1.0",
+    "karma-chrome-launcher": "~0.1.3",
+    "karma-coverage": "~0.2.1",
+    "karma-firefox-launcher": "~0.1.4",
+    "karma-junit-reporter": "~0.2.2",
+    "karma-mocha": "~0.1.3",
+    "karma-phantomjs-launcher": "~0.1.4",
+    "karma-requirejs": "~0.2.1",
+    "karma-sauce-launcher": "~0.2.10",
+    "karma-script-launcher": "~0.1.0",
+    "karma-spec-reporter": "0.0.16",
+    "lcov-result-merger": "~0.0.2",
+    "less": "~1.7.0",
+    "mocha": "~1.18.2",
+    "phantomjs": "^1.9.13",
+    "requirejs": "~2.1.11"
+  },
+  "maintainers": [
+    {
+      "name": "Plone Foundation",
+      "email": "plone-developers@lists.sourceforge.net",
+      "url": "http://plone.org"
+    }
+  ],
+  "repository": {
+    "type": "git",
+    "url": "https://github.com/plone/mockup.git"
+  },
+  "bugs": {
+    "url": "https://github.com/plone/mockup/issues",
+    "email": "plone-developers@lists.sourceforge.net"
+  },
+  "licenses": [
+    {
+      "type": "BSD",
+      "url": "http://opensource.org/licenses/BSD-3-Clause"
+    }
+  ]
+}


