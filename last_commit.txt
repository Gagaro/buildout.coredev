Repository: plone.app.discussion


Branch: refs/heads/master
Date: 2015-09-19T14:58:53+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.discussion/commit/e2bd22e74b39a85e1c1dd924c7e560c71189d7de

fix comment-moderation

Files changed:
M plone/app/discussion/browser/javascripts/moderation.js

diff --git a/plone/app/discussion/browser/javascripts/moderation.js b/plone/app/discussion/browser/javascripts/moderation.js
index 98b1341..d2a2b9d 100644
--- a/plone/app/discussion/browser/javascripts/moderation.js
+++ b/plone/app/discussion/browser/javascripts/moderation.js
@@ -36,7 +36,8 @@ require([  // jshint ignore:line
             e.preventDefault();
             var row = $(this).parent().parent();
             var path = $(row).find("[name='selected_obj_paths:list']").attr("value");
-            var target = path + "/@@moderate-delete-comment";
+            var auth_key = $('input[name="_authenticator"]').val();
+            var target = path + "/@@moderate-delete-comment?_authenticator=" + auth_key;
             $.ajax({
                 type: "GET",
                 url: target,
@@ -65,7 +66,8 @@ require([  // jshint ignore:line
             e.preventDefault();
             var row = $(this).parent().parent();
             var path = $(row).find("[name='selected_obj_paths:list']").attr("value");
-            var target = path + "/@@moderate-publish-comment";
+            var auth_key = $('input[name="_authenticator"]').val();
+            var target = path + "/@@moderate-publish-comment?_authenticator=" + auth_key;
             $.ajax({
                 type: "GET",
                 url: target,


