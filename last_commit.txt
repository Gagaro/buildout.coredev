Repository: plone.app.discussion


Branch: refs/heads/master
Date: 2015-11-05T00:30:42+01:00
Author: Gil Forcada (gforcada) <gforcada@gnome.org>
Commit: https://github.com/plone/plone.app.discussion/commit/0713bcd8bc14a9f8d7fd5bb7f80083871d465435

Use plone i18n domain

plone.app.discussion is an official Plone core package,
thus their translations belong to plone.app.locales.

This commit removes the plone.app.discussion domain and changes it for
plone.

This fixes:
https://github.com/plone/plone.app.discussion/issues/66

Files changed:
M docs/source/howtos/howto_extend_the_comment_form.txt
M plone/app/discussion/__init__.py
M plone/app/discussion/browser/captcha.zcml
M plone/app/discussion/browser/comment.py
M plone/app/discussion/browser/comments.pt
M plone/app/discussion/browser/comments.py
M plone/app/discussion/browser/configure.zcml
M plone/app/discussion/browser/moderation.pt
M plone/app/discussion/comment.py
M plone/app/discussion/configure.zcml
M plone/app/discussion/contentrules.py
M plone/app/discussion/interfaces.py
M plone/app/discussion/notifications.zcml
M plone/app/discussion/permissions.zcml
M plone/app/discussion/subscribers.zcml
D plone/app/discussion/locales/update.sh

diff --git a/docs/source/howtos/howto_extend_the_comment_form.txt b/docs/source/howtos/howto_extend_the_comment_form.txt
index 8be7674..6f3b604 100644
--- a/docs/source/howtos/howto_extend_the_comment_form.txt
+++ b/docs/source/howtos/howto_extend_the_comment_form.txt
@@ -143,7 +143,7 @@ plone.app.discussion.browser.comments.pt.
 
 You can now add code to show the website attribute to the documentByLine::
 
-    <div class="documentByLine" i18n:domain="plone.app.discussion">
+    <div class="documentByLine" i18n:domain="plone">
         ...
         <div class="commentWebsite"
              tal:condition="reply/website|nothing">
diff --git a/plone/app/discussion/__init__.py b/plone/app/discussion/__init__.py
index 182a1d5..1936adc 100644
--- a/plone/app/discussion/__init__.py
+++ b/plone/app/discussion/__init__.py
@@ -2,4 +2,4 @@
 from zope.i18nmessageid import MessageFactory
 
 
-PloneAppDiscussionMessageFactory = MessageFactory('plone.app.discussion')
+_ = MessageFactory('plone')
diff --git a/plone/app/discussion/browser/captcha.zcml b/plone/app/discussion/browser/captcha.zcml
index 9acfddf..2395163 100644
--- a/plone/app/discussion/browser/captcha.zcml
+++ b/plone/app/discussion/browser/captcha.zcml
@@ -2,7 +2,7 @@
     xmlns="http://namespaces.zope.org/zope"
     xmlns:meta="http://namespaces.zope.org/meta"
     xmlns:zcml="http://namespaces.zope.org/zcml"
-    i18n_domain="plone.app.discussion">
+    i18n_domain="plone">
 
     <!-- Captcha comment form extender -->
     <configure zcml:condition="have plone.app.discussion-captcha">
diff --git a/plone/app/discussion/browser/comment.py b/plone/app/discussion/browser/comment.py
index 837ca4e..d5574e7 100644
--- a/plone/app/discussion/browser/comment.py
+++ b/plone/app/discussion/browser/comment.py
@@ -6,7 +6,7 @@
 from Products.Five.browser import BrowserView
 from Products.statusmessages.interfaces import IStatusMessage
 from comments import CommentForm
-from plone.app.discussion import PloneAppDiscussionMessageFactory as _
+from plone.app.discussion import _
 from plone.registry.interfaces import IRegistry
 from plone.z3cform.layout import wrap_form
 from z3c.form import button
diff --git a/plone/app/discussion/browser/comments.pt b/plone/app/discussion/browser/comments.pt
index 0bceda9..e026469 100644
--- a/plone/app/discussion/browser/comments.pt
+++ b/plone/app/discussion/browser/comments.pt
@@ -63,7 +63,7 @@
                                          alt reply/author_name" />
                 </div>
 
-                <div class="documentByLine" i18n:domain="plone.app.discussion">
+                <div class="documentByLine">
                     <tal:name>
                         <a href=""
                            tal:condition="has_author_link"
@@ -170,7 +170,6 @@
 
         <div tal:condition="python: has_replies and not isDiscussionAllowed"
              class="discreet"
-             i18n:domain="plone.app.discussion"
              i18n:translate="label_commenting_disabled">
             Commenting has been disabled.
         </div>
diff --git a/plone/app/discussion/browser/comments.py b/plone/app/discussion/browser/comments.py
index 1667184..77214d1 100644
--- a/plone/app/discussion/browser/comments.py
+++ b/plone/app/discussion/browser/comments.py
@@ -7,7 +7,7 @@
 from Products.Five.browser.pagetemplatefile import ViewPageTemplateFile
 from Products.statusmessages.interfaces import IStatusMessage
 from datetime import datetime
-from plone.app.discussion import PloneAppDiscussionMessageFactory as _
+from plone.app.discussion import _
 from plone.app.discussion.browser.validator import CaptchaValidator
 from plone.app.discussion.interfaces import ICaptcha
 from plone.app.discussion.interfaces import IComment
diff --git a/plone/app/discussion/browser/configure.zcml b/plone/app/discussion/browser/configure.zcml
index acb6839..54067cf 100644
--- a/plone/app/discussion/browser/configure.zcml
+++ b/plone/app/discussion/browser/configure.zcml
@@ -2,7 +2,7 @@
     xmlns="http://namespaces.zope.org/zope"
     xmlns:browser="http://namespaces.zope.org/browser"
     xmlns:zcml="http://namespaces.zope.org/zcml"
-    i18n_domain="plone.app.discussion">
+    i18n_domain="plone">
 
     <include package="plone.app.registry" />
 
diff --git a/plone/app/discussion/browser/moderation.pt b/plone/app/discussion/browser/moderation.pt
index 81a1fca..39ae1f0 100644
--- a/plone/app/discussion/browser/moderation.pt
+++ b/plone/app/discussion/browser/moderation.pt
@@ -4,7 +4,7 @@
       xmlns:i18n="http://xml.zope.org/namespaces/i18n"
       lang="en"
       metal:use-macro="context/main_template/macros/master"
-      i18n:domain="plone.app.discussion">
+      i18n:domain="plone">
 <body>
 
 <metal:main fill-slot="main">
@@ -27,7 +27,7 @@
 
         <div class="portalMessage warning"
             tal:condition="not: view/moderation_enabled">
-            <strong i18n:domain="plone" i18n:translate="">Warning</strong>
+            <strong i18n:translate="">Warning</strong>
             <span tal:omit-tag="" i18n:translate="message_moderation_disabled">
                 Moderation workflow is disabled. You have to
                 <a i18n:name="enable_comment_workflow"
diff --git a/plone/app/discussion/comment.py b/plone/app/discussion/comment.py
index 917646c..2bc8354 100644
--- a/plone/app/discussion/comment.py
+++ b/plone/app/discussion/comment.py
@@ -18,7 +18,7 @@
 from OFS.role import RoleManager
 from OFS.Traversable import Traversable
 from persistent import Persistent
-from plone.app.discussion import PloneAppDiscussionMessageFactory as _
+from plone.app.discussion import _
 from plone.app.discussion.events import CommentAddedEvent
 from plone.app.discussion.events import CommentRemovedEvent
 from plone.app.discussion.events import ReplyAddedEvent
diff --git a/plone/app/discussion/configure.zcml b/plone/app/discussion/configure.zcml
index 8ead976..9dae000 100644
--- a/plone/app/discussion/configure.zcml
+++ b/plone/app/discussion/configure.zcml
@@ -5,7 +5,7 @@
     xmlns:monkey="http://namespaces.plone.org/monkey"
     xmlns:zcml="http://namespaces.zope.org/zcml"
     xmlns:five="http://namespaces.zope.org/five"
-    i18n_domain="plone.app.discussion">
+    i18n_domain="plone">
 
     <five:registerPackage package="." />
 
diff --git a/plone/app/discussion/contentrules.py b/plone/app/discussion/contentrules.py
index 8dc082b..81b832b 100644
--- a/plone/app/discussion/contentrules.py
+++ b/plone/app/discussion/contentrules.py
@@ -1,6 +1,6 @@
 """ Content rules handlers
 """
-from plone.app.discussion import PloneAppDiscussionMessageFactory as _
+from plone.app.discussion import _
 
 
 try:
diff --git a/plone/app/discussion/interfaces.py b/plone/app/discussion/interfaces.py
index 13662f5..ad773a5 100644
--- a/plone/app/discussion/interfaces.py
+++ b/plone/app/discussion/interfaces.py
@@ -1,7 +1,7 @@
 # -*- coding: utf-8 -*-
 """Interfaces for plone.app.discussion
 """
-from plone.app.discussion import PloneAppDiscussionMessageFactory as _
+from plone.app.discussion import _
 from zope import schema
 from zope.component.interfaces import IObjectEvent
 from zope.interface import Interface
diff --git a/plone/app/discussion/locales/update.sh b/plone/app/discussion/locales/update.sh
deleted file mode 100755
index 2e0c6a0..0000000
--- a/plone/app/discussion/locales/update.sh
+++ /dev/null
@@ -1,6 +0,0 @@
-domain=plone.app.discussion
-i18ndude rebuild-pot --pot $domain.pot --create $domain --merge $domain-manual.pot ../
-i18ndude sync --pot $domain.pot */LC_MESSAGES/$domain.po
-
-i18ndude rebuild-pot --pot ../i18n/plone.pot --create plone --merge ../i18n/plone-manual.pot ../profiles
-i18ndude sync --pot ../i18n/plone.pot ../i18n/plone-*.po
diff --git a/plone/app/discussion/notifications.zcml b/plone/app/discussion/notifications.zcml
index 253cea5..2a95b7b 100644
--- a/plone/app/discussion/notifications.zcml
+++ b/plone/app/discussion/notifications.zcml
@@ -1,7 +1,7 @@
 <configure
     xmlns="http://namespaces.zope.org/zope"
     xmlns:zcml="http://namespaces.zope.org/zcml"
-    i18n_domain="plone.app.discussion">
+    i18n_domain="plone">
 
   <subscriber
       for="plone.app.discussion.interfaces.IComment
diff --git a/plone/app/discussion/permissions.zcml b/plone/app/discussion/permissions.zcml
index 66aa050..39ff305 100644
--- a/plone/app/discussion/permissions.zcml
+++ b/plone/app/discussion/permissions.zcml
@@ -1,6 +1,6 @@
 <configure
     xmlns="http://namespaces.zope.org/zope"
-    i18n_domain="plone.app.discussion">
+    i18n_domain="plone">
 
     <!-- custom permissions are defined here -->
 
diff --git a/plone/app/discussion/subscribers.zcml b/plone/app/discussion/subscribers.zcml
index 12a30a5..befc5f3 100644
--- a/plone/app/discussion/subscribers.zcml
+++ b/plone/app/discussion/subscribers.zcml
@@ -1,7 +1,7 @@
 <configure
     xmlns="http://namespaces.zope.org/zope"
     xmlns:zcml="http://namespaces.zope.org/zcml"
-    i18n_domain="plone.app.discussion">
+    i18n_domain="plone">
 
     <subscriber
         for="plone.app.discussion.interfaces.IComment


Repository: plone.app.discussion


Branch: refs/heads/master
Date: 2015-11-09T22:29:47+01:00
Author: Gil Forcada (gforcada) <gforcada@gnome.org>
Commit: https://github.com/plone/plone.app.discussion/commit/dba633e1279152d9b3e877d291cebe5ebcf950ad

Update CHANGES

Files changed:
M CHANGES.rst

diff --git a/CHANGES.rst b/CHANGES.rst
index b555e80..bc6a2a1 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,7 +10,9 @@ New:
 
 Fixes:
 
-- *add item here*
+- Move translations to plone.app.locales
+  https://github.com/plone/plone.app.discussion/issues/66
+  [gforcada]
 
 
 2.4.8 (2015-09-20)


Repository: plone.app.discussion


Branch: refs/heads/master
Date: 2015-11-09T22:32:10+01:00
Author: Gil Forcada Codinachs (gforcada) <gil.forcada@freitag.de>
Commit: https://github.com/plone/plone.app.discussion/commit/befff141a20eef9bfb45252443199a1e426ea2cf

Merge pull request #74 from plone/remove-own-i18n-domain

Use plone i18n domain

Files changed:
M CHANGES.rst
M docs/source/howtos/howto_extend_the_comment_form.txt
M plone/app/discussion/__init__.py
M plone/app/discussion/browser/captcha.zcml
M plone/app/discussion/browser/comment.py
M plone/app/discussion/browser/comments.pt
M plone/app/discussion/browser/comments.py
M plone/app/discussion/browser/configure.zcml
M plone/app/discussion/browser/moderation.pt
M plone/app/discussion/comment.py
M plone/app/discussion/configure.zcml
M plone/app/discussion/contentrules.py
M plone/app/discussion/interfaces.py
M plone/app/discussion/notifications.zcml
M plone/app/discussion/permissions.zcml
M plone/app/discussion/subscribers.zcml
D plone/app/discussion/locales/update.sh

diff --git a/CHANGES.rst b/CHANGES.rst
index b555e80..bc6a2a1 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,7 +10,9 @@ New:
 
 Fixes:
 
-- *add item here*
+- Move translations to plone.app.locales
+  https://github.com/plone/plone.app.discussion/issues/66
+  [gforcada]
 
 
 2.4.8 (2015-09-20)
diff --git a/docs/source/howtos/howto_extend_the_comment_form.txt b/docs/source/howtos/howto_extend_the_comment_form.txt
index 8be7674..6f3b604 100644
--- a/docs/source/howtos/howto_extend_the_comment_form.txt
+++ b/docs/source/howtos/howto_extend_the_comment_form.txt
@@ -143,7 +143,7 @@ plone.app.discussion.browser.comments.pt.
 
 You can now add code to show the website attribute to the documentByLine::
 
-    <div class="documentByLine" i18n:domain="plone.app.discussion">
+    <div class="documentByLine" i18n:domain="plone">
         ...
         <div class="commentWebsite"
              tal:condition="reply/website|nothing">
diff --git a/plone/app/discussion/__init__.py b/plone/app/discussion/__init__.py
index 182a1d5..1936adc 100644
--- a/plone/app/discussion/__init__.py
+++ b/plone/app/discussion/__init__.py
@@ -2,4 +2,4 @@
 from zope.i18nmessageid import MessageFactory
 
 
-PloneAppDiscussionMessageFactory = MessageFactory('plone.app.discussion')
+_ = MessageFactory('plone')
diff --git a/plone/app/discussion/browser/captcha.zcml b/plone/app/discussion/browser/captcha.zcml
index 9acfddf..2395163 100644
--- a/plone/app/discussion/browser/captcha.zcml
+++ b/plone/app/discussion/browser/captcha.zcml
@@ -2,7 +2,7 @@
     xmlns="http://namespaces.zope.org/zope"
     xmlns:meta="http://namespaces.zope.org/meta"
     xmlns:zcml="http://namespaces.zope.org/zcml"
-    i18n_domain="plone.app.discussion">
+    i18n_domain="plone">
 
     <!-- Captcha comment form extender -->
     <configure zcml:condition="have plone.app.discussion-captcha">
diff --git a/plone/app/discussion/browser/comment.py b/plone/app/discussion/browser/comment.py
index 837ca4e..d5574e7 100644
--- a/plone/app/discussion/browser/comment.py
+++ b/plone/app/discussion/browser/comment.py
@@ -6,7 +6,7 @@
 from Products.Five.browser import BrowserView
 from Products.statusmessages.interfaces import IStatusMessage
 from comments import CommentForm
-from plone.app.discussion import PloneAppDiscussionMessageFactory as _
+from plone.app.discussion import _
 from plone.registry.interfaces import IRegistry
 from plone.z3cform.layout import wrap_form
 from z3c.form import button
diff --git a/plone/app/discussion/browser/comments.pt b/plone/app/discussion/browser/comments.pt
index 0bceda9..e026469 100644
--- a/plone/app/discussion/browser/comments.pt
+++ b/plone/app/discussion/browser/comments.pt
@@ -63,7 +63,7 @@
                                          alt reply/author_name" />
                 </div>
 
-                <div class="documentByLine" i18n:domain="plone.app.discussion">
+                <div class="documentByLine">
                     <tal:name>
                         <a href=""
                            tal:condition="has_author_link"
@@ -170,7 +170,6 @@
 
         <div tal:condition="python: has_replies and not isDiscussionAllowed"
              class="discreet"
-             i18n:domain="plone.app.discussion"
              i18n:translate="label_commenting_disabled">
             Commenting has been disabled.
         </div>
diff --git a/plone/app/discussion/browser/comments.py b/plone/app/discussion/browser/comments.py
index 1667184..77214d1 100644
--- a/plone/app/discussion/browser/comments.py
+++ b/plone/app/discussion/browser/comments.py
@@ -7,7 +7,7 @@
 from Products.Five.browser.pagetemplatefile import ViewPageTemplateFile
 from Products.statusmessages.interfaces import IStatusMessage
 from datetime import datetime
-from plone.app.discussion import PloneAppDiscussionMessageFactory as _
+from plone.app.discussion import _
 from plone.app.discussion.browser.validator import CaptchaValidator
 from plone.app.discussion.interfaces import ICaptcha
 from plone.app.discussion.interfaces import IComment
diff --git a/plone/app/discussion/browser/configure.zcml b/plone/app/discussion/browser/configure.zcml
index acb6839..54067cf 100644
--- a/plone/app/discussion/browser/configure.zcml
+++ b/plone/app/discussion/browser/configure.zcml
@@ -2,7 +2,7 @@
     xmlns="http://namespaces.zope.org/zope"
     xmlns:browser="http://namespaces.zope.org/browser"
     xmlns:zcml="http://namespaces.zope.org/zcml"
-    i18n_domain="plone.app.discussion">
+    i18n_domain="plone">
 
     <include package="plone.app.registry" />
 
diff --git a/plone/app/discussion/browser/moderation.pt b/plone/app/discussion/browser/moderation.pt
index 81a1fca..39ae1f0 100644
--- a/plone/app/discussion/browser/moderation.pt
+++ b/plone/app/discussion/browser/moderation.pt
@@ -4,7 +4,7 @@
       xmlns:i18n="http://xml.zope.org/namespaces/i18n"
       lang="en"
       metal:use-macro="context/main_template/macros/master"
-      i18n:domain="plone.app.discussion">
+      i18n:domain="plone">
 <body>
 
 <metal:main fill-slot="main">
@@ -27,7 +27,7 @@
 
         <div class="portalMessage warning"
             tal:condition="not: view/moderation_enabled">
-            <strong i18n:domain="plone" i18n:translate="">Warning</strong>
+            <strong i18n:translate="">Warning</strong>
             <span tal:omit-tag="" i18n:translate="message_moderation_disabled">
                 Moderation workflow is disabled. You have to
                 <a i18n:name="enable_comment_workflow"
diff --git a/plone/app/discussion/comment.py b/plone/app/discussion/comment.py
index 917646c..2bc8354 100644
--- a/plone/app/discussion/comment.py
+++ b/plone/app/discussion/comment.py
@@ -18,7 +18,7 @@
 from OFS.role import RoleManager
 from OFS.Traversable import Traversable
 from persistent import Persistent
-from plone.app.discussion import PloneAppDiscussionMessageFactory as _
+from plone.app.discussion import _
 from plone.app.discussion.events import CommentAddedEvent
 from plone.app.discussion.events import CommentRemovedEvent
 from plone.app.discussion.events import ReplyAddedEvent
diff --git a/plone/app/discussion/configure.zcml b/plone/app/discussion/configure.zcml
index 8ead976..9dae000 100644
--- a/plone/app/discussion/configure.zcml
+++ b/plone/app/discussion/configure.zcml
@@ -5,7 +5,7 @@
     xmlns:monkey="http://namespaces.plone.org/monkey"
     xmlns:zcml="http://namespaces.zope.org/zcml"
     xmlns:five="http://namespaces.zope.org/five"
-    i18n_domain="plone.app.discussion">
+    i18n_domain="plone">
 
     <five:registerPackage package="." />
 
diff --git a/plone/app/discussion/contentrules.py b/plone/app/discussion/contentrules.py
index 8dc082b..81b832b 100644
--- a/plone/app/discussion/contentrules.py
+++ b/plone/app/discussion/contentrules.py
@@ -1,6 +1,6 @@
 """ Content rules handlers
 """
-from plone.app.discussion import PloneAppDiscussionMessageFactory as _
+from plone.app.discussion import _
 
 
 try:
diff --git a/plone/app/discussion/interfaces.py b/plone/app/discussion/interfaces.py
index 13662f5..ad773a5 100644
--- a/plone/app/discussion/interfaces.py
+++ b/plone/app/discussion/interfaces.py
@@ -1,7 +1,7 @@
 # -*- coding: utf-8 -*-
 """Interfaces for plone.app.discussion
 """
-from plone.app.discussion import PloneAppDiscussionMessageFactory as _
+from plone.app.discussion import _
 from zope import schema
 from zope.component.interfaces import IObjectEvent
 from zope.interface import Interface
diff --git a/plone/app/discussion/locales/update.sh b/plone/app/discussion/locales/update.sh
deleted file mode 100755
index 2e0c6a0..0000000
--- a/plone/app/discussion/locales/update.sh
+++ /dev/null
@@ -1,6 +0,0 @@
-domain=plone.app.discussion
-i18ndude rebuild-pot --pot $domain.pot --create $domain --merge $domain-manual.pot ../
-i18ndude sync --pot $domain.pot */LC_MESSAGES/$domain.po
-
-i18ndude rebuild-pot --pot ../i18n/plone.pot --create plone --merge ../i18n/plone-manual.pot ../profiles
-i18ndude sync --pot ../i18n/plone.pot ../i18n/plone-*.po
diff --git a/plone/app/discussion/notifications.zcml b/plone/app/discussion/notifications.zcml
index 253cea5..2a95b7b 100644
--- a/plone/app/discussion/notifications.zcml
+++ b/plone/app/discussion/notifications.zcml
@@ -1,7 +1,7 @@
 <configure
     xmlns="http://namespaces.zope.org/zope"
     xmlns:zcml="http://namespaces.zope.org/zcml"
-    i18n_domain="plone.app.discussion">
+    i18n_domain="plone">
 
   <subscriber
       for="plone.app.discussion.interfaces.IComment
diff --git a/plone/app/discussion/permissions.zcml b/plone/app/discussion/permissions.zcml
index 66aa050..39ff305 100644
--- a/plone/app/discussion/permissions.zcml
+++ b/plone/app/discussion/permissions.zcml
@@ -1,6 +1,6 @@
 <configure
     xmlns="http://namespaces.zope.org/zope"
-    i18n_domain="plone.app.discussion">
+    i18n_domain="plone">
 
     <!-- custom permissions are defined here -->
 
diff --git a/plone/app/discussion/subscribers.zcml b/plone/app/discussion/subscribers.zcml
index 12a30a5..befc5f3 100644
--- a/plone/app/discussion/subscribers.zcml
+++ b/plone/app/discussion/subscribers.zcml
@@ -1,7 +1,7 @@
 <configure
     xmlns="http://namespaces.zope.org/zope"
     xmlns:zcml="http://namespaces.zope.org/zcml"
-    i18n_domain="plone.app.discussion">
+    i18n_domain="plone">
 
     <subscriber
         for="plone.app.discussion.interfaces.IComment


