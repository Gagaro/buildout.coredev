Repository: plone.dexterity
Branch: refs/heads/master
Date: 2015-05-13T18:07:57+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.dexterity/commit/c38970f71c8e1bf9becd4a8905072fb9bc90a7dd

fixes #27 createContent ignores empty fields

Files changed:
M CHANGES.rst
M plone/dexterity/utils.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 8d265b2..8605cdf 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,7 +4,8 @@ Changelog
 2.3.1 (unreleased)
 ------------------
 
-- Nothing changed yet.
+- fix #27: createContent ignores empty fields
+  [jensens]
 
 
 2.3.0 (2015-03-13)
diff --git a/plone/dexterity/utils.py b/plone/dexterity/utils.py
index ca6a286..b493357 100644
--- a/plone/dexterity/utils.py
+++ b/plone/dexterity/utils.py
@@ -137,12 +137,12 @@ def createContent(portal_type, **kw):
         for name, value in fields.items():
             try:
                 # hasattr swallows exceptions.
-                if getattr(behavior, name):
-                    setattr(behavior, name, value)
-                    del fields[name]
+                getattr(behavior, name)
             except AttributeError:
                 # fieldname not available
-                pass
+                continue
+            setattr(behavior, name, value)
+            del fields[name]
 
     for (key, value) in fields.items():
         setattr(content, key, value)


Repository: plone.dexterity
Branch: refs/heads/master
Date: 2015-05-15T11:31:12+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.dexterity/commit/b3d554e69ff509d45ac4deb14faeb9590bd7fdaf

Merge pull request #28 from plone/fix-27-createContent_ignores_empty_fields

fixes #27 createContent ignores empty fields

Files changed:
M CHANGES.rst
M plone/dexterity/utils.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 8d265b2..8605cdf 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,7 +4,8 @@ Changelog
 2.3.1 (unreleased)
 ------------------
 
-- Nothing changed yet.
+- fix #27: createContent ignores empty fields
+  [jensens]
 
 
 2.3.0 (2015-03-13)
diff --git a/plone/dexterity/utils.py b/plone/dexterity/utils.py
index ca6a286..b493357 100644
--- a/plone/dexterity/utils.py
+++ b/plone/dexterity/utils.py
@@ -137,12 +137,12 @@ def createContent(portal_type, **kw):
         for name, value in fields.items():
             try:
                 # hasattr swallows exceptions.
-                if getattr(behavior, name):
-                    setattr(behavior, name, value)
-                    del fields[name]
+                getattr(behavior, name)
             except AttributeError:
                 # fieldname not available
-                pass
+                continue
+            setattr(behavior, name, value)
+            del fields[name]
 
     for (key, value) in fields.items():
         setattr(content, key, value)


