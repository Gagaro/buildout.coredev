Repository: plone.app.contenttypes


Branch: refs/heads/master
Date: 2015-09-24T21:40:51-05:00
Author: vangheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/plone.app.contenttypes/commit/aa71f8a3013a2160b132924e6b0ab84dde3b5205

fix full_view error when collection contains itself fixes https://github.com/plone/Products.CMFPlone/issues/1076

Files changed:
M CHANGES.rst
M plone/app/contenttypes/browser/templates/full_view.pt

diff --git a/CHANGES.rst b/CHANGES.rst
index 689f6ea..405e4d2 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,6 +4,9 @@ Changelog
 1.2.4 (unreleased)
 ------------------
 
+- fix full_view error when collection contains itself
+  [vangheem]
+
 - test_content_profile: do not appy Products.CMFPlone:plone.
   [maurits]
 
diff --git a/plone/app/contenttypes/browser/templates/full_view.pt b/plone/app/contenttypes/browser/templates/full_view.pt
index 07cf017..a1d2ec1 100644
--- a/plone/app/contenttypes/browser/templates/full_view.pt
+++ b/plone/app/contenttypes/browser/templates/full_view.pt
@@ -8,12 +8,13 @@
 <body>
 
 <metal:content-core fill-slot="content-core">
-<metal:block define-macro="content-core">
+<metal:block define-macro="content-core"
+             tal:define="uuid context/@@uuid">
   <metal:listing use-macro="context/@@listing_view/macros/content-core">
     <!-- we don't want the dl -->
     <metal:entries fill-slot="entries">
       <metal:block use-macro="context/@@listing_view/macros/entries">
-        <metal:entry fill-slot="entry">
+        <metal:entry fill-slot="entry" tal:condition="python: item.UID != uuid">
           <div tal:define="obj item/getObject;" tal:replace="structure obj/@@full_view_item | nothing" />
         </metal:entry>
       </metal:block>


Repository: plone.app.contenttypes


Branch: refs/heads/master
Date: 2015-09-24T23:02:27-05:00
Author: Nathan Van Gheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/plone.app.contenttypes/commit/b32b77c65c57f970eb2b9827bab7aa8e99080516

Merge pull request #272 from plone/fullview-collection-contains

fix full_view error when collection contains itself

Files changed:
M CHANGES.rst
M plone/app/contenttypes/browser/templates/full_view.pt

diff --git a/CHANGES.rst b/CHANGES.rst
index 689f6ea..405e4d2 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,6 +4,9 @@ Changelog
 1.2.4 (unreleased)
 ------------------
 
+- fix full_view error when collection contains itself
+  [vangheem]
+
 - test_content_profile: do not appy Products.CMFPlone:plone.
   [maurits]
 
diff --git a/plone/app/contenttypes/browser/templates/full_view.pt b/plone/app/contenttypes/browser/templates/full_view.pt
index 07cf017..a1d2ec1 100644
--- a/plone/app/contenttypes/browser/templates/full_view.pt
+++ b/plone/app/contenttypes/browser/templates/full_view.pt
@@ -8,12 +8,13 @@
 <body>
 
 <metal:content-core fill-slot="content-core">
-<metal:block define-macro="content-core">
+<metal:block define-macro="content-core"
+             tal:define="uuid context/@@uuid">
   <metal:listing use-macro="context/@@listing_view/macros/content-core">
     <!-- we don't want the dl -->
     <metal:entries fill-slot="entries">
       <metal:block use-macro="context/@@listing_view/macros/entries">
-        <metal:entry fill-slot="entry">
+        <metal:entry fill-slot="entry" tal:condition="python: item.UID != uuid">
           <div tal:define="obj item/getObject;" tal:replace="structure obj/@@full_view_item | nothing" />
         </metal:entry>
       </metal:block>


