Repository: Products.PasswordResetTool


Branch: refs/heads/master
Date: 2015-09-10T10:32:00-04:00
Author: esteele (esteele) <eric@esteele.net>
Commit: https://github.com/plone/Products.PasswordResetTool/commit/2293d8c7a08c7c1c6c4e0a4d93e6da455e766df3

Pull email_from_name from configuration registry

Files changed:
M CHANGES.txt
M Products/PasswordResetTool/skins/PasswordReset/registered_notify_template.pt

diff --git a/CHANGES.txt b/CHANGES.txt
index 1af23da..dc8cd90 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -4,7 +4,8 @@ Changelog
 2.2.1 (unreleased)
 ------------------
 
-- Nothing changed yet.
+- Pull email_from_name from configuration registry.
+  [esteele]
 
 
 2.2.0 (2015-07-18)
diff --git a/Products/PasswordResetTool/skins/PasswordReset/registered_notify_template.pt b/Products/PasswordResetTool/skins/PasswordReset/registered_notify_template.pt
index 8730d0a..091c7a7 100644
--- a/Products/PasswordResetTool/skins/PasswordReset/registered_notify_template.pt
+++ b/Products/PasswordResetTool/skins/PasswordReset/registered_notify_template.pt
@@ -2,7 +2,8 @@
                   member python:options['member'];
                   portal_properties context/@@plone_tools/properties;
                   view context/@@passwordreset_view;
-                  reset python:options.get('reset', None) or here.portal_password_reset.requestReset(member.getId())"
+                  reset python:options.get('reset', None) or here.portal_password_reset.requestReset(member.getId());
+                  email_from_name python:context.portal_registry['plone.email_from_name'];"
 >From: <span tal:replace="structure view/encoded_mail_sender" />
 To: <span tal:replace="python:member.getProperty('email')" />
 Subject: <span tal:replace="view/registered_notify_subject" />
@@ -14,10 +15,10 @@ Precedence: bulk
      tal:omit-tag=""
      tal:define="fullname python:member.getProperty('fullname')">
     Welcome <span i18n:name="fullname" tal:replace="fullname" />,
-	
+  
     Your user account has been created.
-	Your username is <span i18n:name="member" tal:replace="python:member.getUserName()" />.
-	Please activate it by visiting
+  Your username is <span i18n:name="member" tal:replace="python:member.getUserName()" />.
+  Please activate it by visiting
 
     <span i18n:name="set_password" tal:replace="python:here.pwreset_constructURL(reset['randomstring'])+'?userid='+member.getUserName()" />
 
@@ -32,5 +33,6 @@ Precedence: bulk
     With kind regards,
 </div>
 --
-<span tal:replace="python:here.email_from_name" />
+
+<span tal:replace="email_from_name" />
 </tal:root>


