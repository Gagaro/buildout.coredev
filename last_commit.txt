Repository: plone.app.contentrules


Branch: refs/heads/master
Date: 2015-09-20T17:25:08+02:00
Author: esteele (esteele) <eric@esteele.net>
Commit: https://github.com/plone/plone.app.contentrules/commit/79bbdd08380f6e9eab364e69d6140159554ef24d

Move portal_properties settings to configuration registry

commit 5d37d1b916c20440dd470469fbd448a250961e8f
Author: esteele &lt;eric@esteele.net&gt;
Date:   Sat Sep 19 15:50:44 2015 +0200

    Pull email_charset from configuration registry

Files changed:
M plone/app/contentrules/actions/mail.py

diff --git a/plone/app/contentrules/actions/mail.py b/plone/app/contentrules/actions/mail.py
index 9d88317..53a7764 100644
--- a/plone/app/contentrules/actions/mail.py
+++ b/plone/app/contentrules/actions/mail.py
@@ -92,9 +92,7 @@ def __call__(self):
         if not mailhost:
             raise ComponentLookupError("You must have a Mailhost utility to execute this action")
 
-        urltool = getToolByName(aq_inner(self.context), "portal_url")
-        portal = urltool.getPortalObject()
-        email_charset = portal.getProperty('email_charset')
+        email_charset = self.mail_settings.email_charset
 
         obj = self.event.object
 


