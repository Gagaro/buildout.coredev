Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2015-10-02T20:14:48+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.upgrade/commit/980b6e598323f57997351cc6b11600073efc260d

Fixed removal of Large Plone Folder when migrating from Plone 3.

Files changed:
M CHANGES.rst
M plone/app/upgrade/v40/betas.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 59ed323..8b7c364 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,6 +4,9 @@ Changelog
 1.3.19 (unreleased)
 -------------------
 
+- Fixed removal of Large Plone Folder when migrating from Plone 3.
+  [maurits]
+
 - Remove fake kupu tool and related settings and resources.
   [maurits]
 
diff --git a/plone/app/upgrade/v40/betas.py b/plone/app/upgrade/v40/betas.py
index aa8bbe9..353cd2e 100644
--- a/plone/app/upgrade/v40/betas.py
+++ b/plone/app/upgrade/v40/betas.py
@@ -96,14 +96,18 @@ def beta3_beta4(context):
     if site_properties.hasProperty('typesLinkToFolderContentsInFC'):
         value = site_properties.getProperty('typesLinkToFolderContentsInFC')
         if 'Large Plone Folder' in value:
+            value = list(value)
             value.remove('Large Plone Folder')
+            value = tuple(value)
             site_properties.typesLinkToFolderContentsInFC = value
 
     navtree_properties = pprop.navtree_properties
     if navtree_properties.hasProperty('parentMetaTypesNotToQuery'):
         value = navtree_properties.getProperty('parentMetaTypesNotToQuery')
         if 'Large Plone Folder' in value:
+            value = list(value)
             value.remove('Large Plone Folder')
+            value = tuple(value)
             navtree_properties.parentMetaTypesNotToQuery = value
 
 


