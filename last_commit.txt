Repository: plone.schemaeditor
Branch: refs/heads/master
Date: 2015-04-09T15:18:12-04:00
Author: Andreas Jung (zopyx) <yet@gmx.de>
Commit: https://github.com/plone/plone.schemaeditor/commit/fb89c9b4b2988ff1c9e920bc5c44627ce7d52a2c

sorted fields by localized name

Files changed:
M plone/schemaeditor/fields.py

diff --git a/plone/schemaeditor/fields.py b/plone/schemaeditor/fields.py
index 052304b..e39b71d 100644
--- a/plone/schemaeditor/fields.py
+++ b/plone/schemaeditor/fields.py
@@ -1,4 +1,5 @@
 import copy
+import operator
 from zope import interface
 from zope import component
 from zope.component import adapter
@@ -61,7 +62,7 @@ def FieldsVocabularyFactory(context):
         terms.append(SimpleVocabulary.createTerm(factory,
                                                  translate(factory.title),
                                                  factory.title))
-
+    terms = sorted(terms, key=operator.attrgetter('token'))$
     return SimpleVocabulary(terms)
 
 


Repository: plone.schemaeditor
Branch: refs/heads/master
Date: 2015-04-09T16:36:43-04:00
Author: Andreas Jung (zopyx) <yet@gmx.de>
Commit: https://github.com/plone/plone.schemaeditor/commit/e4be3f647c52f0edaccc3c211133cb8ad0f52ef3

Update fields.py

Fixed copy&amp;paste problem

Files changed:
M plone/schemaeditor/fields.py

diff --git a/plone/schemaeditor/fields.py b/plone/schemaeditor/fields.py
index e39b71d..f532736 100644
--- a/plone/schemaeditor/fields.py
+++ b/plone/schemaeditor/fields.py
@@ -62,7 +62,7 @@ def FieldsVocabularyFactory(context):
         terms.append(SimpleVocabulary.createTerm(factory,
                                                  translate(factory.title),
                                                  factory.title))
-    terms = sorted(terms, key=operator.attrgetter('token'))$
+    terms = sorted(terms, key=operator.attrgetter('token'))
     return SimpleVocabulary(terms)
 
 


Repository: plone.schemaeditor
Branch: refs/heads/master
Date: 2015-04-12T18:13:56-04:00
Author: David Glick (davisagli) <david@glicksoftware.com>
Commit: https://github.com/plone/plone.schemaeditor/commit/eabd5c7140da51437d0310c3300dcb292fb8b2ab

fix translation in field vocabulary

Files changed:
M CHANGES.rst
M plone/schemaeditor/fields.py
M setup.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 17e5fd6..3affee5 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -1,6 +1,12 @@
 Changelog
 =========
 
+2.0.3 (unreleased)
+------------------
+
+- Fix translation and sorting of field names.
+  [MacYET, davisagli]
+
 2.0.2 (2015-03-13)
 ------------------
 
diff --git a/plone/schemaeditor/fields.py b/plone/schemaeditor/fields.py
index f532736..4ecd2df 100644
--- a/plone/schemaeditor/fields.py
+++ b/plone/schemaeditor/fields.py
@@ -4,6 +4,7 @@
 from zope import component
 from zope.component import adapter
 from zope.component import getUtilitiesFor
+from zope.globalrequest import getRequest
 from zope.interface import implements
 from zope.i18n import translate
 from zope import schema
@@ -53,6 +54,7 @@ def editable(self, field):
 
 
 def FieldsVocabularyFactory(context):
+    request = getRequest()
     field_factories = getUtilitiesFor(IFieldFactory)
     if context.allowedFields is not None:
         field_factories = [(id, factory) for id, factory in field_factories
@@ -60,9 +62,9 @@ def FieldsVocabularyFactory(context):
     terms = []
     for (field_id, factory) in field_factories:
         terms.append(SimpleVocabulary.createTerm(factory,
-                                                 translate(factory.title),
-                                                 factory.title))
-    terms = sorted(terms, key=operator.attrgetter('token'))
+                                                 factory.title,
+                                                 translate(factory.title, context=request)))
+    terms = sorted(terms, key=operator.attrgetter('title'))
     return SimpleVocabulary(terms)
 
 
diff --git a/setup.py b/setup.py
index 3aea04b..8c5cb49 100644
--- a/setup.py
+++ b/setup.py
@@ -1,6 +1,6 @@
 from setuptools import setup, find_packages
 
-version = '2.0.2'
+version = '2.0.3.dev0'
 
 setup(name='plone.schemaeditor',
       version=version,
@@ -28,6 +28,7 @@
           'Zope2',
           'zope.component',
           'zope.container',
+          'zope.globalrequest',
           'zope.interface',
           'zope.lifecycleevent',
           'zope.schema',


