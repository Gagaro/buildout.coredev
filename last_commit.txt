Repository: Products.CMFPlone
Branch: refs/heads/master
Date: 2015-03-19T12:14:43+01:00
Author: Timo Stollenwerk (tisto) <tisto@plone.org>
Commit: https://github.com/plone/Products.CMFPlone/commit/2e2be0b1f5b38eaf3f0d6a974351c474119440d6

Add filter control panel robot test 'Scenario: Configure Filter Control Panel to allow style attributes'.

Files changed:
M Products/CMFPlone/tests/robot/test_controlpanel_filter.robot

diff --git a/Products/CMFPlone/tests/robot/test_controlpanel_filter.robot b/Products/CMFPlone/tests/robot/test_controlpanel_filter.robot
index ee0bc53..8e22f63 100644
--- a/Products/CMFPlone/tests/robot/test_controlpanel_filter.robot
+++ b/Products/CMFPlone/tests/robot/test_controlpanel_filter.robot
@@ -51,7 +51,11 @@ Scenario: Configure Filter Control Panel to strip out attributes
 
 #Scenario: Configure Filter Control Panel to strip out combinations
 
-#Scenario: Configure Filter Control Panel to allow style attributes
+Scenario: Configure Filter Control Panel to allow style attributes
+  Given a logged-in site administrator
+    and the filter control panel
+   When I add 'display' to the allowed style attributes
+   Then the 'display' style attribute is preserved when a document is saved
 
 Scenario: Configure Filter Control Panel to filter out classes
   Pass Execution  Functionality is broken. Maybe even in Plone 4.3?
@@ -114,6 +118,13 @@ I add '${tag}' to the filtered classes
   Click Button  Save
   Wait until page contains  Changes saved
 
+I add '${tag}' to the allowed style attributes
+  Click Button  Add Permitted properties
+  patterns are loaded
+  Input text  name=form.style_whitelist.4.  ${tag}
+  Click Button  Save
+  Wait until page contains  Changes saved
+
 
 # --- THEN -------------------------------------------------------------------
 
@@ -167,5 +178,16 @@ the 'foobar' class is filtered out when a document is saved
   Page should contain  lorem ipsum
 
   XPath Should Match X Times  //*[@id='content-core']//h4  1  message=h4 tag should be present
-  Debug
   XPath Should Match X Times  //*[@id='content-core']//h4[@class='foobar']  0  message=class foobar should have been filtered out
+
+the 'display' style attribute is preserved when a document is saved
+  ${doc1_uid}=  Create content  id=doc1  title=Document 1  type=Document
+  Go To  ${PLONE_URL}/doc1/edit
+  patterns are loaded
+  Input RichText  <h4 style="display: block">lorem ipsum</h4>
+  Click Button  Save
+  Wait until page contains  Changes saved
+  Page should contain  lorem ipsum
+
+  XPath Should Match X Times  //*[@id='content-core']//h4  1  message=h4 tag should be present
+  XPath Should Match X Times  //*[@id='content-core']//h4[@style]  1  message=style attribute with display:block should be present


