Repository: plone.app.versioningbehavior
Branch: refs/heads/master
Date: 2014-11-23T22:38:32+01:00
Author: Jonas Baumann (jone) <jone@jone.ch>
Commit: https://github.com/plone/plone.app.versioningbehavior/commit/8e1a11aa2f395bda7e2d942ca1b50070f17dfe8a

Ported tests to plone.app.testing.

Removed PloneTestCase / p.a.testing compatibility hack.

Files changed:
M CHANGES.rst
M plone/app/versioningbehavior/testing.py
M plone/app/versioningbehavior/tests/test_IntegrationTests.py
M plone/app/versioningbehavior/tests/test_modifiers.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 9bc8fd1..a0a411b 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,6 +4,10 @@ Changelog
 1.2.1 (unreleased)
 ------------------
 
+- Ported tests to plone.app.testing.
+  Removed PloneTestCase / p.a.testing compatibility hack.
+  [jone]
+
 - Remove dependencies on zope.app.container and rwproperty.
   [davisagli]
 
diff --git a/plone/app/versioningbehavior/testing.py b/plone/app/versioningbehavior/testing.py
index b6817a3..fe18e4e 100644
--- a/plone/app/versioningbehavior/testing.py
+++ b/plone/app/versioningbehavior/testing.py
@@ -6,7 +6,6 @@
 from plone.dexterity.fti import DexterityFTI
 from Products.CMFCore.utils import getToolByName
 from Products.CMFDiffTool.TextDiff import TextDiff
-from Products.PloneTestCase.layer import onteardown
 from zope.configuration import xmlconfig
 
 # Make it work with plone.protect < 3.0.0 where the `auto` module is not available.
@@ -19,23 +18,6 @@ class DummyAuto(object):
     protect_auto = DummyAuto()
 
 
-def fix_plonetestcase_mess():
-    """Registers a Products.PloneTestCase cleanup.
-    It is a nested teardown so that we can meake sure that it is executate
-    as last tear down function.
-    """
-    def reset_zope2():
-        """Testing.ZopeTestCase.layer.ZopeLite does not support tearing down.
-        This results in a partically teared down Zope2 instance.
-        This function resets the Zope2 initialization state so that we can
-        initialize another Zope2 instance with p.a.testing.
-        """
-        import Zope2
-        Zope2._began_startup = 0
-    onteardown(reset_zope2)()
-onteardown(fix_plonetestcase_mess)()
-
-
 TEST_CONTENT_TYPE_ID = 'TestContentType'
 DEFAULT_POLICIES = ('at_edit_autoversion', 'version_on_revert',)
 
diff --git a/plone/app/versioningbehavior/tests/test_IntegrationTests.py b/plone/app/versioningbehavior/tests/test_IntegrationTests.py
index 761e904..d74fad8 100644
--- a/plone/app/versioningbehavior/tests/test_IntegrationTests.py
+++ b/plone/app/versioningbehavior/tests/test_IntegrationTests.py
@@ -2,14 +2,10 @@
 from plone.dexterity.fti import DexterityFTI
 from Products.CMFCore.utils import getToolByName
 from Products.CMFEditions.tests import test_IntegrationTests
-from Products.PloneTestCase import PloneTestCase
 from unittest import makeSuite
 from unittest import TestSuite
 
 
-PloneTestCase.setupPloneSite()
-
-
 class TestDexterityIntegration(test_IntegrationTests.TestIntegration):
     """This tests is the same tests as in CMFEditions, but it's run for
     dexterity Document and dexterity Folder.
diff --git a/plone/app/versioningbehavior/tests/test_modifiers.py b/plone/app/versioningbehavior/tests/test_modifiers.py
index 0eb66ea..87c717e 100644
--- a/plone/app/versioningbehavior/tests/test_modifiers.py
+++ b/plone/app/versioningbehavior/tests/test_modifiers.py
@@ -1,24 +1,21 @@
 # -*- coding: utf-8 -*-
-from Products.PloneTestCase import PloneTestCase
-from plone.dexterity.fti import DexterityFTI
 from plone.app.versioningbehavior.modifiers import CloneNamedFileBlobs
 from plone.app.versioningbehavior.modifiers import SkipRelations
-from unittest import TestSuite, makeSuite
-from plone.namedfile.file import NamedBlobFile
-from plone.namedfile import field
-from plone.supermodel import model
 from plone.autoform.interfaces import IFormFieldProvider
+from plone.dexterity.fti import DexterityFTI
 from plone.dexterity.utils import createContentInContainer, createContent
-from ZODB.interfaces import IBlob
-from zope.interface import alsoProvides, Interface
+from plone.namedfile import field
+from plone.namedfile.file import NamedBlobFile
+from plone.supermodel import model
+from Products.CMFEditions.tests.base import CMFEditionsBaseTestCase
 from StringIO import StringIO
-from zope.configuration import xmlconfig
-from zope.component import getUtility
-from z3c.relationfield.schema import RelationChoice, RelationList
+from unittest import TestSuite, makeSuite
 from z3c.relationfield.relation import RelationValue
-
-PloneTestCase.setupPloneSite(
-    extension_profiles=['plone.app.versioningbehavior:default'])
+from z3c.relationfield.schema import RelationChoice, RelationList
+from ZODB.interfaces import IBlob
+from zope.component import getUtility
+from zope.configuration import xmlconfig
+from zope.interface import alsoProvides, Interface
 
 
 class IBlobFile(model.Schema):
@@ -41,7 +38,7 @@ class IRelationsBehavior(model.Schema):
 alsoProvides(IRelationsBehavior, IFormFieldProvider)
 
 
-class TestModifiers(PloneTestCase.PloneTestCase):
+class TestModifiers(CMFEditionsBaseTestCase):
 
     def afterSetUp(self):
         # we need to have the Manager role to be able to add things


Repository: plone.app.versioningbehavior
Branch: refs/heads/master
Date: 2014-12-26T21:11:08+01:00
Author: Tom Gross (tomgross) <itconsense@gmail.com>
Commit: https://github.com/plone/plone.app.versioningbehavior/commit/0ed2add659852b98ecf21d099ae51e186f938451

added missing dependency

Files changed:
M setup.py

diff --git a/setup.py b/setup.py
index eab31ed..3d10e58 100644
--- a/setup.py
+++ b/setup.py
@@ -12,6 +12,7 @@
     'plone.app.testing',
     'plone.app.versioningbehavior',
     'plone.namedfile[blobs]',
+    'zope.app.intid',
     ]
 
 setup(name='plone.app.versioningbehavior',
@@ -25,10 +26,12 @@
       classifiers=[
         "Environment :: Web Environment",
         "Framework :: Plone",
+        "Framework :: Plone :: 5.0",
         "Framework :: Zope2",
         "License :: OSI Approved :: GNU General Public License (GPL)",
         "Operating System :: OS Independent",
         "Programming Language :: Python",
+        "Programming Language :: Python :: 2.7",
         "Topic :: Software Development :: Libraries :: Python Modules",
         ],
       keywords='plone dexterity behavior versioning CMFEditions',


Repository: plone.app.versioningbehavior
Branch: refs/heads/master
Date: 2015-01-05T07:48:52+01:00
Author: Tom Gross (tomgross) <itconsense@gmail.com>
Commit: https://github.com/plone/plone.app.versioningbehavior/commit/ed7f1fc836b46b5883f1073eff87de2ec77a4a75

specify missing testing dependency

Files changed:
M setup.py

diff --git a/setup.py b/setup.py
index eab31ed..39e2e22 100644
--- a/setup.py
+++ b/setup.py
@@ -12,6 +12,7 @@
     'plone.app.testing',
     'plone.app.versioningbehavior',
     'plone.namedfile[blobs]',
+    'zope.app.intid',
     ]
 
 setup(name='plone.app.versioningbehavior',


Repository: plone.app.versioningbehavior
Branch: refs/heads/master
Date: 2015-01-05T07:49:02+01:00
Author: Tom Gross (tomgross) <itconsense@gmail.com>
Commit: https://github.com/plone/plone.app.versioningbehavior/commit/f6df07e62b0eb1e5848f4eb22bcb786f01ab9628

Merge branch 'patesting' of git://github.com/plone/plone.app.versioningbehavior into patesting

Files changed:
M setup.py

diff --git a/setup.py b/setup.py
index 39e2e22..3d10e58 100644
--- a/setup.py
+++ b/setup.py
@@ -26,10 +26,12 @@
       classifiers=[
         "Environment :: Web Environment",
         "Framework :: Plone",
+        "Framework :: Plone :: 5.0",
         "Framework :: Zope2",
         "License :: OSI Approved :: GNU General Public License (GPL)",
         "Operating System :: OS Independent",
         "Programming Language :: Python",
+        "Programming Language :: Python :: 2.7",
         "Topic :: Software Development :: Libraries :: Python Modules",
         ],
       keywords='plone dexterity behavior versioning CMFEditions',


Repository: plone.app.versioningbehavior
Branch: refs/heads/master
Date: 2015-01-27T17:49:52+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.versioningbehavior/commit/3ed3c075c36ccfcc66962013b559560d81f53c77

Merge pull request #11 from plone/patesting

Ported tests to plone.app.testing.

Files changed:
M CHANGES.rst
M plone/app/versioningbehavior/testing.py
M plone/app/versioningbehavior/tests/test_IntegrationTests.py
M plone/app/versioningbehavior/tests/test_modifiers.py
M setup.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 9bc8fd1..a0a411b 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,6 +4,10 @@ Changelog
 1.2.1 (unreleased)
 ------------------
 
+- Ported tests to plone.app.testing.
+  Removed PloneTestCase / p.a.testing compatibility hack.
+  [jone]
+
 - Remove dependencies on zope.app.container and rwproperty.
   [davisagli]
 
diff --git a/plone/app/versioningbehavior/testing.py b/plone/app/versioningbehavior/testing.py
index b6817a3..fe18e4e 100644
--- a/plone/app/versioningbehavior/testing.py
+++ b/plone/app/versioningbehavior/testing.py
@@ -6,7 +6,6 @@
 from plone.dexterity.fti import DexterityFTI
 from Products.CMFCore.utils import getToolByName
 from Products.CMFDiffTool.TextDiff import TextDiff
-from Products.PloneTestCase.layer import onteardown
 from zope.configuration import xmlconfig
 
 # Make it work with plone.protect < 3.0.0 where the `auto` module is not available.
@@ -19,23 +18,6 @@ class DummyAuto(object):
     protect_auto = DummyAuto()
 
 
-def fix_plonetestcase_mess():
-    """Registers a Products.PloneTestCase cleanup.
-    It is a nested teardown so that we can meake sure that it is executate
-    as last tear down function.
-    """
-    def reset_zope2():
-        """Testing.ZopeTestCase.layer.ZopeLite does not support tearing down.
-        This results in a partically teared down Zope2 instance.
-        This function resets the Zope2 initialization state so that we can
-        initialize another Zope2 instance with p.a.testing.
-        """
-        import Zope2
-        Zope2._began_startup = 0
-    onteardown(reset_zope2)()
-onteardown(fix_plonetestcase_mess)()
-
-
 TEST_CONTENT_TYPE_ID = 'TestContentType'
 DEFAULT_POLICIES = ('at_edit_autoversion', 'version_on_revert',)
 
diff --git a/plone/app/versioningbehavior/tests/test_IntegrationTests.py b/plone/app/versioningbehavior/tests/test_IntegrationTests.py
index 761e904..d74fad8 100644
--- a/plone/app/versioningbehavior/tests/test_IntegrationTests.py
+++ b/plone/app/versioningbehavior/tests/test_IntegrationTests.py
@@ -2,14 +2,10 @@
 from plone.dexterity.fti import DexterityFTI
 from Products.CMFCore.utils import getToolByName
 from Products.CMFEditions.tests import test_IntegrationTests
-from Products.PloneTestCase import PloneTestCase
 from unittest import makeSuite
 from unittest import TestSuite
 
 
-PloneTestCase.setupPloneSite()
-
-
 class TestDexterityIntegration(test_IntegrationTests.TestIntegration):
     """This tests is the same tests as in CMFEditions, but it's run for
     dexterity Document and dexterity Folder.
diff --git a/plone/app/versioningbehavior/tests/test_modifiers.py b/plone/app/versioningbehavior/tests/test_modifiers.py
index 0eb66ea..87c717e 100644
--- a/plone/app/versioningbehavior/tests/test_modifiers.py
+++ b/plone/app/versioningbehavior/tests/test_modifiers.py
@@ -1,24 +1,21 @@
 # -*- coding: utf-8 -*-
-from Products.PloneTestCase import PloneTestCase
-from plone.dexterity.fti import DexterityFTI
 from plone.app.versioningbehavior.modifiers import CloneNamedFileBlobs
 from plone.app.versioningbehavior.modifiers import SkipRelations
-from unittest import TestSuite, makeSuite
-from plone.namedfile.file import NamedBlobFile
-from plone.namedfile import field
-from plone.supermodel import model
 from plone.autoform.interfaces import IFormFieldProvider
+from plone.dexterity.fti import DexterityFTI
 from plone.dexterity.utils import createContentInContainer, createContent
-from ZODB.interfaces import IBlob
-from zope.interface import alsoProvides, Interface
+from plone.namedfile import field
+from plone.namedfile.file import NamedBlobFile
+from plone.supermodel import model
+from Products.CMFEditions.tests.base import CMFEditionsBaseTestCase
 from StringIO import StringIO
-from zope.configuration import xmlconfig
-from zope.component import getUtility
-from z3c.relationfield.schema import RelationChoice, RelationList
+from unittest import TestSuite, makeSuite
 from z3c.relationfield.relation import RelationValue
-
-PloneTestCase.setupPloneSite(
-    extension_profiles=['plone.app.versioningbehavior:default'])
+from z3c.relationfield.schema import RelationChoice, RelationList
+from ZODB.interfaces import IBlob
+from zope.component import getUtility
+from zope.configuration import xmlconfig
+from zope.interface import alsoProvides, Interface
 
 
 class IBlobFile(model.Schema):
@@ -41,7 +38,7 @@ class IRelationsBehavior(model.Schema):
 alsoProvides(IRelationsBehavior, IFormFieldProvider)
 
 
-class TestModifiers(PloneTestCase.PloneTestCase):
+class TestModifiers(CMFEditionsBaseTestCase):
 
     def afterSetUp(self):
         # we need to have the Manager role to be able to add things
diff --git a/setup.py b/setup.py
index 39e2e22..3d10e58 100644
--- a/setup.py
+++ b/setup.py
@@ -26,10 +26,12 @@
       classifiers=[
         "Environment :: Web Environment",
         "Framework :: Plone",
+        "Framework :: Plone :: 5.0",
         "Framework :: Zope2",
         "License :: OSI Approved :: GNU General Public License (GPL)",
         "Operating System :: OS Independent",
         "Programming Language :: Python",
+        "Programming Language :: Python :: 2.7",
         "Topic :: Software Development :: Libraries :: Python Modules",
         ],
       keywords='plone dexterity behavior versioning CMFEditions',


