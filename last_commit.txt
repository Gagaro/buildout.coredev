Repository: plone.app.registry


Branch: refs/heads/master
Date: 2015-09-12T10:01:39-05:00
Author: vangheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/plone.app.registry/commit/c289fca913548fd689a1a7ff28947138ab20762c

tweaks to js and styles a bit

Files changed:
M plone/app/registry/browser/records.pt
M plone/app/registry/browser/records.py
M plone/app/registry/browser/resources/registry.js
M plone/app/registry/browser/resources/style.css

diff --git a/plone/app/registry/browser/records.pt b/plone/app/registry/browser/records.pt
index 5127f73..b077917 100644
--- a/plone/app/registry/browser/records.pt
+++ b/plone/app/registry/browser/records.pt
@@ -38,15 +38,28 @@
                 <thead>
                     <tr id="searchrow">
                         <th colspan="5" class="nosort">
+                            <form id="clear-filter">
+                                <button type="submit" i18n:translate="clear_filter">
+                                    Clear filter
+                                </button>
+                            </form>
                             <form tal:define="qp request/qp|nothing;
                                               q request/q|nothing;" id="registry-filter">
-                                <input name="q" id="q" placeholder="filter by..." size="30"
-                                    i18n:attributes="placeholder"
-                                    tal:attributes="value python: qp or q" />
-                                <input type="submit" value="Filter" i18n:attributes="value" />
-                                <tal:trans i18n:translate="or">or</tal:trans>
-                                <select name="qp" tal:define="prefixes python: view.prefixes.keys();
-                                                              dummy python: prefixes.sort();">
+                              <div class="row">
+                                <div class="col-sm-10">
+                                  <input name="q" id="q" placeholder="filter by..." size="30"
+                                      i18n:attributes="placeholder"
+                                      tal:attributes="value python: qp or q" />
+                                </div>
+                                <div class="col-sm-2">
+                                  <input type="submit" value="Filter" i18n:attributes="value" />
+                                </div>
+                              </div>
+                              <div class="row">
+                                <div class="col-sm-6">
+                                  <span i18n:translate="or">or</span>
+                                  <select name="qp" tal:define="prefixes python: view.prefixes.keys();
+                                                                dummy python: prefixes.sort();">
                                     <option value="" i18n:translate="select_prefix">Select Prefix</option>
                                     <tal:prefixes tal:repeat="prefix prefixes">
                                       <option
@@ -54,13 +67,11 @@
                                         tal:attributes="value value;"
                                         tal:content="prefix"/>
                                     </tal:prefixes>
-                                </select>
-                            </form>
-                            <form id="clear-filter">
-                                <button type="submit" i18n:translate="clear_filter">
-                                    Clear filter
-                                </button>
+                                  </select>
+                                </div>
+                              </div>
                             </form>
+                            
                         </th>
                     </tr>
                     <tr>
diff --git a/plone/app/registry/browser/records.py b/plone/app/registry/browser/records.py
index 93adb4e..80b952e 100644
--- a/plone/app/registry/browser/records.py
+++ b/plone/app/registry/browser/records.py
@@ -55,6 +55,6 @@ def __call__(self):
                 self.prefixes[recordPrefix] = prefixValue
             if compare(search, prefixValue) or compare(search, record.__name__):
                 self.records.append(record)
-        self.records = Batch(self.records, 10,
+        self.records = Batch(self.records, 15,
             int(form.get('b_start', '0')), orphan=1)
         return self.index()
diff --git a/plone/app/registry/browser/resources/registry.js b/plone/app/registry/browser/resources/registry.js
index 3686ce6..fea3119 100644
--- a/plone/app/registry/browser/resources/registry.js
+++ b/plone/app/registry/browser/resources/registry.js
@@ -36,17 +36,8 @@ require([
 
   $().ready(function() {
 
-    /* expand the size of search as needed */
-    $('#recordsContainer').delegate('#searchrow input[name="q"]', 'keypress', function(){
-      var self = $(this);
-      var count = self.val().length + 5;
-      if(count > parseInt(self.attr('size'))){
-        self.attr('size', count);
-      }
-    });
-
     /* ajax retrieval of paging */
-    $('#recordsContainer').delegate('div.listingBar a', 'click', function(){
+    $('#recordsContainer').on('click', 'div.listingBar a', function(){
       var self = $(this);
       $('#spinner').show();
       $('#recordsContainer').load(self.attr('href') + ' #recordsTable', function(){
@@ -57,7 +48,7 @@ require([
     });
 
     /* ajax form submission */
-    $('#recordsContainer').delegate('#searchrow form', 'submit', function(e){
+    $('#recordsContainer').on('submit', '#searchrow form', function(e){
       var self = $(this);
       $('#spinner').show();
       $('#recordsContainer').load(
@@ -73,7 +64,7 @@ require([
     });
 
     /* force submit on select change */
-    $('#recordsContainer').delegate('#searchrow select', 'change', function(){
+    $('#recordsContainer').on('change', '#searchrow select', function(){
         $('#searchrow form#registry-filter').trigger('submit');
     });
 
diff --git a/plone/app/registry/browser/resources/style.css b/plone/app/registry/browser/resources/style.css
index 35a88c7..e9ef650 100644
--- a/plone/app/registry/browser/resources/style.css
+++ b/plone/app/registry/browser/resources/style.css
@@ -1,6 +1,7 @@
 #searchrow th{
     padding:0;
     margin:0;
+    position: relative;
 }
 
 #searchrow form{
@@ -10,12 +11,13 @@
 #searchrow input{
     font-size: 16px;
     padding: 3px;
+    width: 100%;
 }
 
 #searchrow select{
     margin-top: 7px;
     display: inline-block;
-    width: 200px;
+    width: inherit;
 }
 
 #searchrow button{
@@ -29,11 +31,9 @@
     color: black;
 }
 
-#registry-filter{
-    float: left;
-}
-
 #clear-filter{
-    float: right;
+    position: absolute;
+    bottom: 0;
+    right: 0;
 }
 


Repository: plone.app.registry


Branch: refs/heads/master
Date: 2015-09-12T10:02:18-05:00
Author: vangheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/plone.app.registry/commit/a553b663bbac0f4fc6dc0fb43ee475b73499b954

registry javascript fix to not auto-expand search field as it was
  not working well

Files changed:
M CHANGES.rst

diff --git a/CHANGES.rst b/CHANGES.rst
index 45e093c..cd65e20 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,7 +4,9 @@ Changelog
 1.3.4 (unreleased)
 ------------------
 
-- Nothing changed yet.
+- registry javascript fix to not auto-expand search field as it was
+  not working well
+  [vangheem]
 
 
 1.3.3 (2015-09-08)


