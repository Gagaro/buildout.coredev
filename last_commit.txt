Repository: plone.app.theming


Branch: refs/heads/master
Date: 2015-08-06T10:32:44-05:00
Author: vangheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/plone.app.theming/commit/95c8b4cb7d884fb4a6fd7ce5fb1e7c93ecfe3db6

fix toolbar on control panel fixes https://github.com/plone/Products.CMFPlone/issues/770

Files changed:
M CHANGES.rst
M src/plone/app/theming/browser/controlpanel.pt

diff --git a/CHANGES.rst b/CHANGES.rst
index 8441c81..c3e88e0 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,6 +4,9 @@ Changelog
 1.2.8 (unreleased)
 ------------------
 
+- fix toolbar on control panel
+  [vangheem]
+
 - fix less building
   [obct537]
 
diff --git a/src/plone/app/theming/browser/controlpanel.pt b/src/plone/app/theming/browser/controlpanel.pt
index bbd5c96..261abf0 100644
--- a/src/plone/app/theming/browser/controlpanel.pt
+++ b/src/plone/app/theming/browser/controlpanel.pt
@@ -12,7 +12,7 @@
           view nocall:view | nocall: plone_view;
           portal_url portal_state/portal_url;
           ajax_load python:False;
-          toolbar_class python:request.cookies.get('plone-toolbar', 'plone-toolbar-left pat-toolbar')"
+          dummy python: request.set('disable_toolbar', True);"
       tal:attributes="lang lang;">
 
     <metal:cache tal:replace="structure provider:plone.httpheaders" />
@@ -47,21 +47,7 @@
                         python:plone_view.patterns_settings()"
         id="visual-portal-wrapper">
 
-    <section id="edit-bar" role="toolbar">
-      <div id="edit-zone" role="toolbar" tal:attributes="class toolbar_class">
-        <div class="plone-toolbar-container">
-          <a class="plone-toolbar-logo">
-            <img alt="Plone Toolbar" tal:attributes="src string:${context/portal_url}/++plone++static/plone-toolbarlogo.svg" />
-          </a>
-          <a class="plone-toolbar-switcher"><span>Left-Top switcher</span></a>
-          <nav role="navigation">
-            <ul>
-              <div tal:replace="structure provider:plone.toolbar">
-              </div>
-            </ul>
-        </div>
-      </div>
-    </section>
+    <div tal:replace="structure provider:plone.toolbar" />
 
     <aside id="global_statusmessage">
       <div class="portalMessage info">


