Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2015-09-17T09:13:49-05:00
Author: vangheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/10cb91bec086d39f520bc4f75bca1167d3b0c1e1

Make sure portal_actions are imported before default portlets. Fixes #1015

Files changed:
A Products/CMFPlone/profiles/dependencies/portlets.xml
M CHANGES.rst
D Products/CMFPlone/profiles/default/portlets.xml

diff --git a/CHANGES.rst b/CHANGES.rst
index 68a6c04..68c1bf4 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -8,6 +8,9 @@ Changelog
 5.0rc3 (unreleased)
 -------------------
 
+- Make sure portal_actions are imported before default portlets. Fixes #1015
+  [vangheem]
+
 - Move calendar_starting_year and calendar_future_years_available to
   registry and Products.Archetypes.
   [pbauer]
diff --git a/Products/CMFPlone/profiles/default/portlets.xml b/Products/CMFPlone/profiles/default/portlets.xml
deleted file mode 100644
index 1610a42..0000000
--- a/Products/CMFPlone/profiles/default/portlets.xml
+++ /dev/null
@@ -1,182 +0,0 @@
-<?xml version="1.0"?>
-<portlets
-    xmlns:i18n="http://xml.zope.org/namespaces/i18n"
-    i18n:domain="plone">
-
- <!-- Columns (portlet managers) -->
-
- <portletmanager
-   name="plone.leftcolumn"
-   type="plone.app.portlets.interfaces.ILeftColumn"
-   />
-
- <portletmanager
-   name="plone.rightcolumn"
-   type="plone.app.portlets.interfaces.IRightColumn"
-   />
-
- <portletmanager
-   name="plone.footerportlets"
-   type="plone.app.portlets.interfaces.IFooter"
-   />
-
- <portletmanager
-   name="plone.dashboard1"
-   type="plone.app.portlets.interfaces.IDashboard"
-   />
- <portletmanager
-   name="plone.dashboard2"
-   type="plone.app.portlets.interfaces.IDashboard"
-   />
- <portletmanager
-   name="plone.dashboard3"
-   type="plone.app.portlets.interfaces.IDashboard"
-   />
- <portletmanager
-   name="plone.dashboard4"
-   type="plone.app.portlets.interfaces.IDashboard"
-   />
-
- <!-- Portlet type registrations -->
-
- <portlet
-   addview="portlets.Classic"
-   title="Classic portlet"
-   description="A portlet which can render a classic template-based portlet"
-   i18n:attributes="title;
-                    description"
-   >
-   <for interface="plone.app.portlets.interfaces.IColumn" />
-   <for interface="plone.app.portlets.interfaces.IDashboard" />
- </portlet>
-
- <portlet
-   addview="portlets.News"
-   title="News"
-   description="A portlet which can render a listing of recent news"
-   i18n:attributes="title;
-                    description"
-   >
-   <for interface="plone.app.portlets.interfaces.IColumn" />
-   <for interface="plone.app.portlets.interfaces.IDashboard" />
- </portlet>
-
- <portlet
-   addview="portlets.Login"
-   title="Login"
-   description="A portlet which can render a log-in box"
-   i18n:attributes="title;
-                    description"
-   >
-   <for interface="plone.app.portlets.interfaces.IColumn" />
- </portlet>
-
- <portlet
-   addview="portlets.Navigation"
-   title="Navigation"
-   description="A portlet which can render a navigation tree"
-   i18n:attributes="title;
-                    description"
-   >
-   <for interface="plone.app.portlets.interfaces.IColumn" />
- </portlet>
-
- <portlet
-   addview="portlets.Recent"
-   title="Recent items"
-   description="A portlet which can render a listing of recently changed items."
-   i18n:attributes="title;
-                    description"
-   >
-   <for interface="plone.app.portlets.interfaces.IColumn" />
-   <for interface="plone.app.portlets.interfaces.IDashboard" />
- </portlet>
-
- <portlet
-   addview="portlets.Review"
-   title="Review list"
-   description="A portlet which can render a listing on the review queue."
-   i18n:attributes="title;
-                    description"
-   >
-   <for interface="plone.app.portlets.interfaces.IColumn" />
-   <for interface="plone.app.portlets.interfaces.IDashboard" />
- </portlet>
-
- <portlet
-   addview="portlets.rss"
-   title="RSS Feed"
-   description="A portlet which can receive and render an RSS feed."
-   i18n:attributes="title;
-                    description"
-   >
-   <for interface="plone.app.portlets.interfaces.IColumn" />
-   <for interface="plone.app.portlets.interfaces.IDashboard" />
- </portlet>
-
- <portlet
-   addview="portlets.Search"
-   title="Search"
-   description="A portlet which shows a search box."
-   i18n:attributes="title;
-                    description"
-   >
-   <for interface="plone.app.portlets.interfaces.IColumn" />
-   <for interface="plone.app.portlets.interfaces.IDashboard" />
- </portlet>
-
- <portlet
-   addview="portlets.Actions"
-   title="Actions"
-   description="A portlet that provides links of an action category"
-   i18n:attributes="title;
-                    description"
-   >
-   <for interface="plone.app.portlets.interfaces.IColumn" />
-   <for interface="plone.app.portlets.interfaces.IDashboard" />
- </portlet>
-
- <assignment
-     manager="plone.leftcolumn"
-     category="context"
-     key="/"
-     type="portlets.Navigation"
-     name="navigation"
-     />
-
- <assignment
-     manager="plone.footerportlets"
-     category="context"
-     key="/"
-     type="portlets.Classic"
-     name="footer"
-     >
-    <property name="template">footer</property>
-    <property name="macro"></property>
- </assignment>
-
- <assignment
-     manager="plone.footerportlets"
-     category="context"
-     key="/"
-     type="portlets.Actions"
-     name="actions"
-     >
-    <property name="ptitle">site_actions</property>
-    <property name="show_title">False</property>
-    <property name="category">site_actions</property>
-    <property name="show_icons">False</property>
- </assignment>
-
- <assignment
-     manager="plone.footerportlets"
-     category="context"
-     key="/"
-     type="portlets.Classic"
-     name="colophon"
-     >
-    <property name="template">colophon</property>
-    <property name="macro"></property>
- </assignment>
-
-</portlets>
diff --git a/Products/CMFPlone/profiles/dependencies/portlets.xml b/Products/CMFPlone/profiles/dependencies/portlets.xml
new file mode 100644
index 0000000..1610a42
--- /dev/null
+++ b/Products/CMFPlone/profiles/dependencies/portlets.xml
@@ -0,0 +1,182 @@
+<?xml version="1.0"?>
+<portlets
+    xmlns:i18n="http://xml.zope.org/namespaces/i18n"
+    i18n:domain="plone">
+
+ <!-- Columns (portlet managers) -->
+
+ <portletmanager
+   name="plone.leftcolumn"
+   type="plone.app.portlets.interfaces.ILeftColumn"
+   />
+
+ <portletmanager
+   name="plone.rightcolumn"
+   type="plone.app.portlets.interfaces.IRightColumn"
+   />
+
+ <portletmanager
+   name="plone.footerportlets"
+   type="plone.app.portlets.interfaces.IFooter"
+   />
+
+ <portletmanager
+   name="plone.dashboard1"
+   type="plone.app.portlets.interfaces.IDashboard"
+   />
+ <portletmanager
+   name="plone.dashboard2"
+   type="plone.app.portlets.interfaces.IDashboard"
+   />
+ <portletmanager
+   name="plone.dashboard3"
+   type="plone.app.portlets.interfaces.IDashboard"
+   />
+ <portletmanager
+   name="plone.dashboard4"
+   type="plone.app.portlets.interfaces.IDashboard"
+   />
+
+ <!-- Portlet type registrations -->
+
+ <portlet
+   addview="portlets.Classic"
+   title="Classic portlet"
+   description="A portlet which can render a classic template-based portlet"
+   i18n:attributes="title;
+                    description"
+   >
+   <for interface="plone.app.portlets.interfaces.IColumn" />
+   <for interface="plone.app.portlets.interfaces.IDashboard" />
+ </portlet>
+
+ <portlet
+   addview="portlets.News"
+   title="News"
+   description="A portlet which can render a listing of recent news"
+   i18n:attributes="title;
+                    description"
+   >
+   <for interface="plone.app.portlets.interfaces.IColumn" />
+   <for interface="plone.app.portlets.interfaces.IDashboard" />
+ </portlet>
+
+ <portlet
+   addview="portlets.Login"
+   title="Login"
+   description="A portlet which can render a log-in box"
+   i18n:attributes="title;
+                    description"
+   >
+   <for interface="plone.app.portlets.interfaces.IColumn" />
+ </portlet>
+
+ <portlet
+   addview="portlets.Navigation"
+   title="Navigation"
+   description="A portlet which can render a navigation tree"
+   i18n:attributes="title;
+                    description"
+   >
+   <for interface="plone.app.portlets.interfaces.IColumn" />
+ </portlet>
+
+ <portlet
+   addview="portlets.Recent"
+   title="Recent items"
+   description="A portlet which can render a listing of recently changed items."
+   i18n:attributes="title;
+                    description"
+   >
+   <for interface="plone.app.portlets.interfaces.IColumn" />
+   <for interface="plone.app.portlets.interfaces.IDashboard" />
+ </portlet>
+
+ <portlet
+   addview="portlets.Review"
+   title="Review list"
+   description="A portlet which can render a listing on the review queue."
+   i18n:attributes="title;
+                    description"
+   >
+   <for interface="plone.app.portlets.interfaces.IColumn" />
+   <for interface="plone.app.portlets.interfaces.IDashboard" />
+ </portlet>
+
+ <portlet
+   addview="portlets.rss"
+   title="RSS Feed"
+   description="A portlet which can receive and render an RSS feed."
+   i18n:attributes="title;
+                    description"
+   >
+   <for interface="plone.app.portlets.interfaces.IColumn" />
+   <for interface="plone.app.portlets.interfaces.IDashboard" />
+ </portlet>
+
+ <portlet
+   addview="portlets.Search"
+   title="Search"
+   description="A portlet which shows a search box."
+   i18n:attributes="title;
+                    description"
+   >
+   <for interface="plone.app.portlets.interfaces.IColumn" />
+   <for interface="plone.app.portlets.interfaces.IDashboard" />
+ </portlet>
+
+ <portlet
+   addview="portlets.Actions"
+   title="Actions"
+   description="A portlet that provides links of an action category"
+   i18n:attributes="title;
+                    description"
+   >
+   <for interface="plone.app.portlets.interfaces.IColumn" />
+   <for interface="plone.app.portlets.interfaces.IDashboard" />
+ </portlet>
+
+ <assignment
+     manager="plone.leftcolumn"
+     category="context"
+     key="/"
+     type="portlets.Navigation"
+     name="navigation"
+     />
+
+ <assignment
+     manager="plone.footerportlets"
+     category="context"
+     key="/"
+     type="portlets.Classic"
+     name="footer"
+     >
+    <property name="template">footer</property>
+    <property name="macro"></property>
+ </assignment>
+
+ <assignment
+     manager="plone.footerportlets"
+     category="context"
+     key="/"
+     type="portlets.Actions"
+     name="actions"
+     >
+    <property name="ptitle">site_actions</property>
+    <property name="show_title">False</property>
+    <property name="category">site_actions</property>
+    <property name="show_icons">False</property>
+ </assignment>
+
+ <assignment
+     manager="plone.footerportlets"
+     category="context"
+     key="/"
+     type="portlets.Classic"
+     name="colophon"
+     >
+    <property name="template">colophon</property>
+    <property name="macro"></property>
+ </assignment>
+
+</portlets>


Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2015-09-17T10:27:23-05:00
Author: Nathan Van Gheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/7bb9d086124d0b199b666d945033371c2e8ba002

Merge pull request #1016 from plone/fix-creation-error

Make sure portal_actions are imported before default portlets

Files changed:
A Products/CMFPlone/profiles/dependencies/portlets.xml
M CHANGES.rst
D Products/CMFPlone/profiles/default/portlets.xml

diff --git a/CHANGES.rst b/CHANGES.rst
index 68a6c04..68c1bf4 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -8,6 +8,9 @@ Changelog
 5.0rc3 (unreleased)
 -------------------
 
+- Make sure portal_actions are imported before default portlets. Fixes #1015
+  [vangheem]
+
 - Move calendar_starting_year and calendar_future_years_available to
   registry and Products.Archetypes.
   [pbauer]
diff --git a/Products/CMFPlone/profiles/default/portlets.xml b/Products/CMFPlone/profiles/default/portlets.xml
deleted file mode 100644
index 1610a42..0000000
--- a/Products/CMFPlone/profiles/default/portlets.xml
+++ /dev/null
@@ -1,182 +0,0 @@
-<?xml version="1.0"?>
-<portlets
-    xmlns:i18n="http://xml.zope.org/namespaces/i18n"
-    i18n:domain="plone">
-
- <!-- Columns (portlet managers) -->
-
- <portletmanager
-   name="plone.leftcolumn"
-   type="plone.app.portlets.interfaces.ILeftColumn"
-   />
-
- <portletmanager
-   name="plone.rightcolumn"
-   type="plone.app.portlets.interfaces.IRightColumn"
-   />
-
- <portletmanager
-   name="plone.footerportlets"
-   type="plone.app.portlets.interfaces.IFooter"
-   />
-
- <portletmanager
-   name="plone.dashboard1"
-   type="plone.app.portlets.interfaces.IDashboard"
-   />
- <portletmanager
-   name="plone.dashboard2"
-   type="plone.app.portlets.interfaces.IDashboard"
-   />
- <portletmanager
-   name="plone.dashboard3"
-   type="plone.app.portlets.interfaces.IDashboard"
-   />
- <portletmanager
-   name="plone.dashboard4"
-   type="plone.app.portlets.interfaces.IDashboard"
-   />
-
- <!-- Portlet type registrations -->
-
- <portlet
-   addview="portlets.Classic"
-   title="Classic portlet"
-   description="A portlet which can render a classic template-based portlet"
-   i18n:attributes="title;
-                    description"
-   >
-   <for interface="plone.app.portlets.interfaces.IColumn" />
-   <for interface="plone.app.portlets.interfaces.IDashboard" />
- </portlet>
-
- <portlet
-   addview="portlets.News"
-   title="News"
-   description="A portlet which can render a listing of recent news"
-   i18n:attributes="title;
-                    description"
-   >
-   <for interface="plone.app.portlets.interfaces.IColumn" />
-   <for interface="plone.app.portlets.interfaces.IDashboard" />
- </portlet>
-
- <portlet
-   addview="portlets.Login"
-   title="Login"
-   description="A portlet which can render a log-in box"
-   i18n:attributes="title;
-                    description"
-   >
-   <for interface="plone.app.portlets.interfaces.IColumn" />
- </portlet>
-
- <portlet
-   addview="portlets.Navigation"
-   title="Navigation"
-   description="A portlet which can render a navigation tree"
-   i18n:attributes="title;
-                    description"
-   >
-   <for interface="plone.app.portlets.interfaces.IColumn" />
- </portlet>
-
- <portlet
-   addview="portlets.Recent"
-   title="Recent items"
-   description="A portlet which can render a listing of recently changed items."
-   i18n:attributes="title;
-                    description"
-   >
-   <for interface="plone.app.portlets.interfaces.IColumn" />
-   <for interface="plone.app.portlets.interfaces.IDashboard" />
- </portlet>
-
- <portlet
-   addview="portlets.Review"
-   title="Review list"
-   description="A portlet which can render a listing on the review queue."
-   i18n:attributes="title;
-                    description"
-   >
-   <for interface="plone.app.portlets.interfaces.IColumn" />
-   <for interface="plone.app.portlets.interfaces.IDashboard" />
- </portlet>
-
- <portlet
-   addview="portlets.rss"
-   title="RSS Feed"
-   description="A portlet which can receive and render an RSS feed."
-   i18n:attributes="title;
-                    description"
-   >
-   <for interface="plone.app.portlets.interfaces.IColumn" />
-   <for interface="plone.app.portlets.interfaces.IDashboard" />
- </portlet>
-
- <portlet
-   addview="portlets.Search"
-   title="Search"
-   description="A portlet which shows a search box."
-   i18n:attributes="title;
-                    description"
-   >
-   <for interface="plone.app.portlets.interfaces.IColumn" />
-   <for interface="plone.app.portlets.interfaces.IDashboard" />
- </portlet>
-
- <portlet
-   addview="portlets.Actions"
-   title="Actions"
-   description="A portlet that provides links of an action category"
-   i18n:attributes="title;
-                    description"
-   >
-   <for interface="plone.app.portlets.interfaces.IColumn" />
-   <for interface="plone.app.portlets.interfaces.IDashboard" />
- </portlet>
-
- <assignment
-     manager="plone.leftcolumn"
-     category="context"
-     key="/"
-     type="portlets.Navigation"
-     name="navigation"
-     />
-
- <assignment
-     manager="plone.footerportlets"
-     category="context"
-     key="/"
-     type="portlets.Classic"
-     name="footer"
-     >
-    <property name="template">footer</property>
-    <property name="macro"></property>
- </assignment>
-
- <assignment
-     manager="plone.footerportlets"
-     category="context"
-     key="/"
-     type="portlets.Actions"
-     name="actions"
-     >
-    <property name="ptitle">site_actions</property>
-    <property name="show_title">False</property>
-    <property name="category">site_actions</property>
-    <property name="show_icons">False</property>
- </assignment>
-
- <assignment
-     manager="plone.footerportlets"
-     category="context"
-     key="/"
-     type="portlets.Classic"
-     name="colophon"
-     >
-    <property name="template">colophon</property>
-    <property name="macro"></property>
- </assignment>
-
-</portlets>
diff --git a/Products/CMFPlone/profiles/dependencies/portlets.xml b/Products/CMFPlone/profiles/dependencies/portlets.xml
new file mode 100644
index 0000000..1610a42
--- /dev/null
+++ b/Products/CMFPlone/profiles/dependencies/portlets.xml
@@ -0,0 +1,182 @@
+<?xml version="1.0"?>
+<portlets
+    xmlns:i18n="http://xml.zope.org/namespaces/i18n"
+    i18n:domain="plone">
+
+ <!-- Columns (portlet managers) -->
+
+ <portletmanager
+   name="plone.leftcolumn"
+   type="plone.app.portlets.interfaces.ILeftColumn"
+   />
+
+ <portletmanager
+   name="plone.rightcolumn"
+   type="plone.app.portlets.interfaces.IRightColumn"
+   />
+
+ <portletmanager
+   name="plone.footerportlets"
+   type="plone.app.portlets.interfaces.IFooter"
+   />
+
+ <portletmanager
+   name="plone.dashboard1"
+   type="plone.app.portlets.interfaces.IDashboard"
+   />
+ <portletmanager
+   name="plone.dashboard2"
+   type="plone.app.portlets.interfaces.IDashboard"
+   />
+ <portletmanager
+   name="plone.dashboard3"
+   type="plone.app.portlets.interfaces.IDashboard"
+   />
+ <portletmanager
+   name="plone.dashboard4"
+   type="plone.app.portlets.interfaces.IDashboard"
+   />
+
+ <!-- Portlet type registrations -->
+
+ <portlet
+   addview="portlets.Classic"
+   title="Classic portlet"
+   description="A portlet which can render a classic template-based portlet"
+   i18n:attributes="title;
+                    description"
+   >
+   <for interface="plone.app.portlets.interfaces.IColumn" />
+   <for interface="plone.app.portlets.interfaces.IDashboard" />
+ </portlet>
+
+ <portlet
+   addview="portlets.News"
+   title="News"
+   description="A portlet which can render a listing of recent news"
+   i18n:attributes="title;
+                    description"
+   >
+   <for interface="plone.app.portlets.interfaces.IColumn" />
+   <for interface="plone.app.portlets.interfaces.IDashboard" />
+ </portlet>
+
+ <portlet
+   addview="portlets.Login"
+   title="Login"
+   description="A portlet which can render a log-in box"
+   i18n:attributes="title;
+                    description"
+   >
+   <for interface="plone.app.portlets.interfaces.IColumn" />
+ </portlet>
+
+ <portlet
+   addview="portlets.Navigation"
+   title="Navigation"
+   description="A portlet which can render a navigation tree"
+   i18n:attributes="title;
+                    description"
+   >
+   <for interface="plone.app.portlets.interfaces.IColumn" />
+ </portlet>
+
+ <portlet
+   addview="portlets.Recent"
+   title="Recent items"
+   description="A portlet which can render a listing of recently changed items."
+   i18n:attributes="title;
+                    description"
+   >
+   <for interface="plone.app.portlets.interfaces.IColumn" />
+   <for interface="plone.app.portlets.interfaces.IDashboard" />
+ </portlet>
+
+ <portlet
+   addview="portlets.Review"
+   title="Review list"
+   description="A portlet which can render a listing on the review queue."
+   i18n:attributes="title;
+                    description"
+   >
+   <for interface="plone.app.portlets.interfaces.IColumn" />
+   <for interface="plone.app.portlets.interfaces.IDashboard" />
+ </portlet>
+
+ <portlet
+   addview="portlets.rss"
+   title="RSS Feed"
+   description="A portlet which can receive and render an RSS feed."
+   i18n:attributes="title;
+                    description"
+   >
+   <for interface="plone.app.portlets.interfaces.IColumn" />
+   <for interface="plone.app.portlets.interfaces.IDashboard" />
+ </portlet>
+
+ <portlet
+   addview="portlets.Search"
+   title="Search"
+   description="A portlet which shows a search box."
+   i18n:attributes="title;
+                    description"
+   >
+   <for interface="plone.app.portlets.interfaces.IColumn" />
+   <for interface="plone.app.portlets.interfaces.IDashboard" />
+ </portlet>
+
+ <portlet
+   addview="portlets.Actions"
+   title="Actions"
+   description="A portlet that provides links of an action category"
+   i18n:attributes="title;
+                    description"
+   >
+   <for interface="plone.app.portlets.interfaces.IColumn" />
+   <for interface="plone.app.portlets.interfaces.IDashboard" />
+ </portlet>
+
+ <assignment
+     manager="plone.leftcolumn"
+     category="context"
+     key="/"
+     type="portlets.Navigation"
+     name="navigation"
+     />
+
+ <assignment
+     manager="plone.footerportlets"
+     category="context"
+     key="/"
+     type="portlets.Classic"
+     name="footer"
+     >
+    <property name="template">footer</property>
+    <property name="macro"></property>
+ </assignment>
+
+ <assignment
+     manager="plone.footerportlets"
+     category="context"
+     key="/"
+     type="portlets.Actions"
+     name="actions"
+     >
+    <property name="ptitle">site_actions</property>
+    <property name="show_title">False</property>
+    <property name="category">site_actions</property>
+    <property name="show_icons">False</property>
+ </assignment>
+
+ <assignment
+     manager="plone.footerportlets"
+     category="context"
+     key="/"
+     type="portlets.Classic"
+     name="colophon"
+     >
+    <property name="template">colophon</property>
+    <property name="macro"></property>
+ </assignment>
+
+</portlets>


