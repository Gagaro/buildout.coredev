Repository: plone.app.multilingual


Branch: refs/heads/master
Date: 2015-09-18T13:26:09-07:00
Author: Fulvio Casali (fulv) <fulviocasali@gmail.com>
Commit: https://github.com/plone/plone.app.multilingual/commit/234574076aa44b0dfe28706445a380cc7a7df4b0

Resolve deprecation warning for isDefaultPage.

Files changed:
M CHANGES.rst
M src/plone/app/multilingual/browser/menu.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 51d61c7..6676af1 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,7 +4,8 @@ Changelog
 3.0.11 (unreleased)
 -------------------
 
-- Nothing changed yet.
+- Resolve deprecation warning for isDefaultPage.
+  [fulv]
 
 
 3.0.10 (2015-09-15)
diff --git a/src/plone/app/multilingual/browser/menu.py b/src/plone/app/multilingual/browser/menu.py
index 67b2634..ea5196b 100644
--- a/src/plone/app/multilingual/browser/menu.py
+++ b/src/plone/app/multilingual/browser/menu.py
@@ -2,7 +2,6 @@
 from AccessControl import getSecurityManager
 from Acquisition import aq_parent
 from Products.CMFCore.utils import getToolByName
-from plone.app.layout.navigation.defaultpage import isDefaultPage
 from plone.app.layout.navigation.interfaces import INavigationRoot
 from plone.app.multilingual import _
 from plone.app.multilingual.browser.interfaces import ITranslateMenu
@@ -11,6 +10,7 @@
 from plone.app.multilingual.browser.vocabularies import translated_languages
 from plone.app.multilingual.browser.vocabularies import translated_urls
 from plone.app.multilingual.browser.vocabularies import untranslated_languages
+from Products.CMFPlone.defaultpage import is_default_page
 from Products.CMFPlone.interfaces import ILanguage
 from plone.app.multilingual.interfaces import IMultiLanguageExtraOptionsSchema
 from plone.app.multilingual.interfaces import IPloneAppMultilingualInstalled
@@ -86,7 +86,7 @@ def getMenuItems(self, context, request):
             else:
                 contexts = []
             prt = aq_parent(context)
-            if isDefaultPage(prt, context) and ITranslatable.providedBy(prt):
+            if is_default_page(prt, context) and ITranslatable.providedBy(prt):
                 contexts.append(prt)
 
             for idx, context in enumerate(contexts):


Repository: plone.app.multilingual


Branch: refs/heads/master
Date: 2015-09-21T23:22:04+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.multilingual/commit/8b32ab9d5b4399135a6dd92e7adc88e23c94b0fc

Merge pull request #182 from plone/fulv-patch

Resolve deprecation warning for isDefaultPage.

Files changed:
M CHANGES.rst
M src/plone/app/multilingual/browser/menu.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 667db52..72c30f4 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,7 +4,8 @@ Changelog
 3.0.12 (unreleased)
 -------------------
 
-- Nothing changed yet.
+- Resolve deprecation warning for isDefaultPage.
+  [fulv]
 
 
 3.0.11 (2015-09-20)
diff --git a/src/plone/app/multilingual/browser/menu.py b/src/plone/app/multilingual/browser/menu.py
index 67b2634..ea5196b 100644
--- a/src/plone/app/multilingual/browser/menu.py
+++ b/src/plone/app/multilingual/browser/menu.py
@@ -2,7 +2,6 @@
 from AccessControl import getSecurityManager
 from Acquisition import aq_parent
 from Products.CMFCore.utils import getToolByName
-from plone.app.layout.navigation.defaultpage import isDefaultPage
 from plone.app.layout.navigation.interfaces import INavigationRoot
 from plone.app.multilingual import _
 from plone.app.multilingual.browser.interfaces import ITranslateMenu
@@ -11,6 +10,7 @@
 from plone.app.multilingual.browser.vocabularies import translated_languages
 from plone.app.multilingual.browser.vocabularies import translated_urls
 from plone.app.multilingual.browser.vocabularies import untranslated_languages
+from Products.CMFPlone.defaultpage import is_default_page
 from Products.CMFPlone.interfaces import ILanguage
 from plone.app.multilingual.interfaces import IMultiLanguageExtraOptionsSchema
 from plone.app.multilingual.interfaces import IPloneAppMultilingualInstalled
@@ -86,7 +86,7 @@ def getMenuItems(self, context, request):
             else:
                 contexts = []
             prt = aq_parent(context)
-            if isDefaultPage(prt, context) and ITranslatable.providedBy(prt):
+            if is_default_page(prt, context) and ITranslatable.providedBy(prt):
                 contexts.append(prt)
 
             for idx, context in enumerate(contexts):


