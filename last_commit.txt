Repository: plone.app.contenttypes


Branch: refs/heads/master
Date: 2015-11-06T01:07:21+01:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.contenttypes/commit/e27ee98ff25467f084601b9e68fbffee48cf4429

fix unicode-error in tests

Files changed:
M plone/app/contenttypes/indexers.py

diff --git a/plone/app/contenttypes/indexers.py b/plone/app/contenttypes/indexers.py
index db06bb3..6d3bd87 100644
--- a/plone/app/contenttypes/indexers.py
+++ b/plone/app/contenttypes/indexers.py
@@ -43,7 +43,7 @@ def SearchableText(obj):
             transforms = getToolByName(obj, 'portal_transforms')
             text = transforms.convertTo(
                 'text/plain',
-                textvalue.output.encode('utf8'),
+                safe_unicode(textvalue.output).encode('utf8'),
                 mimetype=textvalue.mimeType,
             ).getData().strip()
 


