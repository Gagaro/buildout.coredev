Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2015-10-20T07:40:15-05:00
Author: vangheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/de98208b64fbda149ebd477d756615a42c979016

prevent throwing error with mis-configured bundle fixes https://github.com/plone/Products.CMFPlone/issues/1199

Files changed:
M CHANGES.rst
M Products/CMFPlone/resources/browser/cook.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 8f33a5d..b1488bf 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -8,6 +8,9 @@ Changelog
 5.0.1 (unreleased)
 ------------------
 
+- Fix #1199 prevent throwing error with mis-configured bundle
+  [vangheem]
+
 - Fix wrong sentence in front page, there is no "Site Setup entry in the menu
   in the top right corner", replace it by "Site Setup entry in the user menu".
   [vincentfretin]
diff --git a/Products/CMFPlone/resources/browser/cook.py b/Products/CMFPlone/resources/browser/cook.py
index a7a7b18..da9316b 100644
--- a/Products/CMFPlone/resources/browser/cook.py
+++ b/Products/CMFPlone/resources/browser/cook.py
@@ -89,6 +89,11 @@ def cookWhenChangingSettings(context, bundle=None):
     js_path = bundle.jscompilation
     css_path = bundle.csscompilation
 
+    if not js_path:
+        logger.warn('Could not compile js/css for bundle as there is '
+                    'no jscompilation setting')
+        return
+
     # Storing js
     resource_path = js_path.split('++plone++')[-1]
     resource_name, resource_filepath = resource_path.split('/', 1)


Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2015-10-20T07:40:43-05:00
Author: Nathan Van Gheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/64919abe2d0d52d6978c5ffb509857f11bcd19e8

Merge pull request #1200 from plone/compile-bundle-error

prevent throwing error with mis-configured bundle

Files changed:
M CHANGES.rst
M Products/CMFPlone/resources/browser/cook.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 8f33a5d..b1488bf 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -8,6 +8,9 @@ Changelog
 5.0.1 (unreleased)
 ------------------
 
+- Fix #1199 prevent throwing error with mis-configured bundle
+  [vangheem]
+
 - Fix wrong sentence in front page, there is no "Site Setup entry in the menu
   in the top right corner", replace it by "Site Setup entry in the user menu".
   [vincentfretin]
diff --git a/Products/CMFPlone/resources/browser/cook.py b/Products/CMFPlone/resources/browser/cook.py
index a7a7b18..da9316b 100644
--- a/Products/CMFPlone/resources/browser/cook.py
+++ b/Products/CMFPlone/resources/browser/cook.py
@@ -89,6 +89,11 @@ def cookWhenChangingSettings(context, bundle=None):
     js_path = bundle.jscompilation
     css_path = bundle.csscompilation
 
+    if not js_path:
+        logger.warn('Could not compile js/css for bundle as there is '
+                    'no jscompilation setting')
+        return
+
     # Storing js
     resource_path = js_path.split('++plone++')[-1]
     resource_name, resource_filepath = resource_path.split('/', 1)


