Repository: plone.app.openid
Branch: refs/heads/2.0.x
Date: 2015-05-30T17:47:41+02:00
Author: Tom Gross (tomgross) <itconsense@gmail.com>
Commit: https://github.com/plone/plone.app.openid/commit/ea51294505ad5e741b197f8974bbf3dd927fd8cd

simplify plugin creation

This hopefully fixes the p.a.testing merge of p.openid

Files changed:
M plone/app/openid/setuphandlers.py

diff --git a/plone/app/openid/setuphandlers.py b/plone/app/openid/setuphandlers.py
index 7713a2b..2f13e8c 100644
--- a/plone/app/openid/setuphandlers.py
+++ b/plone/app/openid/setuphandlers.py
@@ -3,6 +3,7 @@
 from StringIO import StringIO
 from plone.portlets.interfaces import IPortletAssignmentMapping
 from plone.portlets.interfaces import IPortletManager
+from plone.openid.plugins.oid import addOpenIdPlugin
 from plone.app.openid.portlets.login import Assignment as LoginAssignment
 from Products.CMFCore.utils import getToolByName
 from Products.PlonePAS.browser.info import PASInfoView
@@ -15,9 +16,8 @@ def hasOpenIdPlugin(portal):
 
 def createOpenIdPlugin(portal, out):
     print >>out, "Adding an OpenId plugin"
-    acl=getToolByName(portal, "acl_users")
-    acl.manage_addProduct["plone.openid"].addOpenIdPlugin(
-            id="openid", title="OpenId authentication plugin")
+    acl = getToolByName(portal, "acl_users")
+    addOpenIdPlugin(acl, id="openid", title="OpenId authentication plugin")
 
 
 def activatePlugin(portal, out, plugin):


Repository: plone.app.openid
Branch: refs/heads/2.0.x
Date: 2015-05-30T17:48:34+02:00
Author: Timo Stollenwerk (tisto) <tisto@plone.org>
Commit: https://github.com/plone/plone.app.openid/commit/2c05ef1a204267d30a417d0fe777e0b3582b35fc

No need to install plone.app.openid as z2 pkg.

Files changed:
M plone/app/openid/testing.py

diff --git a/plone/app/openid/testing.py b/plone/app/openid/testing.py
index 9eae366..9e89ba9 100644
--- a/plone/app/openid/testing.py
+++ b/plone/app/openid/testing.py
@@ -1,9 +1,5 @@
 # -*- coding: utf-8 -*-
-
 from zope.configuration import xmlconfig
-
-from plone.testing import z2
-
 from plone.app.testing import PloneSandboxLayer
 from plone.app.testing.layers import IntegrationTesting
 
@@ -13,16 +9,13 @@ class PloneAppOpenidLayer(PloneSandboxLayer):
     def setUpZope(self, app, configurationContext):
         import plone.openid
         self.loadZCML(package=plone.openid)
-        z2.installProduct(app, 'plone.openid')
-        z2.installProduct(app, 'plone.app.openid')
         import plone.app.openid
         xmlconfig.file(
             'configure.zcml',
             plone.app.openid,
-            context=configurationContext)
+            context=configurationContext
+        )
 
-    def tearDownZope(self, app):
-        z2.uninstallProduct(app, 'plone.app.openid')
 
 PLONEAPPOPENID_FIXTURE = PloneAppOpenidLayer()
 


Repository: plone.app.openid
Branch: refs/heads/2.0.x
Date: 2015-05-30T17:49:48+02:00
Author: Timo Stollenwerk (tisto) <tisto@plone.org>
Commit: https://github.com/plone/plone.app.openid/commit/0d83e1d8250c90d361d19da58e362757316656dc

Update changelog with backportet issues.

Files changed:
M CHANGES.rst

diff --git a/CHANGES.rst b/CHANGES.rst
index 594cbe7..f77c5db 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -5,8 +5,12 @@ Changelog
 2.0.4 (unreleased)
 ------------------
 
-- Nothing changed yet.
+- No need to install plone.app.openid as z2 pkg.
+  [timo]
 
+- Simplify plugin creation.
+  [tomgross]
+ 
 
 2.0.3 (2015-02-11)
 ------------------


