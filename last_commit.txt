Repository: Products.CMFFormController
Branch: refs/heads/master
Date: 2015-05-20T09:41:22+02:00
Author: Andrea Cecchi (cekk) <andrea.cecchi85@gmail.com>
Commit: https://github.com/plone/Products.CMFFormController/commit/a3dd466ab41b97d9e3297aca835db72c72baa849

additional check for entry deletion

Files changed:
M Products/CMFFormController/BaseControllerPageTemplate.py

diff --git a/Products/CMFFormController/BaseControllerPageTemplate.py b/Products/CMFFormController/BaseControllerPageTemplate.py
index 688e74b..34fea5c 100644
--- a/Products/CMFFormController/BaseControllerPageTemplate.py
+++ b/Products/CMFFormController/BaseControllerPageTemplate.py
@@ -24,7 +24,8 @@ def _call(self, inherited_call, *args, **kwargs):
             controller_state = self.getButton(controller_state, REQUEST)
             validators = self.getValidators(controller_state, REQUEST).getValidators()
             controller_state = controller.validate(controller_state, REQUEST, validators)
-            del REQUEST.form['form.submitted']
+            if 'form.submitted' in REQUEST.form:
+                del REQUEST.form['form.submitted']
             return self.getNext(controller_state, REQUEST)
 
         kwargs['state'] = controller_state


Repository: Products.CMFFormController
Branch: refs/heads/master
Date: 2015-05-20T09:41:34+02:00
Author: Andrea Cecchi (cekk) <andrea.cecchi85@gmail.com>
Commit: https://github.com/plone/Products.CMFFormController/commit/96e3e4f79df66d54829fea63dc6db211b244fe93

updated changes

Files changed:
M CHANGES.txt

diff --git a/CHANGES.txt b/CHANGES.txt
index 5debdfc..a88b9c3 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -4,7 +4,8 @@ Changelog
 3.0.5 (unreleased)
 ------------------
 
-- Nothing changed yet.
+- Additional check in BaseControllerPageTemplate when we try to delete an entry
+  from the request, that has already been deleted [cekk]
 
 
 3.0.4 (2015-03-08)


Repository: Products.CMFFormController
Branch: refs/heads/master
Date: 2015-05-20T13:23:51+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFFormController/commit/12167fbc592155e560a5e069a3819f57deba8080

Merge pull request #2 from plone/submitted_secure_deletion

form.submitted secure deletion

Files changed:
M CHANGES.txt
M Products/CMFFormController/BaseControllerPageTemplate.py

diff --git a/CHANGES.txt b/CHANGES.txt
index 5debdfc..a88b9c3 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -4,7 +4,8 @@ Changelog
 3.0.5 (unreleased)
 ------------------
 
-- Nothing changed yet.
+- Additional check in BaseControllerPageTemplate when we try to delete an entry
+  from the request, that has already been deleted [cekk]
 
 
 3.0.4 (2015-03-08)
diff --git a/Products/CMFFormController/BaseControllerPageTemplate.py b/Products/CMFFormController/BaseControllerPageTemplate.py
index 688e74b..34fea5c 100644
--- a/Products/CMFFormController/BaseControllerPageTemplate.py
+++ b/Products/CMFFormController/BaseControllerPageTemplate.py
@@ -24,7 +24,8 @@ def _call(self, inherited_call, *args, **kwargs):
             controller_state = self.getButton(controller_state, REQUEST)
             validators = self.getValidators(controller_state, REQUEST).getValidators()
             controller_state = controller.validate(controller_state, REQUEST, validators)
-            del REQUEST.form['form.submitted']
+            if 'form.submitted' in REQUEST.form:
+                del REQUEST.form['form.submitted']
             return self.getNext(controller_state, REQUEST)
 
         kwargs['state'] = controller_state


