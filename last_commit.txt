Repository: Products.CMFPlone
Branch: refs/heads/master
Date: 2015-02-27T09:14:07+01:00
Author: Timo Stollenwerk () <contact@timostollenwerk.net>
Commit: https://github.com/plone/Products.CMFPlone/commit/ad452bb23c5f7d70eab014db0c76ebb5e7d615bc

Read security settings from the registry instead of portal properties.

Files changed:
M CHANGES.rst
M Products/CMFPlone/browser/templates/search.pt

diff --git a/CHANGES.rst b/CHANGES.rst
index 087bce2..f380775 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -8,6 +8,9 @@ Changelog
 5.0b1 (unreleased)
 ------------------
 
+- Read security settings from the registry instead of portal properties.
+  [jcerjak,timo]
+
 - Fix tests for plone.app.contenttypes unified view names, which uses
   ``listing_view`` for Folder and Collection types.
   [thet]
diff --git a/Products/CMFPlone/browser/templates/search.pt b/Products/CMFPlone/browser/templates/search.pt
index 2695daa..9212096 100644
--- a/Products/CMFPlone/browser/templates/search.pt
+++ b/Products/CMFPlone/browser/templates/search.pt
@@ -147,7 +147,7 @@
                                       <div class="search-type-options">
                                         <tal:div
                                            tal:define="typeLists python:context.createMultiColumnList(types_list, numCols=2, sort_on='self');"
-                                           
+
                                            tal:repeat="sublist typeLists">
                                           <tal:items repeat="type sublist">
                                             <div>
@@ -240,7 +240,7 @@
 
                     </dl>
 
-                    
+
                 </div>
 
 
@@ -275,7 +275,7 @@
                                                    toLocalizedTime nocall: context/@@plone/toLocalizedTime;
                                                    site_properties context/portal_properties/site_properties;
                                                    use_view_action site_properties/typesUseViewActionInListings|python:();
-                                                   allowAnonymousViewAbout site_properties/allowAnonymousViewAbout;
+                                                   allowAnonymousViewAbout python:context.portal_registry['plone.allow_anon_views_about'];
                                                    show_about python:not isAnon or allowAnonymousViewAbout;">
                           <ol class="searchResults">
                               <tal:results repeat="item batch">


