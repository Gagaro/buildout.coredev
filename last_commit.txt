Repository: Products.CMFPlone
Branch: refs/heads/master
Date: 2015-02-02T16:22:38+01:00
Author: Ramon Navarro Bosch (bloodbare) <ramon.nb@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/0ad0fd72b8d0545d87e47ef9830919de95814f5f

Adding a check for env var FEDEV to allow run plone on frontend development

Files changed:
M Products/CMFPlone/resources/browser/resource.py

diff --git a/Products/CMFPlone/resources/browser/resource.py b/Products/CMFPlone/resources/browser/resource.py
index 38d8ae1..32b1af4 100644
--- a/Products/CMFPlone/resources/browser/resource.py
+++ b/Products/CMFPlone/resources/browser/resource.py
@@ -14,6 +14,7 @@
 from zope.component import getUtility
 from zope.ramcache.interfaces import ram
 from Products.CMFCore.utils import _getAuthenticatedUser
+import os
 
 
 class ResourceView(ViewletBase):
@@ -22,6 +23,19 @@ class ResourceView(ViewletBase):
 
     @property
     def development(self):
+        """
+        To set development mode:
+
+        - we can define a envvar: FEDEV
+        - otherwise if its anonymous is using production mode
+        - finally is checked on the registry entry
+        """
+        env_development = os.getenv('FEDEV')
+        if env_development:
+            if env_development.lower() == 'false':
+                return False
+            elif env_development.lower() == 'true':
+                return True
         if _getAuthenticatedUser(self.context).getUserName() == 'Anonymous User':
             return False
         return self.registry.records['plone.resources.development'].value


