Repository: Products.TinyMCE


Branch: refs/heads/1.3.x
Date: 2015-07-10T09:30:56+02:00
Author: Harald Friessnegger (frisi) <harald@webmeisterei.com>
Commit: https://github.com/plone/Products.TinyMCE/commit/724699429d6b7b2cdc99e301a0b6ca54d361215e

apply changes from https://github.com/plone/Products.TinyMCE/pull/84 to 1.3.x branch too

Files changed:
M HISTORY.rst
M Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js

diff --git a/HISTORY.rst b/HISTORY.rst
index c532073..9816132 100644
--- a/HISTORY.rst
+++ b/HISTORY.rst
@@ -5,7 +5,8 @@ HISTORY
 1.3.11 (unreleased)
 -------------------
 
-- Nothing changed yet.
+- Fixed current image scale in image popups
+  [huubbouma]
 
 
 1.3.10 (2015-06-26)
diff --git a/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js b/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js
index f95a9d7..b47ec6d 100644
--- a/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js
+++ b/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js
@@ -349,8 +349,8 @@ BrowserDialog.prototype.init = function () {
             } else {
                 scaled_image = this.parseImageScale(selected_node.attr("src"));
 
-                // Update the dimensions <select> with the corresponding value.
-                jq('#dimensions', document).val(scaled_image.scale);
+                // Store the selected scale on the dimensions <select>.
+                jq('#dimensions', document).data('selectedScale', scaled_image.scale);
 
                 if (scaled_image.url.indexOf('resolveuid/') > -1) {
                     /** Handle UID linked image **/
@@ -739,7 +739,7 @@ BrowserDialog.prototype.setDetails = function (url) {
         'url': url + '/tinymce-jsondetails',
         'dataType': 'json',
         'success': function (data) {
-            var dimension = jq('#dimensions', document).val(),
+            var dimension = jq('#dimensions', document).data('selectedScale'),
                 dimensions,
                 i;
 


Repository: Products.TinyMCE


Branch: refs/heads/1.3.x
Date: 2015-07-22T15:29:14+02:00
Author: Fred van Dijk (fredvd) <fredvd@gmail.com>
Commit: https://github.com/plone/Products.TinyMCE/commit/567a485680b05cb874e54839ee19b423378d7441

Merge branch '1.3.x' into image-scale

Files changed:
M README.rst

diff --git a/README.rst b/README.rst
index 1604735..950fb06 100644
--- a/README.rst
+++ b/README.rst
@@ -1 +1 @@
-Documentation at http://readthedocs.org/docs/productstinymce/
+Documentation at https://productstinymce.readthedocs.org/en/latest/


Repository: Products.TinyMCE


Branch: refs/heads/1.3.x
Date: 2015-07-22T15:30:29+02:00
Author: Fred van Dijk (fredvd) <fredvd@gmail.com>
Commit: https://github.com/plone/Products.TinyMCE/commit/ef1d5bc8e64de5b85be5a0cb54aea65891945b6c

Merge branch 'image-scale' into 1.3.x

Files changed:
M HISTORY.rst
M Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js

diff --git a/HISTORY.rst b/HISTORY.rst
index c532073..9816132 100644
--- a/HISTORY.rst
+++ b/HISTORY.rst
@@ -5,7 +5,8 @@ HISTORY
 1.3.11 (unreleased)
 -------------------
 
-- Nothing changed yet.
+- Fixed current image scale in image popups
+  [huubbouma]
 
 
 1.3.10 (2015-06-26)
diff --git a/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js b/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js
index f95a9d7..b47ec6d 100644
--- a/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js
+++ b/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js
@@ -349,8 +349,8 @@ BrowserDialog.prototype.init = function () {
             } else {
                 scaled_image = this.parseImageScale(selected_node.attr("src"));
 
-                // Update the dimensions <select> with the corresponding value.
-                jq('#dimensions', document).val(scaled_image.scale);
+                // Store the selected scale on the dimensions <select>.
+                jq('#dimensions', document).data('selectedScale', scaled_image.scale);
 
                 if (scaled_image.url.indexOf('resolveuid/') > -1) {
                     /** Handle UID linked image **/
@@ -739,7 +739,7 @@ BrowserDialog.prototype.setDetails = function (url) {
         'url': url + '/tinymce-jsondetails',
         'dataType': 'json',
         'success': function (data) {
-            var dimension = jq('#dimensions', document).val(),
+            var dimension = jq('#dimensions', document).data('selectedScale'),
                 dimensions,
                 i;
 


