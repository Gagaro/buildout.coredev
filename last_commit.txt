Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2015-10-05T16:18:58-05:00
Author: vangheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/plone.app.upgrade/commit/7f66d4c065de062ac757158a8817bbc5add6010f

add upgrades for plone 5.0.1

Files changed:
A plone/app/upgrade/v50/profiles/to_501/registry.xml
M plone/app/upgrade/v50/configure.zcml
M plone/app/upgrade/v50/final.py
M plone/app/upgrade/v50/profiles.zcml

diff --git a/plone/app/upgrade/v50/configure.zcml b/plone/app/upgrade/v50/configure.zcml
index 5834ea5..ee73c59 100644
--- a/plone/app/upgrade/v50/configure.zcml
+++ b/plone/app/upgrade/v50/configure.zcml
@@ -264,6 +264,10 @@
            handler="plone.app.upgrade.v43.final.removeFakeKupu"
            />
 
+      <gs:upgradeStep
+           title="Run to501 upgrade profile."
+           description=""
+           handler=".final.to501"
+           />
     </gs:upgradeSteps>
-
 </configure>
diff --git a/plone/app/upgrade/v50/final.py b/plone/app/upgrade/v50/final.py
index 15c8239..fd5339f 100644
--- a/plone/app/upgrade/v50/final.py
+++ b/plone/app/upgrade/v50/final.py
@@ -34,3 +34,8 @@ def _migrate_list(original_id, new_id=None):
     # Here we do it again correctly.
     _migrate_list('typesUseViewActionInListings',
                   'types_use_view_action_in_listings')
+
+
+def to501(context):
+    """5.0 -> 5.0.1"""
+    loadMigrationProfile(context, 'profile-plone.app.upgrade.v50:to501')
diff --git a/plone/app/upgrade/v50/profiles.zcml b/plone/app/upgrade/v50/profiles.zcml
index b34ff4c..d5d2922 100644
--- a/plone/app/upgrade/v50/profiles.zcml
+++ b/plone/app/upgrade/v50/profiles.zcml
@@ -92,4 +92,14 @@
       for="Products.CMFPlone.interfaces.IMigratingPloneSiteRoot"
       provides="Products.GenericSetup.interfaces.EXTENSION"
       />
+
+  <genericsetup:registerProfile
+      name="to501"
+      title="Upgrade profile for Plone 5.0 to Plone 5.0.1"
+      description=""
+      directory="profiles/to_501"
+      for="Products.CMFPlone.interfaces.IMigratingPloneSiteRoot"
+      provides="Products.GenericSetup.interfaces.EXTENSION"
+      />
+
 </configure>
diff --git a/plone/app/upgrade/v50/profiles/to_501/registry.xml b/plone/app/upgrade/v50/profiles/to_501/registry.xml
new file mode 100644
index 0000000..fbf1e09
--- /dev/null
+++ b/plone/app/upgrade/v50/profiles/to_501/registry.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0"?>
+<registry>
+  <records prefix="plone.resources/mockup-patterns-base"
+            interface='Products.CMFPlone.interfaces.IResourceRegistry'>
+      <value key="js">++plone++mockup/base/pattern.js</value>
+  </records>
+  <records prefix="plone.resources/pat-base"
+            interface='Products.CMFPlone.interfaces.IResourceRegistry'>
+      <value key="js">++plone++static/components/patternslib/src/core/base.js</value>
+  </records>
+  <records prefix="plone.resources/underscore"
+            interface='Products.CMFPlone.interfaces.IResourceRegistry'>
+      <value key="js">++plone++static/components/underscore/underscore.js</value>
+      <value key="export">window._</value>
+  </records>
+  <records prefix="plone.resources/pat-mockup-parser"
+            interface='Products.CMFPlone.interfaces.IResourceRegistry'>
+      <value key="js">++plone++static/components/patternslib/src/core/mockup-parser.js</value>
+  </records>
+</registry>
\ No newline at end of file


