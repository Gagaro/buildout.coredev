Repository: Products.TinyMCE


Branch: refs/heads/1.3.x
Date: 2015-07-09T13:11:51+02:00
Author: Harald Friessnegger (frisi) <harald@webmeisterei.com>
Commit: https://github.com/plone/Products.TinyMCE/commit/b99198485196b6623693283c454c6dbe3c6c640e

improve ui and ux for (image)browser

* use same height for imagebrowser as for the linkbrowser (to not cover the upload button under the content-browser div)
* make icons clickable for better UX

(this fixes #106)

Files changed:
M HISTORY.rst
M Products/TinyMCE/skins/tinymce/plugins/plonebrowser/editor_plugin.js
M Products/TinyMCE/skins/tinymce/plugins/plonebrowser/plonebrowser.htm.pt

diff --git a/HISTORY.rst b/HISTORY.rst
index c532073..5867fea 100644
--- a/HISTORY.rst
+++ b/HISTORY.rst
@@ -5,8 +5,8 @@ HISTORY
 1.3.11 (unreleased)
 -------------------
 
-- Nothing changed yet.
-
+- UI and UX improvements: Do not cover upload button.
+  Clickable icons. (fixes #106) [fRiSi]
 
 1.3.10 (2015-06-26)
 -------------------
diff --git a/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/editor_plugin.js b/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/editor_plugin.js
index d850199..90bc1d7 100644
--- a/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/editor_plugin.js
+++ b/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/editor_plugin.js
@@ -1 +1 @@
-(function(){tinymce.create("tinymce.plugins.PloneBrowserPlugin",{init:function(a,b){a.addCommand("mcePloneImage",function(){var c=a.dom.getAttrib(a.selection.getNode(),"class");if(c&&c.indexOf("mceItem")!==-1){return}a.windowManager.open({file:b+"/plonebrowser.htm?ploneimage=1",width:820+parseInt(a.getLang("plonebrowser.delta_width",0),10),height:500+parseInt(a.getLang("plonebrowser.delta_height",0),10),inline:1},{plugin_url:b})});a.addCommand("mcePloneLink",function(){var c=a.selection;if(c.isCollapsed()&&!a.dom.getParent(c.getNode(),"A")){return}a.windowManager.open({file:b+"/plonebrowser.htm?plonelink=1",width:820+parseInt(a.getLang("plonebrowser.delta_width",0)),height:540+parseInt(a.getLang("plonebrowser.delta_height",0)),inline:1},{plugin_url:b})});a.addButton("image",{title:"advanced.image_desc",cmd:"mcePloneImage"});a.addButton("link",{title:"advanced.link_desc",cmd:"mcePloneLink"});a.addShortcut("ctrl+k","advanced.link_desc","mcePloneLink")},getInfo:function(){return{longname:"Plone browser",author:"Plone Foundation",authorurl:"http://plone.org",infourl:"http://plone.org/products/tinymce",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("plonebrowser",tinymce.plugins.PloneBrowserPlugin)}());
\ No newline at end of file
+(function(){tinymce.create("tinymce.plugins.PloneBrowserPlugin",{init:function(a,b){a.addCommand("mcePloneImage",function(){var c=a.dom.getAttrib(a.selection.getNode(),"class");if(c&&c.indexOf("mceItem")!==-1){return}a.windowManager.open({file:b+"/plonebrowser.htm?ploneimage=1",width:820+parseInt(a.getLang("plonebrowser.delta_width",0),10),height:540+parseInt(a.getLang("plonebrowser.delta_height",0),10),inline:1},{plugin_url:b})});a.addCommand("mcePloneLink",function(){var c=a.selection;if(c.isCollapsed()&&!a.dom.getParent(c.getNode(),"A")){return}a.windowManager.open({file:b+"/plonebrowser.htm?plonelink=1",width:820+parseInt(a.getLang("plonebrowser.delta_width",0)),height:540+parseInt(a.getLang("plonebrowser.delta_height",0)),inline:1},{plugin_url:b})});a.addButton("image",{title:"advanced.image_desc",cmd:"mcePloneImage"});a.addButton("link",{title:"advanced.link_desc",cmd:"mcePloneLink"});a.addShortcut("ctrl+k","advanced.link_desc","mcePloneLink")},getInfo:function(){return{longname:"Plone browser",author:"Plone Foundation",authorurl:"http://plone.org",infourl:"http://plone.org/products/tinymce",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("plonebrowser",tinymce.plugins.PloneBrowserPlugin)}());
\ No newline at end of file
diff --git a/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/plonebrowser.htm.pt b/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/plonebrowser.htm.pt
index c26bfb6..1e9e41f 100644
--- a/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/plonebrowser.htm.pt
+++ b/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/plonebrowser.htm.pt
@@ -14,22 +14,26 @@
   <div class="dialog-wrapper icons-on" id="content">
 
         <div id="linktype_panel">
-            <div id="linktype">
+            <div id="linktype" i18n:domain="plone.tinymce">
                 <div id="internal_link" class="current">
-                    <img src="img/internal_link.png" />
-                    <a href="#internal" i18n:translate="" i18n:domain="plone.tinymce">Internal</a>
+                    <a href="#internal">
+                      <img src="img/internal_link.png" />
+                      <span i18n:translate="">Internal</span></a>
                 </div>
                 <div id="external_link">
-                    <img src="img/external_link.png" />
-                    <a href="#external" i18n:translate="" i18n:domain="plone.tinymce">External</a>
+                    <a href="#external">
+                      <img src="img/external_link.png" />
+                      <span i18n:translate="">External</span></a>
                 </div>
                 <div id="email_link">
-                    <img src="img/email_link.png" />
-                    <a href="#email" i18n:translate="" i18n:domain="plone.tinymce">Email</a>
+                    <a href="#email">
+                      <img src="img/email_link.png" />
+                      <span i18n:translate="">Email</span></a>
                 </div>
                 <div id="anchor_link">
-                    <img src="img/anchor_link.png" />
-                    <a href="#anchor" i18n:translate="" i18n:domain="plone.tinymce">Anchor</a>
+                    <a href="#anchor">
+                      <img src="img/anchor_link.png" />
+                      <span i18n:translate="">Anchor</span></a>
                 </div>
             </div>
         </div>
@@ -259,7 +263,7 @@
 
         <div id="footer" class="row">
             <div id="upload-button" class="cell width-3:4 position-0 hide">
-                <img src="img/application_get.png" /> <a id="upload" href="" i18n:translate="" i18n:domain="plone.tinymce">Upload</a>
+                <a id="upload" href=""><img src="img/application_get.png" /> <span i18n:translate="" i18n:domain="plone.tinymce">Upload</span></a>
             </div>
             <div id="action-button" class="cell width-1:4 position-3:4">
                 <input type="submit" id="insert-selection" class="context plonebutton" name="insert-image"


Repository: Products.TinyMCE


Branch: refs/heads/1.3.x
Date: 2015-07-22T16:08:58+02:00
Author: Fred van Dijk (fredvd) <fredvd@gmail.com>
Commit: https://github.com/plone/Products.TinyMCE/commit/fca3319fdcef282cfc30ec5713e11d4140e58629

Merge branch '1.3.x' into improved-browser-issue-106

Files changed:
M HISTORY.rst
M Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js
M README.rst

diff --git a/HISTORY.rst b/HISTORY.rst
index 5867fea..43c247d 100644
--- a/HISTORY.rst
+++ b/HISTORY.rst
@@ -8,6 +8,10 @@ HISTORY
 - UI and UX improvements: Do not cover upload button.
   Clickable icons. (fixes #106) [fRiSi]
 
+- Fixed current image scale in image popups
+  [huubbouma]
+
+
 1.3.10 (2015-06-26)
 -------------------
 
diff --git a/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js b/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js
index f95a9d7..b47ec6d 100644
--- a/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js
+++ b/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js
@@ -349,8 +349,8 @@ BrowserDialog.prototype.init = function () {
             } else {
                 scaled_image = this.parseImageScale(selected_node.attr("src"));
 
-                // Update the dimensions <select> with the corresponding value.
-                jq('#dimensions', document).val(scaled_image.scale);
+                // Store the selected scale on the dimensions <select>.
+                jq('#dimensions', document).data('selectedScale', scaled_image.scale);
 
                 if (scaled_image.url.indexOf('resolveuid/') > -1) {
                     /** Handle UID linked image **/
@@ -739,7 +739,7 @@ BrowserDialog.prototype.setDetails = function (url) {
         'url': url + '/tinymce-jsondetails',
         'dataType': 'json',
         'success': function (data) {
-            var dimension = jq('#dimensions', document).val(),
+            var dimension = jq('#dimensions', document).data('selectedScale'),
                 dimensions,
                 i;
 
diff --git a/README.rst b/README.rst
index 1604735..950fb06 100644
--- a/README.rst
+++ b/README.rst
@@ -1 +1 @@
-Documentation at http://readthedocs.org/docs/productstinymce/
+Documentation at https://productstinymce.readthedocs.org/en/latest/


Repository: Products.TinyMCE


Branch: refs/heads/1.3.x
Date: 2015-07-22T16:13:36+02:00
Author: Fred van Dijk (fredvd) <fredvd@gmail.com>
Commit: https://github.com/plone/Products.TinyMCE/commit/40d82dc0e5a13ba3a73526e7895f8443ebc969b7

Merge branch 'improved-browser-issue-106' into 1.3.x

Files changed:
M HISTORY.rst
M Products/TinyMCE/skins/tinymce/plugins/plonebrowser/editor_plugin.js
M Products/TinyMCE/skins/tinymce/plugins/plonebrowser/plonebrowser.htm.pt

diff --git a/HISTORY.rst b/HISTORY.rst
index 9816132..43c247d 100644
--- a/HISTORY.rst
+++ b/HISTORY.rst
@@ -5,6 +5,9 @@ HISTORY
 1.3.11 (unreleased)
 -------------------
 
+- UI and UX improvements: Do not cover upload button.
+  Clickable icons. (fixes #106) [fRiSi]
+
 - Fixed current image scale in image popups
   [huubbouma]
 
diff --git a/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/editor_plugin.js b/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/editor_plugin.js
index d850199..90bc1d7 100644
--- a/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/editor_plugin.js
+++ b/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/editor_plugin.js
@@ -1 +1 @@
-(function(){tinymce.create("tinymce.plugins.PloneBrowserPlugin",{init:function(a,b){a.addCommand("mcePloneImage",function(){var c=a.dom.getAttrib(a.selection.getNode(),"class");if(c&&c.indexOf("mceItem")!==-1){return}a.windowManager.open({file:b+"/plonebrowser.htm?ploneimage=1",width:820+parseInt(a.getLang("plonebrowser.delta_width",0),10),height:500+parseInt(a.getLang("plonebrowser.delta_height",0),10),inline:1},{plugin_url:b})});a.addCommand("mcePloneLink",function(){var c=a.selection;if(c.isCollapsed()&&!a.dom.getParent(c.getNode(),"A")){return}a.windowManager.open({file:b+"/plonebrowser.htm?plonelink=1",width:820+parseInt(a.getLang("plonebrowser.delta_width",0)),height:540+parseInt(a.getLang("plonebrowser.delta_height",0)),inline:1},{plugin_url:b})});a.addButton("image",{title:"advanced.image_desc",cmd:"mcePloneImage"});a.addButton("link",{title:"advanced.link_desc",cmd:"mcePloneLink"});a.addShortcut("ctrl+k","advanced.link_desc","mcePloneLink")},getInfo:function(){return{longname:"Plone browser",author:"Plone Foundation",authorurl:"http://plone.org",infourl:"http://plone.org/products/tinymce",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("plonebrowser",tinymce.plugins.PloneBrowserPlugin)}());
\ No newline at end of file
+(function(){tinymce.create("tinymce.plugins.PloneBrowserPlugin",{init:function(a,b){a.addCommand("mcePloneImage",function(){var c=a.dom.getAttrib(a.selection.getNode(),"class");if(c&&c.indexOf("mceItem")!==-1){return}a.windowManager.open({file:b+"/plonebrowser.htm?ploneimage=1",width:820+parseInt(a.getLang("plonebrowser.delta_width",0),10),height:540+parseInt(a.getLang("plonebrowser.delta_height",0),10),inline:1},{plugin_url:b})});a.addCommand("mcePloneLink",function(){var c=a.selection;if(c.isCollapsed()&&!a.dom.getParent(c.getNode(),"A")){return}a.windowManager.open({file:b+"/plonebrowser.htm?plonelink=1",width:820+parseInt(a.getLang("plonebrowser.delta_width",0)),height:540+parseInt(a.getLang("plonebrowser.delta_height",0)),inline:1},{plugin_url:b})});a.addButton("image",{title:"advanced.image_desc",cmd:"mcePloneImage"});a.addButton("link",{title:"advanced.link_desc",cmd:"mcePloneLink"});a.addShortcut("ctrl+k","advanced.link_desc","mcePloneLink")},getInfo:function(){return{longname:"Plone browser",author:"Plone Foundation",authorurl:"http://plone.org",infourl:"http://plone.org/products/tinymce",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("plonebrowser",tinymce.plugins.PloneBrowserPlugin)}());
\ No newline at end of file
diff --git a/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/plonebrowser.htm.pt b/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/plonebrowser.htm.pt
index c26bfb6..1e9e41f 100644
--- a/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/plonebrowser.htm.pt
+++ b/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/plonebrowser.htm.pt
@@ -14,22 +14,26 @@
   <div class="dialog-wrapper icons-on" id="content">
 
         <div id="linktype_panel">
-            <div id="linktype">
+            <div id="linktype" i18n:domain="plone.tinymce">
                 <div id="internal_link" class="current">
-                    <img src="img/internal_link.png" />
-                    <a href="#internal" i18n:translate="" i18n:domain="plone.tinymce">Internal</a>
+                    <a href="#internal">
+                      <img src="img/internal_link.png" />
+                      <span i18n:translate="">Internal</span></a>
                 </div>
                 <div id="external_link">
-                    <img src="img/external_link.png" />
-                    <a href="#external" i18n:translate="" i18n:domain="plone.tinymce">External</a>
+                    <a href="#external">
+                      <img src="img/external_link.png" />
+                      <span i18n:translate="">External</span></a>
                 </div>
                 <div id="email_link">
-                    <img src="img/email_link.png" />
-                    <a href="#email" i18n:translate="" i18n:domain="plone.tinymce">Email</a>
+                    <a href="#email">
+                      <img src="img/email_link.png" />
+                      <span i18n:translate="">Email</span></a>
                 </div>
                 <div id="anchor_link">
-                    <img src="img/anchor_link.png" />
-                    <a href="#anchor" i18n:translate="" i18n:domain="plone.tinymce">Anchor</a>
+                    <a href="#anchor">
+                      <img src="img/anchor_link.png" />
+                      <span i18n:translate="">Anchor</span></a>
                 </div>
             </div>
         </div>
@@ -259,7 +263,7 @@
 
         <div id="footer" class="row">
             <div id="upload-button" class="cell width-3:4 position-0 hide">
-                <img src="img/application_get.png" /> <a id="upload" href="" i18n:translate="" i18n:domain="plone.tinymce">Upload</a>
+                <a id="upload" href=""><img src="img/application_get.png" /> <span i18n:translate="" i18n:domain="plone.tinymce">Upload</span></a>
             </div>
             <div id="action-button" class="cell width-1:4 position-3:4">
                 <input type="submit" id="insert-selection" class="context plonebutton" name="insert-image"


