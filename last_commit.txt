Repository: plone.app.contenttypes
Branch: refs/heads/master
Date: 2015-04-07T10:25:05+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.contenttypes/commit/9186b110e3b4258b00eff69ad1e1c89b0ab0dcdf

fix test by publishing links before accessing as anonymous

Files changed:
M plone/app/contenttypes/tests/test_link.py

diff --git a/plone/app/contenttypes/tests/test_link.py b/plone/app/contenttypes/tests/test_link.py
index 729b414..8a9ee45 100644
--- a/plone/app/contenttypes/tests/test_link.py
+++ b/plone/app/contenttypes/tests/test_link.py
@@ -157,7 +157,7 @@ def test_link_redirect_view_path_with_variable(self):
     def test_mailto_type(self):
         self.link.remoteUrl = 'mailto:stress@test.us'
         view = self._get_link_redirect_view(self.link)
-
+        self._publish(self.link)
         logout()
         rendered = view()
         self.assertTrue('href="mailto:stress@test.us"' in rendered)
@@ -166,7 +166,7 @@ def test_mailto_type(self):
     def test_tel_type(self):
         self.link.remoteUrl = 'tel:123'
         view = self._get_link_redirect_view(self.link)
-
+        self._publish(self.link)
         logout()
         rendered = view()
         self.assertTrue('href="tel:123"' in rendered)
@@ -175,7 +175,7 @@ def test_tel_type(self):
     def test_callto_type(self):
         self.link.remoteUrl = 'callto:123'
         view = self._get_link_redirect_view(self.link)
-
+        self._publish(self.link)
         logout()
         rendered = view()
         self.assertTrue('href="callto:123"' in rendered)
@@ -184,7 +184,7 @@ def test_callto_type(self):
     def test_webdav_type(self):
         self.link.remoteUrl = 'webdav://web.site/resource'
         view = self._get_link_redirect_view(self.link)
-
+        self._publish(self.link)
         logout()
         rendered = view()
         self.assertTrue('href="webdav://web.site/resource"' in rendered)
@@ -193,7 +193,7 @@ def test_webdav_type(self):
     def test_caldav_type(self):
         self.link.remoteUrl = 'caldav://calendar.site/resource'
         view = self._get_link_redirect_view(self.link)
-
+        self._publish(self.link)
         logout()
         rendered = view()
         self.assertTrue('href="caldav://calendar.site/resource"' in rendered)
@@ -202,7 +202,7 @@ def test_caldav_type(self):
     def test_file_type(self):
         self.link.remoteUrl = 'file:///some/file/on/your/system'
         view = self._get_link_redirect_view(self.link)
-
+        self._publish(self.link)
         logout()
         self.assertTrue(view())
         self._assert_redirect(self.link.remoteUrl)
@@ -212,7 +212,7 @@ def test_ftp_type(self):
             datetime.now().isoformat()
         )
         view = self._get_link_redirect_view(self.link)
-
+        self._publish(self.link)
         logout()
         self.assertTrue(view())
         self._assert_redirect(self.link.remoteUrl)


