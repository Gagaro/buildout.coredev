Repository: Products.CMFPlone
Branch: refs/heads/master
Date: 2014-12-12T18:38:47+01:00
Author: Timo Stollenwerk (tisto) <tisto@plone.org>
Commit: https://github.com/plone/Products.CMFPlone/commit/22d1c539e35b96a749227824f50c2718e75ed12f

Remove ValidMailhostLayer to see if that fixes the deadlock on Jenkins.

Files changed:
M Products/CMFPlone/testing.py

diff --git a/Products/CMFPlone/testing.py b/Products/CMFPlone/testing.py
index 6e7036f..75ca890 100644
--- a/Products/CMFPlone/testing.py
+++ b/Products/CMFPlone/testing.py
@@ -52,21 +52,8 @@ def tearDownPloneSite(self, portal):
         portal.manage_delObjects(['test-folder'])
 
 
-# XXX: This should probably go into plone.app.robotframework (@tisto).
-class ValidMailhostLayer(PloneSandboxLayer):
-
-    defaultBases = (PLONE_FIXTURE,)
-
-    def setUpPloneSite(self, portal):
-        registry = getUtility(IRegistry)
-        mail_settings = registry.forInterface(IMailSchema, prefix='plone')
-        mail_settings.smtp_host = u'localhost'
-        mail_settings.email_from_address = 'john@doe.com'
-
-
 PRODUCTS_CMFPLONE_FIXTURE = ProductsCMFPloneLayer()
 
-PRODUCTS_CMFPLONE_VALID_MAILHOST_FIXTURE = ValidMailhostLayer()
 PRODUCTS_CMFPLONE_INTEGRATION_TESTING = IntegrationTesting(
     bases=(PRODUCTS_CMFPLONE_FIXTURE,),
     name="CMFPloneLayer:Integration"
@@ -87,7 +74,6 @@ def setUpPloneSite(self, portal):
 PRODUCTS_CMFPLONE_ROBOT_TESTING = FunctionalTesting(
     bases=(
         PRODUCTS_CMFPLONE_FIXTURE,
-        PRODUCTS_CMFPLONE_VALID_MAILHOST_FIXTURE,
         PRODUCTS_CMFPLONE_ROBOT_REMOTE_LIBRARY_FIXTURE,
         z2.ZSERVER_FIXTURE
     ),


