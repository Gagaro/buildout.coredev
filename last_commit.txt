Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2015-10-15T09:38:44-05:00
Author: vangheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/2fe5643ac86ef08eb256401ab3cdff6d63560904

fix "contains object" tinymce setting not getting passed into pattern
  correctly fixes https://github.com/plone/Products.CMFPlone/issues/1023

Files changed:
M CHANGES.rst
M Products/CMFPlone/patterns/__init__.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 85f1bf0..71d7442 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -8,6 +8,10 @@ Changelog
 5.0.1 (unreleased)
 ------------------
 
+- fix "contains object" tinymce setting not getting passed into pattern
+  correctly Fixes #1023
+  [vangheem]
+
 - compress generated bundle css file when running plone-compile-resource
   [petschki]
 
diff --git a/Products/CMFPlone/patterns/__init__.py b/Products/CMFPlone/patterns/__init__.py
index c0466b4..82aa671 100644
--- a/Products/CMFPlone/patterns/__init__.py
+++ b/Products/CMFPlone/patterns/__init__.py
@@ -236,7 +236,8 @@ def tinymce(self):
             'relatedItems': {
                 'vocabularyUrl':
                     '%s/@@getVocabulary?name=plone.app.vocabularies.Catalog' % (
-                        generator.portal_url)
+                        generator.portal_url),
+                'folderTypes': folder_types
             },
             'upload': {
                 'initialFolder': initial,
@@ -254,7 +255,6 @@ def tinymce(self):
             'prependToUrl': '{0}/resolveuid/'.format(generator.portal_url),
             'linkAttribute': 'UID',
             'prependToScalePart': '/@@images/image/',
-            'folderTypes': folder_types,
             'imageTypes': image_types
             # 'anchorSelector': utility.anchor_selector,
         }


