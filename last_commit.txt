Repository: plone.resourceeditor
Branch: refs/heads/master
Date: 2015-03-19T14:03:28-05:00
Author: Sam Schwartz (obct537) <obct537@gmail.com>
Commit: https://github.com/plone/plone.resourceeditor/commit/acc6737eccdeab7efec0db2aa05e84e00a125bd3

Fixed FileManagerActions improperly handling image requests

Files changed:
M plone/resourceeditor/browser.py

diff --git a/plone/resourceeditor/browser.py b/plone/resourceeditor/browser.py
index 815103f..3ab7cac 100644
--- a/plone/resourceeditor/browser.py
+++ b/plone/resourceeditor/browser.py
@@ -36,7 +36,8 @@ def validateFilename(name):
 
 class FileManagerActions(BrowserView):
 
-    imageExtensions = ['png', 'gif', 'jpg', 'jpeg']
+    imageExtensions = ['png', 'gif', 'jpg', 'jpeg', 'ico']
+    previewTemplate = ViewPageTemplateFile('preview.pt')
 
     @property.Lazy
     def resourceDirectory(self):
@@ -71,7 +72,9 @@ def getFile(self, path):
                 data = data.read()
             result['contents'] = str(data)
         else:
-            info = self.getInfo(path)
+            obj = self.getObject(path)
+            info = self.getInfo(obj)
+            info['preview'] = info['filename']
             result['info'] = self.previewTemplate(info=info)
 
         self.request.response.setHeader('Content-Type', 'application/json')


Repository: plone.resourceeditor
Branch: refs/heads/master
Date: 2015-03-19T14:18:15-05:00
Author: Sam Schwartz (obct537) <obct537@gmail.com>
Commit: https://github.com/plone/plone.resourceeditor/commit/07438e63409c9bc87f47668543a0c008cbdced6d

Changed FileActionManager image preview source

Files changed:
M plone/resourceeditor/browser.py

diff --git a/plone/resourceeditor/browser.py b/plone/resourceeditor/browser.py
index 3ab7cac..bd80877 100644
--- a/plone/resourceeditor/browser.py
+++ b/plone/resourceeditor/browser.py
@@ -74,7 +74,7 @@ def getFile(self, path):
         else:
             obj = self.getObject(path)
             info = self.getInfo(obj)
-            info['preview'] = info['filename']
+            info['preview'] = path
             result['info'] = self.previewTemplate(info=info)
 
         self.request.response.setHeader('Content-Type', 'application/json')


Repository: plone.resourceeditor
Branch: refs/heads/master
Date: 2015-03-19T15:01:11-05:00
Author: Nathan Van Gheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/plone.resourceeditor/commit/114f68a1bbecbb7b737c624d1768578ae09370a8

Merge pull request #6 from plone/image_resources

Image resources

Files changed:
M plone/resourceeditor/browser.py

diff --git a/plone/resourceeditor/browser.py b/plone/resourceeditor/browser.py
index 815103f..bd80877 100644
--- a/plone/resourceeditor/browser.py
+++ b/plone/resourceeditor/browser.py
@@ -36,7 +36,8 @@ def validateFilename(name):
 
 class FileManagerActions(BrowserView):
 
-    imageExtensions = ['png', 'gif', 'jpg', 'jpeg']
+    imageExtensions = ['png', 'gif', 'jpg', 'jpeg', 'ico']
+    previewTemplate = ViewPageTemplateFile('preview.pt')
 
     @property.Lazy
     def resourceDirectory(self):
@@ -71,7 +72,9 @@ def getFile(self, path):
                 data = data.read()
             result['contents'] = str(data)
         else:
-            info = self.getInfo(path)
+            obj = self.getObject(path)
+            info = self.getInfo(obj)
+            info['preview'] = path
             result['info'] = self.previewTemplate(info=info)
 
         self.request.response.setHeader('Content-Type', 'application/json')


