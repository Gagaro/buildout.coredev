Repository: plone.app.contenttypes
Branch: refs/heads/master
Date: 2015-01-06T14:12:11+01:00
Author: Johannes Raggam (thet) <raggam-nl@adm.at>
Commit: https://github.com/plone/plone.app.contenttypes/commit/9299684ecc70fa4fce1e3f7f3d12c7904f8f8b87

fix test which failed with jensens plone.dexterity fixes from 2.3.0-dev0. the ICollection behavior schema defines default values for customViewFields, which were not applied in the tests. jensens dexterity fixes fixes that, hence the updated test

Files changed:
M plone/app/contenttypes/tests/test_collection.py
M setup.py

diff --git a/plone/app/contenttypes/tests/test_collection.py b/plone/app/contenttypes/tests/test_collection.py
index 3efdf42..f2b95cd 100644
--- a/plone/app/contenttypes/tests/test_collection.py
+++ b/plone/app/contenttypes/tests/test_collection.py
@@ -65,7 +65,11 @@ def test_results(self):
         pass
 
     def test_bbb_selectedViewFields(self):
-        self.assertEqual(self.collection.selectedViewFields(), [])
+        self.assertEqual(
+            self.collection.selectedViewFields(),
+            [('Title', 'Title'), ('Creator', 'Creator'),
+             ('Type', 'Type'), ('ModificationDate', 'ModificationDate')]
+        )
         self.collection.customViewFields = ['Title', 'Description']
         self.assertEqual(self.collection.selectedViewFields(),
                          [('Title', 'Title'), ('Description', 'Description')])
diff --git a/setup.py b/setup.py
index 40369bb..2f803eb 100644
--- a/setup.py
+++ b/setup.py
@@ -54,6 +54,7 @@ def read(*rnames):
               'lxml',
               'plone.app.robotframework',
               'plone.app.testing [robot] >= 4.2.4',  # we need ROBOT_TEST_LEVEL
+              # 'plone.dexterity >= 2.3.0',  # fixes setting default values # NOT RELEASED YET. # noqa
               'Products.ATContentTypes',
               'Products.contentmigration >= 2.1.8.dev0',
           ],


