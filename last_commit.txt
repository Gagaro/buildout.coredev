Repository: plone.app.controlpanel


Branch: refs/heads/2.3.x
Date: 2015-09-15T23:57:54+02:00
Author: jnachtigall (jnachtigall) <nachtigall@web.de>
Commit: https://github.com/plone/plone.app.controlpanel/commit/9c24fee660f8fa9a764f798912085f413efdc145

add text-decoration to allowed css style attributes @@filter-controlpanel

By default, TinyMCE allows strike-through editing (next to bold and italic). This done with "text-decoration: line-through;". However, as soon as you save the edit, this is lost due to the very restricted html filters of plone. filters should be in sync with TinyMCE

Files changed:
M plone/app/controlpanel/filter.py

diff --git a/plone/app/controlpanel/filter.py b/plone/app/controlpanel/filter.py
index 4770f39..8b9abff 100644
--- a/plone/app/controlpanel/filter.py
+++ b/plone/app/controlpanel/filter.py
@@ -85,7 +85,7 @@ class IFilterEditorSchema(Interface):
     style_whitelist = schema.List(
         title=_(u'Permitted properties'),
         description=_(u'These CSS properties are allowed in style attributes.'),
-        default=u'text-align list-style-type float'.split(),
+        default=u'text-align list-style-type float text-decoration'.split(),
         value_type=schema.TextLine(),
         required=False)
 


Repository: plone.app.controlpanel


Branch: refs/heads/2.3.x
Date: 2015-09-16T00:01:26+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.controlpanel/commit/4df2608bbc5c039063074d1c375305671d6d09b4

Fixed filter test for allowed text-decoration.

This was added in PortalTransforms for Plone 5,
causing test failure on Plone 4,
but seems fine to support this on Plone 4 too.

Files changed:
M plone/app/controlpanel/tests/filter.txt

diff --git a/plone/app/controlpanel/tests/filter.txt b/plone/app/controlpanel/tests/filter.txt
index 52bca0d..34f1389 100644
--- a/plone/app/controlpanel/tests/filter.txt
+++ b/plone/app/controlpanel/tests/filter.txt
@@ -103,6 +103,7 @@ Look at the defaults
     list-style-type
     float
     padding-left
+    text-decoration
     >>> print_all_of('class_whitelist')
 
 Changing some values
@@ -136,6 +137,7 @@ Changing a permitted style:
     list-style-type
     color
     padding-left
+    text-decoration
 
 Check that the filtering works
 ------------------------------


Repository: plone.app.controlpanel


Branch: refs/heads/2.3.x
Date: 2015-09-16T00:03:25+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.controlpanel/commit/87e6d242ad39a4598b283fb06954f8a3a3af02a2

Added changelog.

Files changed:
M CHANGES.txt

diff --git a/CHANGES.txt b/CHANGES.txt
index dbae6e5..d986c9a 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -4,7 +4,9 @@ Changelog
 2.3.9 (unreleased)
 ------------------
 
-- Nothing changed yet.
+- Added ``text-decoration`` to allowed css style attributes in
+  ``@@filter-controlpanel``.  Change backported from master.
+  [jnachtigall, vangheem, maurits]
 
 
 2.3.8 (2013-12-07)


