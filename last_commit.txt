Repository: Products.CMFPlone
Branch: refs/heads/master
Date: 2015-04-26T05:28:25Z
Author: T. Kim Nguyen (tkimnguyen) <tknguyen@mac.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/65e5d4b3c6f5a4f4e7dd70a797d07d3d79d0d1a4

fix https://github.com/plone/Products.CMFPlone/issues/412 error sending test email

Files changed:
M CHANGES.rst
M Products/CMFPlone/controlpanel/browser/mail.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 02f2918..382d49d 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -8,6 +8,9 @@ Changelog
 5.0b2 (unreleased)
 ------------------
 
+- fix error sending test email in Mail control panel
+  [tkimnguyen]
+
 - pat-modal pattern has been renamed to pat-plone-modal
   [jcbrand]
 
diff --git a/Products/CMFPlone/controlpanel/browser/mail.py b/Products/CMFPlone/controlpanel/browser/mail.py
index da996d8..e9b4a5e 100644
--- a/Products/CMFPlone/controlpanel/browser/mail.py
+++ b/Products/CMFPlone/controlpanel/browser/mail.py
@@ -73,7 +73,7 @@ def handle_test_action(self, action):
             try:
                 mailhost.send(message,
                               mto=fromaddr,
-                              mfrom=fromname,
+                              mfrom=fromaddr,
                               subject=subject,
                               charset=email_charset,
                               immediate=True)


