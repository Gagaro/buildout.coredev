Repository: plone.app.contentmenu


Branch: refs/heads/master
Date: 2015-07-26T00:33:00-05:00
Author: vangheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/plone.app.contentmenu/commit/a32e1294c5611b03dc7f16b93e7aa97eeff5f266

do not open manage portlets in a modal

Files changed:
M CHANGES.rst
M plone/app/contentmenu/menu.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 876e0d9..b26d5b8 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,7 +4,8 @@ Changelog
 2.1.6 (unreleased)
 ------------------
 
-- Nothing changed yet.
+- do not open manage portlets in a modal
+  [vangheem]
 
 
 2.1.5 (2015-07-18)
diff --git a/plone/app/contentmenu/menu.py b/plone/app/contentmenu/menu.py
index 580041a..ecb08fb 100644
--- a/plone/app/contentmenu/menu.py
+++ b/plone/app/contentmenu/menu.py
@@ -897,18 +897,16 @@ def getMenuItems(self, context, request):
             item = {
                 'title': ' '.join(manager_name.split('.')).title(),
                 'description': ' '.join(manager_name.split('.')).title(),
-                'action': addTokenToUrl(utils.ajax_load_url(
+                'action': addTokenToUrl(
                     '%s/@@topbar-manage-portlets/%s' % (
                         current_url,
-                        manager_name)
-                    ),
+                        manager_name),
                     request),
                 'selected': False,
                 'icon': None,
                 'extra': {
                     'id': 'portlet-manager-%s' % manager_name,
-                    'separator': None,
-                    'class': 'pat-plone-modal'},
+                    'separator': None},
                 'submenu': None,
             }
 


Repository: plone.app.contentmenu


Branch: refs/heads/master
Date: 2015-07-26T01:34:32-05:00
Author: vangheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/plone.app.contentmenu/commit/d98874cf3697dc63ac699ef257d5e7f7823a5362

portlets do not use ajax

Files changed:
M plone/app/contentmenu/tests/test_menu.py

diff --git a/plone/app/contentmenu/tests/test_menu.py b/plone/app/contentmenu/tests/test_menu.py
index 3895a5c..59a2844 100644
--- a/plone/app/contentmenu/tests/test_menu.py
+++ b/plone/app/contentmenu/tests/test_menu.py
@@ -635,7 +635,7 @@ def testMenuIncludesActions(self):
                       [a['extra']['id'] for a in actions])
         self.assertIn(
             ('http://nohost/plone/folder/doc1'
-             '/@@topbar-manage-portlets/plone.leftcolumn?ajax_load=1'),
+             '/@@topbar-manage-portlets/plone.leftcolumn'),
             [a['action'] for a in actions][1]
         )
 


Repository: plone.app.contentmenu


Branch: refs/heads/master
Date: 2015-07-26T08:00:22-05:00
Author: Nathan Van Gheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/plone.app.contentmenu/commit/290c57d6ceaceaaba7398519e54c91e03e99559c

Merge pull request #11 from plone/portlets-no-modal

do not open manage portlets in a modal

Files changed:
M CHANGES.rst
M plone/app/contentmenu/menu.py
M plone/app/contentmenu/tests/test_menu.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 876e0d9..b26d5b8 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,7 +4,8 @@ Changelog
 2.1.6 (unreleased)
 ------------------
 
-- Nothing changed yet.
+- do not open manage portlets in a modal
+  [vangheem]
 
 
 2.1.5 (2015-07-18)
diff --git a/plone/app/contentmenu/menu.py b/plone/app/contentmenu/menu.py
index 580041a..ecb08fb 100644
--- a/plone/app/contentmenu/menu.py
+++ b/plone/app/contentmenu/menu.py
@@ -897,18 +897,16 @@ def getMenuItems(self, context, request):
             item = {
                 'title': ' '.join(manager_name.split('.')).title(),
                 'description': ' '.join(manager_name.split('.')).title(),
-                'action': addTokenToUrl(utils.ajax_load_url(
+                'action': addTokenToUrl(
                     '%s/@@topbar-manage-portlets/%s' % (
                         current_url,
-                        manager_name)
-                    ),
+                        manager_name),
                     request),
                 'selected': False,
                 'icon': None,
                 'extra': {
                     'id': 'portlet-manager-%s' % manager_name,
-                    'separator': None,
-                    'class': 'pat-plone-modal'},
+                    'separator': None},
                 'submenu': None,
             }
 
diff --git a/plone/app/contentmenu/tests/test_menu.py b/plone/app/contentmenu/tests/test_menu.py
index 3895a5c..59a2844 100644
--- a/plone/app/contentmenu/tests/test_menu.py
+++ b/plone/app/contentmenu/tests/test_menu.py
@@ -635,7 +635,7 @@ def testMenuIncludesActions(self):
                       [a['extra']['id'] for a in actions])
         self.assertIn(
             ('http://nohost/plone/folder/doc1'
-             '/@@topbar-manage-portlets/plone.leftcolumn?ajax_load=1'),
+             '/@@topbar-manage-portlets/plone.leftcolumn'),
             [a['action'] for a in actions][1]
         )
 


