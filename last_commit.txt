Repository: plone.schemaeditor
Branch: refs/heads/master
Date: 2015-05-13T15:09:51+02:00
Author: Eric BREHAULT (ebrehault) <ebrehault@gmail.com>
Commit: https://github.com/plone/plone.schemaeditor/commit/a6dd2002f9cc433f7df0ed09506219a0b6010a75

delete method mustn't return html (it produces a plone.protect warning)

changelog

Files changed:
M CHANGES.rst
M plone/schemaeditor/browser/field/order.py

diff --git a/CHANGES.rst b/CHANGES.rst
index cc5a665..ae7c8c9 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,7 +4,11 @@ Changelog
 2.0.4 (unreleased)
 ------------------
 
-- Nothing changed yet.
+- Allow to hide the 'Save defaults' button
+  [ebrehault]
+
+- Fix delete method (it used to return html and it produced a plone.protect warning)
+  [ebrehault]
 
 
 2.0.3 (2015-05-04)
diff --git a/plone/schemaeditor/browser/field/order.py b/plone/schemaeditor/browser/field/order.py
index a8119c9..78187d3 100644
--- a/plone/schemaeditor/browser/field/order.py
+++ b/plone/schemaeditor/browser/field/order.py
@@ -53,4 +53,4 @@ def delete(self):
         schema.removeField(self.field.getName())
         notify(ObjectRemovedEvent(self.field, self.schema))
         notify(FieldRemovedEvent(self.aq_parent.aq_parent, self.field))
-        self.request.response.setHeader('Content-Type', 'text/html')
+        self.request.response.setHeader('Content-Type', 'application/json')


