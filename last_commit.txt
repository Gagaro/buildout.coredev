Repository: plone.portlet.collection


Branch: refs/heads/master
Date: 2015-09-02T08:35:07+02:00
Author: Timo Stollenwerk (tisto) <tisto@plone.org>
Commit: https://github.com/plone/plone.portlet.collection/commit/373504a89cc0d8a54bd61a953f3b3c41ddbd1ed6

Fix show_dates test to actually test for a real date. It is not enough to test for the span to be present.

Files changed:
M plone/portlet/collection/tests/functional.txt

diff --git a/plone/portlet/collection/tests/functional.txt b/plone/portlet/collection/tests/functional.txt
index 7676db7..c56ca72 100644
--- a/plone/portlet/collection/tests/functional.txt
+++ b/plone/portlet/collection/tests/functional.txt
@@ -131,7 +131,7 @@ Now test what happens if we toggle the "show dates" option.
     >>> browser.getLink(url="http://nohost/plone/++contextportlets++plone.leftcolumn/test-collection/edit?referer=http%3A//nohost/plone/%40%40manage-portlets").click()
     >>> re.search('<h1\s+class="documentFirstHeading"\s*>\s*Edit Collection Portlet\s*</h1>', browser.contents) is not None
     True
-    >>> browser.getControl(label="Show dates").selected = True
+    >>> browser.getControl("Show dates").selected = True
     >>> browser.getControl("Save").click()
     >>> print browser.url
     http://nohost/plone/@@manage-portlets
@@ -141,3 +141,8 @@ Make sure the dates show up::
     >>> browser.open(portal_url)
     >>> '<span class="portletItemDetails">' in browser.contents
     True
+
+    >>> from DateTime import DateTime
+    >>> cur_year = DateTime().year()
+    >>> re.search('<span class="portletItemDetails">.*{}.*</span>'.format(cur_year), browser.contents) is not None
+    True


