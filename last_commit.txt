Repository: plone.tiles
Branch: refs/heads/master
Date: 2015-04-29T20:43:11+03:00
Author: Asko Soukka (datakurre) <asko.soukka@iki.fi>
Commit: https://github.com/plone/plone.tiles/commit/94168d8d58cbc7c650bb86ce96bb53bc27c619c2

Fix issue where non-ascii characters in tiledata raised UnicodeEncode/DecodeErrors

Files changed:
M plone/tiles/data.py

diff --git a/plone/tiles/data.py b/plone/tiles/data.py
index a3da13d..db940c8 100644
--- a/plone/tiles/data.py
+++ b/plone/tiles/data.py
@@ -144,6 +144,8 @@ def encode(data, schema, ignore=()):
         value = data[name]
         if value is None:
             continue
+        elif isinstance(value, unicode):
+            value = value.encode('utf-8')
 
         if ISequence.providedBy(field):
             value_type_converter = IFieldTypeConverter(field.value_type, None)
@@ -200,6 +202,8 @@ def decode(data, schema, missing=True):
         value = data[name]
         if value is None:
             continue
+        if isinstance(value, str):
+            value = unicode(value, 'utf-8')
 
         field_type = field._type
         if isinstance(field_type, (tuple, list,)):


Repository: plone.tiles
Branch: refs/heads/master
Date: 2015-04-29T20:43:31+03:00
Author: Asko Soukka (datakurre) <asko.soukka@iki.fi>
Commit: https://github.com/plone/plone.tiles/commit/6d2aab774c7ee1d52e629321d56ef274e729daeb

Update changelog

Files changed:
M CHANGELOG.rst

diff --git a/CHANGELOG.rst b/CHANGELOG.rst
index a894ee8..51eff62 100644
--- a/CHANGELOG.rst
+++ b/CHANGELOG.rst
@@ -4,8 +4,8 @@ Changelog
 1.3.1 (unreleased)
 ------------------
 
-- Nothing changed yet.
-
+- Fix issue where non-ascii characters in tiledata raised UnicodeEncode/DecodeErrors
+  [datakurre]
 
 1.3.0 (2015-04-21)
 ------------------


