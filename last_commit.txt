Repository: mockup
Branch: refs/heads/master
Date: 2015-04-09T21:36:28+02:00
Author: Eric BREHAULT (ebrehault) <ebrehault@gmail.com>
Commit: https://github.com/plone/mockup/commit/e699012f897b9c7cdbe494c918900da079029ca7

Fix #474 Cmd+S/Ctrl+S saves the current file

Files changed:
M mockup/patterns/filemanager/pattern.js

diff --git a/mockup/patterns/filemanager/pattern.js b/mockup/patterns/filemanager/pattern.js
index 5616b5d..4b4ad63 100644
--- a/mockup/patterns/filemanager/pattern.js
+++ b/mockup/patterns/filemanager/pattern.js
@@ -219,7 +219,7 @@ define([
         ]
       });
 
-      self.saveBtn.on('button:click', function(e) {
+      self._save = function() {
         self.doAction('saveFile', {
           type: 'POST',
           data: {
@@ -231,6 +231,10 @@ define([
             $('[data-path="'+self.getNodePath()+'"]').removeClass("modified");
           }
         });
+      };
+
+      self.saveBtn.on('button:click', function(e) {
+        self._save();
       });
       self.render();
     },
@@ -353,6 +357,16 @@ define([
           $('[data-path="'+path+'"]').addClass("modified");
         }
       });
+      self.ace.editor.commands.addCommand({
+        name: 'saveFile',
+        bindKey: {
+          win: 'Ctrl-S', mac: 'Command-S',
+          sender: 'editor|cli'
+        },
+        exec: function (env, args, request) {
+          self._save();
+        }
+      });
     },
     getSelectedNode: function() {
       return this.$tree.tree('getSelectedNode');


