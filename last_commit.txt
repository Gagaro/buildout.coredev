Repository: plone.scale
Branch: refs/heads/master
Date: 2015-03-05T06:11:03+05:30
Author: sureshvv (sureshvv) <sureshvv@hotmail.com>
Commit: https://github.com/plone/plone.scale/commit/cb12eb2e067f60439558e4b36d64c2320fb9549e

PIL thumbnail does not magnify image

If we are scaling up, we cannot use thumbnail to magnify image. We need to use resize.

Files changed:
M plone/scale/scale.py

diff --git a/plone/scale/scale.py b/plone/scale/scale.py
index 2ff5d87..c089e01 100644
--- a/plone/scale/scale.py
+++ b/plone/scale/scale.py
@@ -115,7 +115,10 @@ def scalePILImage(image, width=None, height=None, direction="down"):
     if scale_height == scale_width or direction == "thumbnail":
         # The original already has the right aspect ratio, so we only need
         # to scale.
-        image.thumbnail((width, height), PIL.Image.ANTIALIAS)
+        if direction == "down":
+            image.thumbnail((width, height), PIL.Image.ANTIALIAS)
+        else:
+            image = image.resize((width, height), PIL.Image.ANTIALIAS)
     else:
         if direction == "down":
             if scale_height is None or (


Repository: plone.scale
Branch: refs/heads/master
Date: 2015-03-05T06:13:13+05:30
Author: sureshvv (sureshvv) <sureshvv@hotmail.com>
Commit: https://github.com/plone/plone.scale/commit/f31393398fe018d9d73fd5e1a3c4bc2e35ce0c7b

Update changes.rst

Files changed:
M docs/changes.rst

diff --git a/docs/changes.rst b/docs/changes.rst
index 7a7df3d..1b10ee8 100644
--- a/docs/changes.rst
+++ b/docs/changes.rst
@@ -5,7 +5,8 @@ Changelog
 1.3.5 (unreleased)
 ------------------
 
-- Nothing changed yet.
+- PIL thumbnail does not work for magnifying images (when scaling up).
+  Use resize instead. [sureshvv]
 
 
 1.3.4 (2014-09-07)


Repository: plone.scale
Branch: refs/heads/master
Date: 2015-03-06T16:50:47+05:30
Author: Suresh V () <suresh-varsha.vaidyanathan@vnc.biz>
Commit: https://github.com/plone/plone.scale/commit/8d15fcc0c19f14fc4219599fa7cf31c54fecc5eb

Bug fix with test.

Files changed:
M plone/scale/scale.py
M plone/scale/tests/test_scale.py

diff --git a/plone/scale/scale.py b/plone/scale/scale.py
index c089e01..9094657 100644
--- a/plone/scale/scale.py
+++ b/plone/scale/scale.py
@@ -115,7 +115,7 @@ def scalePILImage(image, width=None, height=None, direction="down"):
     if scale_height == scale_width or direction == "thumbnail":
         # The original already has the right aspect ratio, so we only need
         # to scale.
-        if direction == "down":
+        if direction in ("down", "thumbnail"):
             image.thumbnail((width, height), PIL.Image.ANTIALIAS)
         else:
             image = image.resize((width, height), PIL.Image.ANTIALIAS)
diff --git a/plone/scale/tests/test_scale.py b/plone/scale/tests/test_scale.py
index 9e3f585..19dd3ba 100644
--- a/plone/scale/tests/test_scale.py
+++ b/plone/scale/tests/test_scale.py
@@ -53,6 +53,9 @@ def testRestrictHeightOnlyDownScale(self):
     def testSameSizeUpScale(self):
         self.assertEqual(scaleImage(PNG, 84, 103, "up")[2], (84, 103))
 
+    def testDoubleSizeUpScale(self):
+        self.assertEqual(scaleImage(PNG, 168, 206, "up")[2], (168, 206))
+
     def testHalfSizeUpScale(self):
         self.assertEqual(scaleImage(PNG, 42, 51, "up")[2], (42, 51))
 


Repository: plone.scale
Branch: refs/heads/master
Date: 2015-03-06T16:53:24+05:30
Author: sureshvv (sureshvv) <sureshvv@hotmail.com>
Commit: https://github.com/plone/plone.scale/commit/bb994d690b0b50b552de023bf1cec8f6b3d4c089

Merge pull request #5 from sureshvv/master

Bug fix. Image thumbnail cannot be used to scale up.

Files changed:
M docs/changes.rst
M plone/scale/scale.py
M plone/scale/tests/test_scale.py

diff --git a/docs/changes.rst b/docs/changes.rst
index 7a7df3d..1b10ee8 100644
--- a/docs/changes.rst
+++ b/docs/changes.rst
@@ -5,7 +5,8 @@ Changelog
 1.3.5 (unreleased)
 ------------------
 
-- Nothing changed yet.
+- PIL thumbnail does not work for magnifying images (when scaling up).
+  Use resize instead. [sureshvv]
 
 
 1.3.4 (2014-09-07)
diff --git a/plone/scale/scale.py b/plone/scale/scale.py
index 2ff5d87..9094657 100644
--- a/plone/scale/scale.py
+++ b/plone/scale/scale.py
@@ -115,7 +115,10 @@ def scalePILImage(image, width=None, height=None, direction="down"):
     if scale_height == scale_width or direction == "thumbnail":
         # The original already has the right aspect ratio, so we only need
         # to scale.
-        image.thumbnail((width, height), PIL.Image.ANTIALIAS)
+        if direction in ("down", "thumbnail"):
+            image.thumbnail((width, height), PIL.Image.ANTIALIAS)
+        else:
+            image = image.resize((width, height), PIL.Image.ANTIALIAS)
     else:
         if direction == "down":
             if scale_height is None or (
diff --git a/plone/scale/tests/test_scale.py b/plone/scale/tests/test_scale.py
index 9e3f585..19dd3ba 100644
--- a/plone/scale/tests/test_scale.py
+++ b/plone/scale/tests/test_scale.py
@@ -53,6 +53,9 @@ def testRestrictHeightOnlyDownScale(self):
     def testSameSizeUpScale(self):
         self.assertEqual(scaleImage(PNG, 84, 103, "up")[2], (84, 103))
 
+    def testDoubleSizeUpScale(self):
+        self.assertEqual(scaleImage(PNG, 168, 206, "up")[2], (168, 206))
+
     def testHalfSizeUpScale(self):
         self.assertEqual(scaleImage(PNG, 42, 51, "up")[2], (42, 51))
 


