Repository: plone.schemaeditor
Branch: refs/heads/master
Date: 2015-03-06T15:37:04+01:00
Author: Timo Stollenwerk (tisto) <tisto@plone.org>
Commit: https://github.com/plone/plone.schemaeditor/commit/af56d6c3b0f2f834f0921450c0eef1bfd096238c

Clean up testing setup. This solves some serious test isolation issues.

Files changed:
M CHANGES.rst
M plone/schemaeditor/testing.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 70bc96a..9b0b4dd 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,6 +4,9 @@ Changelog
 2.0.2 (unreleased)
 ------------------
 
+- Clean up testing setup. This solves some serious test isolation issues.
+  [timo]
+
 - Update markup and javscript for Plone 5.
   [davisagli]
 
diff --git a/plone/schemaeditor/testing.py b/plone/schemaeditor/testing.py
index 1385328..10a1353 100644
--- a/plone/schemaeditor/testing.py
+++ b/plone/schemaeditor/testing.py
@@ -3,17 +3,11 @@
 
 from plone.app.robotframework.testing import AUTOLOGIN_LIBRARY_FIXTURE
 from plone.app.testing import FunctionalTesting
-from plone.app.testing import login
 from plone.app.testing import PLONE_FIXTURE
 from plone.app.testing import PloneSandboxLayer
-from plone.app.testing import setRoles
-from plone.app.testing import TEST_USER_ID
-from plone.app.testing import TEST_USER_NAME
 from plone.app.testing.helpers import applyProfile
 from plone.testing import z2
 
-import plone.schemaeditor.tests
-
 
 class PloneSchemaeditorRobotLayer(PloneSandboxLayer):
 
@@ -31,17 +25,8 @@ def setUpZope(self, app, configurationContext):
 
     def setUpPloneSite(self, portal):
         """Set up Plone."""
-        # Install into Plone site using portal_setup
         applyProfile(portal, 'plone.schemaeditor.tests:testing')
 
-        # Login and create some test content
-        setRoles(portal, TEST_USER_ID, ['Manager'])
-        login(portal, TEST_USER_NAME)
-
-        # Commit so that the test browser sees these objects
-        import transaction
-        transaction.commit()
-
 
 FIXTURE = PloneSchemaeditorRobotLayer(
     name="ROBOT"


