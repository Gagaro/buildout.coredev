Repository: Products.CMFDiffTool


Branch: refs/heads/master
Date: 2015-06-29T13:16:45+02:00
Author: CÃ©dric Messiant (cedricmessiant) <cedricmessiant@ecreall.com>
Commit: https://github.com/plone/Products.CMFDiffTool/commit/3ff21283f7eb79865c20aae03893313371870061

Fix bug with encoding in TextDiff

Files changed:
M CHANGES.txt
M Products/CMFDiffTool/TextDiff.py

diff --git a/CHANGES.txt b/CHANGES.txt
index 09083ed..1b0aa33 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -4,7 +4,8 @@ Changelog
 3.0.2 (unreleased)
 ------------------
 
-- Nothing changed yet.
+- Fix bug with encoding in TextDiff.
+  [cedricmessiant]
 
 
 3.0.1 (2015-05-12)
diff --git a/Products/CMFDiffTool/TextDiff.py b/Products/CMFDiffTool/TextDiff.py
index 969fa73..0be6ab7 100644
--- a/Products/CMFDiffTool/TextDiff.py
+++ b/Products/CMFDiffTool/TextDiff.py
@@ -105,6 +105,6 @@ def _parseField(self, value, filename=None):
         if translate is not None:
             value = translate(_(value))
 
-        return TextDiff._parseField(self, str(value), filename)
+        return TextDiff._parseField(self, safe_unicode(value), filename)
 
 InitializeClass(AsTextDiff)


