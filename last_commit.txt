Repository: Products.CMFPlone


Branch: refs/heads/4.3.x
Date: 2015-08-12T20:38:28+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.CMFPlone/commit/6eff2077539d89922d16568cc3ccbd7ee3a2ea5b

Fixed pyflakes warning in migration tool.

Files changed:
M Products/CMFPlone/MigrationTool.py

diff --git a/Products/CMFPlone/MigrationTool.py b/Products/CMFPlone/MigrationTool.py
index f580c7b..d01634d 100644
--- a/Products/CMFPlone/MigrationTool.py
+++ b/Products/CMFPlone/MigrationTool.py
@@ -123,6 +123,7 @@ def coreVersions(self):
                 except pkg_resources.DistributionNotFound:
                     try:
                         import _imaging
+                        _imaging  # pyflakes
                         vars['PIL'] = 'unknown'
                     except ImportError:
                         pass


Repository: Products.CMFPlone


Branch: refs/heads/4.3.x
Date: 2015-08-12T20:39:18+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.CMFPlone/commit/e70075b050071cb0900127ffe63f70f4aeb923ac

Added a bit more logging to migration tool.

Inform user when we are recataloging or updating role mappings,
because this could take a long time.

Files changed:
M Products/CMFPlone/MigrationTool.py

diff --git a/Products/CMFPlone/MigrationTool.py b/Products/CMFPlone/MigrationTool.py
index d01634d..fe921b1 100644
--- a/Products/CMFPlone/MigrationTool.py
+++ b/Products/CMFPlone/MigrationTool.py
@@ -203,6 +203,7 @@ def upgrade(self, REQUEST=None, dry_run=None, swallow_errors=True):
 
             # do this once all the changes have been done
             if self.needRecatalog():
+                logger.info("Please wait while we recatalog.")
                 try:
                     catalog = self.portal_catalog
                     # Reduce threshold for the reindex run
@@ -221,8 +222,10 @@ def upgrade(self, REQUEST=None, dry_run=None, swallow_errors=True):
                                  exc_info=True)
                     if not swallow_errors:
                         raise
+                logger.info("Done with recatalog.")
 
             if self.needUpdateRole():
+                logger.info("Please wait while we update role mappings.")
                 try:
                     self.portal_workflow.updateRoleMappings()
                     self._needUpdateRole = 0
@@ -233,6 +236,7 @@ def upgrade(self, REQUEST=None, dry_run=None, swallow_errors=True):
                                  "mappings", exc_info=True)
                     if not swallow_errors:
                         raise
+                logger.info("Done updating role mappings.")
 
             if dry_run:
                 logger.info("Dry run selected, transaction aborted")


