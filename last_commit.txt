Repository: Products.CMFPlone
Branch: refs/heads/master
Date: 2015-05-29T20:55:15+02:00
Author: Tom Gross (tomgross) <itconsense@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/2041bd226968dccd23f4f18e6f3b602432cff420

exclude CMFDefault only if it is installed

Files changed:
M Products/CMFPlone/meta.zcml

diff --git a/Products/CMFPlone/meta.zcml b/Products/CMFPlone/meta.zcml
index 3b968b4..f75d218 100644
--- a/Products/CMFPlone/meta.zcml
+++ b/Products/CMFPlone/meta.zcml
@@ -21,9 +21,11 @@
          be loaded. Doing this during the meta.zcml phase ensures this.
          The functionality in the following packages is not used and might
          interfere with Plone's own. -->
-    <exclude package="Products.CMFDefault.browser" file="configure.zcml" />
-    <exclude package="Products.CMFDefault.formlib" file="configure.zcml" />
-    <exclude package="Products.CMFDefault.upgrade" file="configure.zcml" />
+    <configure zcml:condition="installed Products.CMFDefault">
+        <exclude package="Products.CMFDefault.browser" file="configure.zcml" />
+        <exclude package="Products.CMFDefault.formlib" file="configure.zcml" />
+        <exclude package="Products.CMFDefault.upgrade" file="configure.zcml" />
+    </configure>
 
     <include package="Products.CMFCore" file="meta.zcml" />
     <include package="Products.GenericSetup" file="meta.zcml" />


Repository: Products.CMFPlone
Branch: refs/heads/master
Date: 2015-05-29T20:55:42+02:00
Author: Tom Gross (tomgross) <itconsense@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/1c61cf7c7ff95e9d0695914d59036d75bda9411b

remove unused import

Files changed:
M Products/CMFPlone/controlpanel/browser/maintenance.py

diff --git a/Products/CMFPlone/controlpanel/browser/maintenance.py b/Products/CMFPlone/controlpanel/browser/maintenance.py
index 36ab8a6..b4e0ef4 100644
--- a/Products/CMFPlone/controlpanel/browser/maintenance.py
+++ b/Products/CMFPlone/controlpanel/browser/maintenance.py
@@ -3,7 +3,6 @@
 import os
 from cgi import escape
 
-from plone.app.form.validators import null_validator
 from z3c.form import form
 
 from AccessControl import getSecurityManager
@@ -54,8 +53,6 @@ def handle_edit_action(self, action):
             cpanel.manage_pack(days=value, REQUEST=None)
         self.status = _(u'Packed the database.')
 
-    #@form.action(_(u'Shut down'), validator=null_validator, name=u'shutdown')
-
     @button.buttonAndHandler(_(u'Shut down'), name='shutdown')
     def handle_shutdown_action(self, action):
         CheckAuthenticator(self.request)
@@ -70,8 +67,6 @@ def handle_shutdown_action(self, action):
         result = cpanel.manage_shutdown()
         return result
 
-    #@form.action(_(u'Restart'), validator=null_validator)
-
     @button.buttonAndHandler(_(u'Restart'), name='restart')
     def handle_restart_action(self, action):
         CheckAuthenticator(self.request)


