Repository: mockup


Branch: refs/heads/master
Date: 2015-09-03T15:08:38-05:00
Author: vangheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/mockup/commit/a73f9a20b2b6758d34374fa9033aaf9590ba12d6

value could already be an object

Files changed:
M mockup/patterns/upload/pattern.js

diff --git a/mockup/patterns/upload/pattern.js b/mockup/patterns/upload/pattern.js
index 304090c..d523c59 100644
--- a/mockup/patterns/upload/pattern.js
+++ b/mockup/patterns/upload/pattern.js
@@ -187,8 +187,14 @@ define([
         // Trigger event 'uploadAllCompleted' and pass the server's reponse and
         // the path uid. This event can be listened to by patterns using the
         // upload pattern, e.g. the TinyMCE pattern's link plugin.
+        var data;
+        try{
+          data = $.parseJSON(response);
+        }catch(ex){
+          data = response;
+        }
         self.$el.trigger('uploadAllCompleted', {
-          'data': $.parseJSON(response),
+          'data': data,
           'path_uid': (self.$pathInput) ? self.$pathInput.val() : null
         });
       });


