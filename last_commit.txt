Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2015-09-14T17:01:23+02:00
Author: esteele (esteele) <eric@esteele.net>
Commit: https://github.com/plone/plone.app.upgrade/commit/8f2090e313358f6dce1636f189639d9aee80884e

Add rc3 upgrade.

Files changed:
M plone/app/upgrade/v50/betas.py
M plone/app/upgrade/v50/configure.zcml
M plone/app/upgrade/v50/profiles.zcml

diff --git a/plone/app/upgrade/v50/betas.py b/plone/app/upgrade/v50/betas.py
index 4f3590f..7555d9b 100644
--- a/plone/app/upgrade/v50/betas.py
+++ b/plone/app/upgrade/v50/betas.py
@@ -438,3 +438,9 @@ def to50rc2(context):
         if value is not None:
             registry['plone.allow_external_login_sites'] = tuple(value)
         site_properties._delProperty('allow_external_login_sites')
+
+
+def to50rc3(context):
+    """5.0rc2 -> 5.0rc3"""
+    loadMigrationProfile(context, 'profile-plone.app.upgrade.v50:to50rc3')
+    portal = getSite()
diff --git a/plone/app/upgrade/v50/configure.zcml b/plone/app/upgrade/v50/configure.zcml
index 18b316e..7ea58de 100644
--- a/plone/app/upgrade/v50/configure.zcml
+++ b/plone/app/upgrade/v50/configure.zcml
@@ -187,5 +187,17 @@
 
     </gs:upgradeSteps>
 
+    <gs:upgradeSteps
+        source="5009"
+        destination="5010"
+        profile="Products.CMFPlone:plone">
+
+       <gs:upgradeStep
+           title="Run to50rc3 upgrade profile"
+           description=""
+           handler=".betas.to50rc3"
+           />
+
+    </gs:upgradeSteps>
 
 </configure>
diff --git a/plone/app/upgrade/v50/profiles.zcml b/plone/app/upgrade/v50/profiles.zcml
index 5a600ee..869c086 100644
--- a/plone/app/upgrade/v50/profiles.zcml
+++ b/plone/app/upgrade/v50/profiles.zcml
@@ -75,5 +75,13 @@
       provides="Products.GenericSetup.interfaces.EXTENSION"
       />
 
+  <genericsetup:registerProfile
+      name="to50rc3"
+      title="Upgrade profile for Plone 5009 to Plone 5.0rc3"
+      description=""
+      directory="profiles/to_rc3"
+      for="Products.CMFPlone.interfaces.IMigratingPloneSiteRoot"
+      provides="Products.GenericSetup.interfaces.EXTENSION"
+      />
 
 </configure>


