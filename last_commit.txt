Repository: plone.app.widgets
Branch: refs/heads/master
Date: 2015-03-20T13:48:34-03:00
Author: hvelarde (hvelarde) <hector.velarde@gmail.com>
Commit: https://github.com/plone/plone.app.widgets/commit/0a1e25dd506f342bcd7f93ba8baa1476a788d18b

Update bootstrap.py

Files changed:
M bootstrap.py

diff --git a/bootstrap.py b/bootstrap.py
index ed57894..a629566 100644
--- a/bootstrap.py
+++ b/bootstrap.py
@@ -35,7 +35,7 @@
 Simply run this script in a directory containing a buildout.cfg, using the
 Python that you want bin/buildout to use.
 
-Note that by using --find-links to point to local resources, you can keep 
+Note that by using --find-links to point to local resources, you can keep
 this script from going over the network.
 '''
 
@@ -59,6 +59,8 @@
 parser.add_option("--allow-site-packages",
                   action="store_true", default=False,
                   help=("Let bootstrap.py use existing site packages"))
+parser.add_option("--setuptools-version",
+                  help="use a specific setuptools version")
 
 
 options, args = parser.parse_args()
@@ -79,16 +81,20 @@
 
 if not options.allow_site_packages:
     # ez_setup imports site, which adds site packages
-    # this will remove them from the path to ensure that incompatible versions 
+    # this will remove them from the path to ensure that incompatible versions
     # of setuptools are not in the path
     import site
-    # inside a virtualenv, there is no 'getsitepackages'. 
+    # inside a virtualenv, there is no 'getsitepackages'.
     # We can't remove these reliably
     if hasattr(site, 'getsitepackages'):
         for sitepackage_path in site.getsitepackages():
             sys.path[:] = [x for x in sys.path if sitepackage_path not in x]
 
 setup_args = dict(to_dir=tmpeggs, download_delay=0)
+
+if options.setuptools_version is not None:
+    setup_args['version'] = options.setuptools_version
+
 ez['use_setuptools'](**setup_args)
 import setuptools
 import pkg_resources
@@ -128,10 +134,15 @@
     _final_parts = '*final-', '*final'
 
     def _final_version(parsed_version):
-        for part in parsed_version:
-            if (part[:1] == '*') and (part not in _final_parts):
-                return False
-        return True
+        try:
+            return not parsed_version.is_prerelease
+        except AttributeError:
+            # Older setuptools
+            for part in parsed_version:
+                if (part[:1] == '*') and (part not in _final_parts):
+                    return False
+            return True
+
     index = setuptools.package_index.PackageIndex(
         search_path=[setuptools_path])
     if find_links:


Repository: plone.app.widgets
Branch: refs/heads/master
Date: 2015-03-20T14:28:28-03:00
Author: hvelarde (hvelarde) <hector.velarde@gmail.com>
Commit: https://github.com/plone/plone.app.widgets/commit/940743c5ac4702271c17ae1ae8f9f480e1313b90

Update development and CI configurations

- Clean up and simplify stuff by consolidating buildout configurations and remove dependencies on make and nix
- Fix support for Coveralls
- Add suport for plone.recipe.codeanalysis

Files changed:
A .coveragerc
A buildout.cfg
M .travis.yml
D Makefile
D buildout.cfg.in
D dev.nix
D develop.cfg
D travis.cfg
D versions.cfg

diff --git a/.coveragerc b/.coveragerc
new file mode 100644
index 0000000..543aede
--- /dev/null
+++ b/.coveragerc
@@ -0,0 +1,8 @@
+[report]
+omit =
+    /home/*/.buildout/eggs/*
+    /usr/*
+    bin/test
+    buildout-cache/eggs/*
+    eggs/*
+    parts/*
diff --git a/.travis.yml b/.travis.yml
index c369b6d..f602f05 100644
--- a/.travis.yml
+++ b/.travis.yml
@@ -1,25 +1,26 @@
 language: python
-python:
-  - 2.7
+python: 2.7
+sudo: false
+cache:
+  directories:
+  - eggs
 addons:
-  sauce_connect:
-    - username: $SAUCE_USERNAME
-    - access_key: $SAUCE_ACCESS_KEY
+  sauce_connect: true
 install:
-  - mkdir -p buildout-cache/downloads
-  - python bootstrap.py -c travis.cfg
-  - bin/buildout -N -t 3 -c travis.cfg
+- python bootstrap.py
+- bin/buildout annotate
+- bin/buildout -Nq
+before_script:
+- export ROBOT_DESIRED_CAPABILITIES="$BROWSER,tunnel-identifier:$TRAVIS_JOB_NUMBER"
 script:
-  - if [ "$BROWSER" != "code-analysis" ]; then export ROBOT_DESIRED_CAPABILITIES="$BROWSER,tunnel-identifier:$TRAVIS_JOB_NUMBER"; fi
-  - if [ "$BROWSER" != "code-analysis" ]; then bin/test -vvv --all; fi
-  - if [ "$BROWSER" == "code-analysis" ]; then bin/flake8 setup.py; fi
-  - if [ "$BROWSER" == "code-analysis" ]; then bin/flake8 plone; fi
-  - if [ "$BROWSER" == "code-analysis" ]; then bin/coverage run --source=plone.app.widgets --omit=plone/app/widgets/at_bbb.py,plone/app/widgets/dx_bbb.py,plone/app/widgets/dx_pac_bbb.py,plone/app/widgets/test\* bin/test --layer=\!PloneAppWidgetsLayer; fi
+- bin/code-analysis
+- bin/test
 after_success:
-  - bin/coveralls
+- bin/createcoverage
+- pip install -q coveralls
+- coveralls
 env:
   matrix:
-    - BROWSER="code-analysis"
     - BROWSER="platform:OS X 10.8,browserName:iphone,version:6.1,device-orientation:portrait"
     - BROWSER="platform:OS X 10.8,browserName:ipad,version:6.1,device-orientation:portrait"
     - BROWSER="platform:Linux,browserName:android,version:4.0,device-type:tablet,device-orientation:portrait"
@@ -47,3 +48,4 @@ matrix:
     - env: BROWSER="platform:Windows 7,browserName:internet explorer,version:8"
     - env: BROWSER="platform:Windows 7,browserName:opera,version:12"
     - env: BROWSER="platform:OS X 10.8,browserName:safari,version:6"
+  fast_finish: true
diff --git a/Makefile b/Makefile
deleted file mode 100644
index 1153a4b..0000000
--- a/Makefile
+++ /dev/null
@@ -1,22 +0,0 @@
-NIX_PATH=~/.nix-defexpr/channels/
-
-all: bootstrap
-	bin/buildout -v
-
-travis: bootstrap
-	bin/buildout -c travis.cfg -v
-
-bootstrap:
-	NIX_PATH=${NIX_PATH} nix-build --out-link nixenv dev.nix
-	./nixenv/bin/virtualenv --distribute --clear .
-	echo ../../../nixenv/lib/python2.7/site-packages > lib/python2.7/site-packages/nixenv.pth
-	./bin/easy_install -H "" zc.buildout
-	mkdir -p buildout-cache/downloads
-
-test:
-	bin/test
-
-print-syspath:
-	./bin/python -c 'import sys,pprint;pprint.pprint(sys.path)'
-
-.PHONY: all bootstrap print-syspath
diff --git a/buildout.cfg b/buildout.cfg
new file mode 100644
index 0000000..3d34976
--- /dev/null
+++ b/buildout.cfg
@@ -0,0 +1,40 @@
+[buildout]
+extends =
+    https://raw.github.com/collective/buildout.plonetest/master/test-5.0.x.cfg
+    https://raw.github.com/collective/buildout.plonetest/master/qa.cfg
+    https://raw.github.com/plone/plone.app.robotframework/master/versions.cfg
+    sphinx.cfg
+
+package-name = plone.app.widgets
+package-extras = [archetypes, dexterity, test]
+test-eggs = plone.app.contenttypes
+
+parts +=
+    createcoverage
+    omelette
+    robot
+
+[code-analysis]
+directory = ${buildout:directory}/plone/app/widgets
+pre-commit-hook = True
+flake8-ignore = E501
+return-status-codes = False
+
+[omelette]
+recipe = collective.recipe.omelette
+eggs = ${test:eggs}
+
+[robot]
+recipe = zc.recipe.egg
+eggs =
+    ${test:eggs}
+    robotframework-debuglibrary
+    plone.app.robotframework[reload]
+scripts =
+    robot-server
+    robot
+
+[versions]
+plone.app.widgets =
+# use latest version of setuptools
+setuptools =
diff --git a/buildout.cfg.in b/buildout.cfg.in
deleted file mode 100644
index a5befa9..0000000
--- a/buildout.cfg.in
+++ /dev/null
@@ -1,3 +0,0 @@
-[buildout]
-extends =
-    develop.cfg
diff --git a/dev.nix b/dev.nix
deleted file mode 100644
index b57e3a9..0000000
--- a/dev.nix
+++ /dev/null
@@ -1,17 +0,0 @@
-{ }:
-
-let
-    pkgs = import <nixpkgs> { };
-in
-
-with pkgs;
-
-buildEnv {
-  name = "plone-app-widgets-env";
-  paths = [
-    python27
-    python27Packages.recursivePthLoader
-    python27Packages.virtualenv
-    python27Packages.Plone
-  ] ++ lib.attrValues python27.modules;
-}
diff --git a/develop.cfg b/develop.cfg
deleted file mode 100644
index 5f32c3a..0000000
--- a/develop.cfg
+++ /dev/null
@@ -1,51 +0,0 @@
-[buildout]
-extends =
-    http://dist.plone.org/release/4.3-latest/versions.cfg
-    sphinx.cfg
-    versions.cfg
-
-versions = versions
-parts +=
-    instance
-    test
-    robot
-
-develop = .
-
-extensions = mr.developer
-auto-checkout = *
-
-[sources]
-# Looks like, `develop = .` doesn't work here - buildout is downloading the
-# plone.app.widgets 1.5.0 egg. So we checkout plone.app.widgets to the buildout
-# directory path.
-plone.app.widgets = git git@github.com:plone/plone.app.widgets.git branch=master full-path=${buildout:directory}
-
-[robot]
-recipe = zc.recipe.egg
-eggs =
-    ${test:eggs}
-    robotframework-debuglibrary
-    plone.app.robotframework[reload]
-scripts =
-    robot-server
-    robot
-
-[instance]
-recipe = plone.recipe.zope2instance
-blob-storage = ${buildout:directory}/var/blobstorage
-user = admin:admin
-http-address = 8080
-debug-mode = on
-verbose-security = on
-interpreter = instance-python
-eggs =
-    Pillow
-    Plone
-    plone.app.widgets[archetypes,dexterity]
-
-[test]
-recipe = zc.recipe.testrunner
-eggs = plone.app.widgets[test,archetypes,dexterity]
-defaults = ['--auto-color', '--auto-progress']
-
diff --git a/travis.cfg b/travis.cfg
deleted file mode 100644
index 6b5edf2..0000000
--- a/travis.cfg
+++ /dev/null
@@ -1,24 +0,0 @@
-[buildout]
-extends =
-    https://raw.github.com/collective/buildout.plonetest/master/travis-4.3.x.cfg
-    versions.cfg
-allow-hosts +=
-    code.google.com
-    robotframework.googlecode.com
-package-name = plone.app.widgets
-package-extras = [test,archetypes,dexterity]
-test-eggs = Pillow
-parts += extra
-develop += plone.app.contenttypes
-
-[extra]
-recipe = zc.recipe.egg
-eggs =
-    flake8
-    createcoverage
-    coveralls
-
-[versions]
-coverage = 3.7
-plone.app.robotframework = 0.8.2
-plone.app.contenttypes =
diff --git a/versions.cfg b/versions.cfg
deleted file mode 100644
index 2a4cef6..0000000
--- a/versions.cfg
+++ /dev/null
@@ -1,21 +0,0 @@
-[buildout]
-extends = https://raw.github.com/plone/plone.app.event/1.2.x/versions.cfg
-versions = versions
-
-[versions]
-# Robot Test Env
-plone.app.robotframework = 0.9.4
-robotframework = 2.8.4
-robotframework-selenium2library = 1.5.0
-robotsuite = 1.5.0
-selenium = 2.42.1
-robotframework-selenium2screenshots = 0.4.0
-sphinxcontrib-robotframework = 0.4.3
-robotframework-debuglibrary = 0.3
-# Test Env
-collective.xmltestreport = 1.3.1
-mock = 1.0.1
-zope.testrunner = 4.1.1
-pep8 = 1.4.6
-Babel = 1.3
-Pygments = 1.6


Repository: plone.app.widgets
Branch: refs/heads/master
Date: 2015-03-20T14:28:28-03:00
Author: hvelarde (hvelarde) <hector.velarde@gmail.com>
Commit: https://github.com/plone/plone.app.widgets/commit/928b1c85c8213d6778f69fe4cb12d310e2da98a3

Remove dependency on unittest2

Conflicts:
	plone/app/widgets/tests/test_at.py
	plone/app/widgets/tests/test_browser.py
	plone/app/widgets/tests/test_dx.py

Files changed:
M plone/app/widgets/tests/test_base.py
M plone/app/widgets/tests/test_robot.py
M plone/app/widgets/tests/test_utils.py

diff --git a/plone/app/widgets/tests/test_base.py b/plone/app/widgets/tests/test_base.py
index 6c02c37..2754bad 100644
--- a/plone/app/widgets/tests/test_base.py
+++ b/plone/app/widgets/tests/test_base.py
@@ -1,10 +1,5 @@
 # -*- coding: utf-8 -*-
-
-try:
-    import unittest2 as unittest
-except ImportError:  # pragma: nocover
-    import unittest  # pragma: nocover
-    assert unittest  # pragma: nocover
+import unittest
 
 
 class BaseWidgetTests(unittest.TestCase):
diff --git a/plone/app/widgets/tests/test_robot.py b/plone/app/widgets/tests/test_robot.py
index a9252ef..47989f6 100644
--- a/plone/app/widgets/tests/test_robot.py
+++ b/plone/app/widgets/tests/test_robot.py
@@ -1,5 +1,6 @@
 from plone.app.widgets.testing import PLONEAPPWIDGETS_DX_ROBOT_TESTING
 from plone.testing import layered
+
 import os
 import robotsuite
 import unittest
diff --git a/plone/app/widgets/tests/test_utils.py b/plone/app/widgets/tests/test_utils.py
index 6228607..8b39c44 100644
--- a/plone/app/widgets/tests/test_utils.py
+++ b/plone/app/widgets/tests/test_utils.py
@@ -1,11 +1,7 @@
 from mock import Mock
 from mock import patch
 
-try:
-    import unittest2 as unittest
-except ImportError:  # pragma: nocover
-    import unittest  # pragma: nocover
-    assert unittest  # pragma: nocover
+import unittest
 
 
 class MockTool(Mock):


Repository: plone.app.widgets
Branch: refs/heads/master
Date: 2015-03-20T14:28:28-03:00
Author: hvelarde (hvelarde) <hector.velarde@gmail.com>
Commit: https://github.com/plone/plone.app.widgets/commit/375a2bf571b24b9c881374c063247890b65d0a41

Remove circular dependencies (partially fixes #92)

Files changed:
M setup.py

diff --git a/setup.py b/setup.py
index aed0238..c989c40 100644
--- a/setup.py
+++ b/setup.py
@@ -36,7 +36,6 @@
     extras_require={
         'test': [
             'plone.app.robotframework[debug]',
-            'plone.app.widgets[archetypes, dexterity]',
             'plone.app.testing>=4.2.4',  # we need ROBOT_TEST_LEVEL
             'mock',
         ],
@@ -48,8 +47,6 @@
         'dexterity': [
             'pytz',
             'plone.app.dexterity',
-            'plone.app.contenttypes>=1.1b1',
-            'plone.app.event>=1.2',
         ],
     },
     entry_points="""


Repository: plone.app.widgets
Branch: refs/heads/master
Date: 2015-03-20T14:28:28-03:00
Author: hvelarde (hvelarde) <hector.velarde@gmail.com>
Commit: https://github.com/plone/plone.app.widgets/commit/5288a4ceb6a4acf7d0949b6c927dca68b65d3082

Remove outdated information from README.rst

Files changed:
M README.rst

diff --git a/README.rst b/README.rst
index 9742d01..be2c893 100644
--- a/README.rst
+++ b/README.rst
@@ -4,9 +4,11 @@ project. It overrides explicit widgets used in dexterity and archetypes to
 provide tested and modularized widgets based on the concept of *patterns*.
 
 .. image:: https://travis-ci.org/plone/plone.app.widgets.png?branch=master
+    :alt: Travis CI badge
     :target: https://travis-ci.org/plone/plone.app.widgets
 
 .. image:: https://coveralls.io/repos/plone/plone.app.widgets/badge.png?branch=master
+    :alt: Coveralls badge
     :target: https://coveralls.io/r/plone/plone.app.widgets?branch=master
 
 .. image:: https://pypip.in/v/plone.app.widgets/badge.png
@@ -34,20 +36,6 @@ This package should be safe to install and easy to uninstall (there is also
 uninstall profile). That means its fairly safe to give it a try, but just in
 case don't forget to create backup before testing it.
 
-As of version 1.4.0 there is quite comprehensive unittest coverage of python
-code as well as high coverage of our javascript code. There are also some robot
-tests which are testing integration with Plone, but this will be improved with
-future releases.
-
-This project will be integrated with Plone 5 and will never reach version
-2.0.0. You can monitor progress of `PLIP here`_.
-
-If you wonder why there is no Alpha/Beta marker in version, its because version
-of this package is kept in sync with other projects deriving from `Mockup`_
-(eg. `plone.app.toolbar`_).  Version 1.4.1 would then mean we're using
-`Mockup`_ version 1.4 and there was one bugfix only to the python code. Version
-packaged javascript inside is still in sync with `Mockup`_ project.
-
 
 What is included?
 =================


Repository: plone.app.widgets
Branch: refs/heads/master
Date: 2015-03-20T14:28:28-03:00
Author: hvelarde (hvelarde) <hector.velarde@gmail.com>
Commit: https://github.com/plone/plone.app.widgets/commit/b3a7827e2f11afed988b69fe8433b273d0245f4e

Fix trove classifiers

Files changed:
M setup.py

diff --git a/setup.py b/setup.py
index c989c40..e0a56f1 100644
--- a/setup.py
+++ b/setup.py
@@ -11,14 +11,22 @@
         open("CHANGES.rst").read(),
     ),
     classifiers=[
-        "Framework :: Plone",
-        "Programming Language :: Python",
+        'Development Status :: 3 - Alpha',
+        'Environment :: Web Environment',
+        'Framework :: Plone',
+        'Framework :: Plone :: 5.0',
+        'Intended Audience :: End Users/Desktop',
+        'License :: OSI Approved :: GNU General Public License v2 (GPLv2)',
+        'Operating System :: OS Independent',
+        'Programming Language :: JavaScript',
+        'Programming Language :: Python',
+        'Programming Language :: Python :: 2.7',
+        'Topic :: Software Development :: Libraries :: Python Modules',
     ],
     keywords='plone widgets z3cform archetypes',
     author='Nathan Van Gheem',
     author_email='vangheem@gmail.com',
     url='https://github.com/plone/plone.app.widgets',
-    license='GPL',
     packages=find_packages(),
     namespace_packages=['plone', 'plone.app'],
     include_package_data=True,


Repository: plone.app.widgets
Branch: refs/heads/master
Date: 2015-03-20T14:28:28-03:00
Author: hvelarde (hvelarde) <hector.velarde@gmail.com>
Commit: https://github.com/plone/plone.app.widgets/commit/0aba3ac21ef4c0f75f284fc867a54ab39484c30c

Disable Sauce Labs on CI as configuration is broken

Files changed:
M .travis.yml

diff --git a/.travis.yml b/.travis.yml
index f602f05..0cff256 100644
--- a/.travis.yml
+++ b/.travis.yml
@@ -4,14 +4,17 @@ sudo: false
 cache:
   directories:
   - eggs
-addons:
-  sauce_connect: true
+# addons:
+#   sauce_connect: true
 install:
 - python bootstrap.py
 - bin/buildout annotate
 - bin/buildout -Nq
 before_script:
 - export ROBOT_DESIRED_CAPABILITIES="$BROWSER,tunnel-identifier:$TRAVIS_JOB_NUMBER"
+- export DISPLAY=:99.0
+- sh -e /etc/init.d/xvfb start
+- firefox -v
 script:
 - bin/code-analysis
 - bin/test
@@ -19,24 +22,24 @@ after_success:
 - bin/createcoverage
 - pip install -q coveralls
 - coveralls
-env:
-  matrix:
-    - BROWSER="platform:OS X 10.8,browserName:iphone,version:6.1,device-orientation:portrait"
-    - BROWSER="platform:OS X 10.8,browserName:ipad,version:6.1,device-orientation:portrait"
-    - BROWSER="platform:Linux,browserName:android,version:4.0,device-type:tablet,device-orientation:portrait"
-    - BROWSER="platform:Windows 7,browserName:firefox,version:25"
-    - BROWSER="platform:Windows 7,browserName:chrome,version:31"
-    - BROWSER="platform:Windows 8.1,browserName:internet explorer,version:11"
-    - BROWSER="platform:Windows 7,browserName:internet explorer,version:10"
-    - BROWSER="platform:Windows 7,browserName:internet explorer,version:9"
-    - BROWSER="platform:Windows 7,browserName:internet explorer,version:8"
-    - BROWSER="platform:Windows 7,browserName:opera,version:12"
-    - BROWSER="platform:OS X 10.8,browserName:safari,version:6"
-  global:
-    - secure: "X9AvF9DYKjG/E52ZKQGxxrMe/Z1FsuwJU9jk39NLia3aA3WyFKuE66BotqeZGi9Jk0V2IQWekMgZcAFIcRH6qbvMKcMtnhD+Wr8aiV7uby3wRjmPi2FznTiy+FvYwm8WiNBHw4Ek++nSCDkly0QGBUmJVvfe3zxNHSHSKx5E/yg="
-    - secure: "CvB/BK4EhZIiruAuiIFw/Bn80Wv/5jGiS2tOCaXd54v7lhld2VBxyCfccIcizKlSkIXzDausw24zEF0HV4E6k4z8AB12h1DH/6p31+epbrvDnQOZ1Br2grusOqMbjOutRkJ0w+upI+BTaeSI9bmYXZQdpkLA5mJCv0sBbqi4SPA="
-    - ROBOT_BUILD_NUMBER=plone.app.widgets-travis-$TRAVIS_BUILD_NUMBER
-    - ROBOT_REMOTE_URL=http://$SAUCE_USERNAME:$SAUCE_ACCESS_KEY@ondemand.saucelabs.com:80/wd/hub
+# env:
+#   matrix:
+#     - BROWSER="platform:OS X 10.8,browserName:iphone,version:6.1,device-orientation:portrait"
+#     - BROWSER="platform:OS X 10.8,browserName:ipad,version:6.1,device-orientation:portrait"
+#     - BROWSER="platform:Linux,browserName:android,version:4.0,device-type:tablet,device-orientation:portrait"
+#     - BROWSER="platform:Windows 7,browserName:firefox,version:25"
+#     - BROWSER="platform:Windows 7,browserName:chrome,version:31"
+#     - BROWSER="platform:Windows 8.1,browserName:internet explorer,version:11"
+#     - BROWSER="platform:Windows 7,browserName:internet explorer,version:10"
+#     - BROWSER="platform:Windows 7,browserName:internet explorer,version:9"
+#     - BROWSER="platform:Windows 7,browserName:internet explorer,version:8"
+#     - BROWSER="platform:Windows 7,browserName:opera,version:12"
+#     - BROWSER="platform:OS X 10.8,browserName:safari,version:6"
+#   global:
+#     - secure: "X9AvF9DYKjG/E52ZKQGxxrMe/Z1FsuwJU9jk39NLia3aA3WyFKuE66BotqeZGi9Jk0V2IQWekMgZcAFIcRH6qbvMKcMtnhD+Wr8aiV7uby3wRjmPi2FznTiy+FvYwm8WiNBHw4Ek++nSCDkly0QGBUmJVvfe3zxNHSHSKx5E/yg="
+#     - secure: "CvB/BK4EhZIiruAuiIFw/Bn80Wv/5jGiS2tOCaXd54v7lhld2VBxyCfccIcizKlSkIXzDausw24zEF0HV4E6k4z8AB12h1DH/6p31+epbrvDnQOZ1Br2grusOqMbjOutRkJ0w+upI+BTaeSI9bmYXZQdpkLA5mJCv0sBbqi4SPA="
+#     - ROBOT_BUILD_NUMBER=plone.app.widgets-travis-$TRAVIS_BUILD_NUMBER
+#     - ROBOT_REMOTE_URL=http://$SAUCE_USERNAME:$SAUCE_ACCESS_KEY@ondemand.saucelabs.com:80/wd/hub
 matrix:
   allow_failures:
     - env: BROWSER="platform:OS X 10.8,browserName:iphone,version:6.1,device-orientation:portrait"


Repository: plone.app.widgets
Branch: refs/heads/master
Date: 2015-03-20T14:28:28-03:00
Author: hvelarde (hvelarde) <hector.velarde@gmail.com>
Commit: https://github.com/plone/plone.app.widgets/commit/bebd3532f0e93d41b87f4949670ac4d0ea1c8ed9

Update package dependencies

Files changed:
M setup.py

diff --git a/setup.py b/setup.py
index e0a56f1..f448c16 100644
--- a/setup.py
+++ b/setup.py
@@ -32,29 +32,33 @@
     include_package_data=True,
     zip_safe=False,
     install_requires=[
-        'setuptools',
-        # needed because we use bundles
-        'Products.ResourceRegistries>=2.1',
-        # nedded because users vocabulary was added here
-        'plone.app.vocabularies>=2.1.12dev',
-        # needed for compatibility with jQuery 1.9+
+        'five.globalrequest',
+        'plone.app.layout',
+        'plone.app.vocabularies',
+        'plone.namedfile',
         'Products.CMFPlone>=5.0.dev0',
-        'five.globalrequest'
+        'Products.ResourceRegistries',
+        'setuptools',
+        'zope.component',
+        'zope.interface',
+        'zope.schema',
     ],
     extras_require={
         'test': [
-            'plone.app.robotframework[debug]',
-            'plone.app.testing>=4.2.4',  # we need ROBOT_TEST_LEVEL
             'mock',
+            'plone.app.robotframework[debug]',
+            'plone.app.testing',
+            'plone.testing',
+            'robotsuite',
         ],
         'archetypes': [
+            'archetypes.schemaextender',
             'DateTime',
             'Products.Archetypes',
-            'archetypes.schemaextender',
         ],
         'dexterity': [
-            'pytz',
             'plone.app.dexterity',
+            'pytz',
         ],
     },
     entry_points="""


Repository: plone.app.widgets
Branch: refs/heads/master
Date: 2015-03-20T12:57:10-05:00
Author: Nathan Van Gheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/plone.app.widgets/commit/1414679e3c52d52df4b535345367e701436dbf03

Merge pull request #95 from plone/hvelarde-buildout

Update development and CI configurations

Files changed:
A .coveragerc
A buildout.cfg
M .travis.yml
M README.rst
M bootstrap.py
M plone/app/widgets/tests/test_base.py
M plone/app/widgets/tests/test_robot.py
M plone/app/widgets/tests/test_utils.py
M setup.py
D Makefile
D buildout.cfg.in
D dev.nix
D develop.cfg
D travis.cfg
D versions.cfg

diff --git a/.coveragerc b/.coveragerc
new file mode 100644
index 0000000..543aede
--- /dev/null
+++ b/.coveragerc
@@ -0,0 +1,8 @@
+[report]
+omit =
+    /home/*/.buildout/eggs/*
+    /usr/*
+    bin/test
+    buildout-cache/eggs/*
+    eggs/*
+    parts/*
diff --git a/.travis.yml b/.travis.yml
index c369b6d..0cff256 100644
--- a/.travis.yml
+++ b/.travis.yml
@@ -1,41 +1,45 @@
 language: python
-python:
-  - 2.7
-addons:
-  sauce_connect:
-    - username: $SAUCE_USERNAME
-    - access_key: $SAUCE_ACCESS_KEY
+python: 2.7
+sudo: false
+cache:
+  directories:
+  - eggs
+# addons:
+#   sauce_connect: true
 install:
-  - mkdir -p buildout-cache/downloads
-  - python bootstrap.py -c travis.cfg
-  - bin/buildout -N -t 3 -c travis.cfg
+- python bootstrap.py
+- bin/buildout annotate
+- bin/buildout -Nq
+before_script:
+- export ROBOT_DESIRED_CAPABILITIES="$BROWSER,tunnel-identifier:$TRAVIS_JOB_NUMBER"
+- export DISPLAY=:99.0
+- sh -e /etc/init.d/xvfb start
+- firefox -v
 script:
-  - if [ "$BROWSER" != "code-analysis" ]; then export ROBOT_DESIRED_CAPABILITIES="$BROWSER,tunnel-identifier:$TRAVIS_JOB_NUMBER"; fi
-  - if [ "$BROWSER" != "code-analysis" ]; then bin/test -vvv --all; fi
-  - if [ "$BROWSER" == "code-analysis" ]; then bin/flake8 setup.py; fi
-  - if [ "$BROWSER" == "code-analysis" ]; then bin/flake8 plone; fi
-  - if [ "$BROWSER" == "code-analysis" ]; then bin/coverage run --source=plone.app.widgets --omit=plone/app/widgets/at_bbb.py,plone/app/widgets/dx_bbb.py,plone/app/widgets/dx_pac_bbb.py,plone/app/widgets/test\* bin/test --layer=\!PloneAppWidgetsLayer; fi
+- bin/code-analysis
+- bin/test
 after_success:
-  - bin/coveralls
-env:
-  matrix:
-    - BROWSER="code-analysis"
-    - BROWSER="platform:OS X 10.8,browserName:iphone,version:6.1,device-orientation:portrait"
-    - BROWSER="platform:OS X 10.8,browserName:ipad,version:6.1,device-orientation:portrait"
-    - BROWSER="platform:Linux,browserName:android,version:4.0,device-type:tablet,device-orientation:portrait"
-    - BROWSER="platform:Windows 7,browserName:firefox,version:25"
-    - BROWSER="platform:Windows 7,browserName:chrome,version:31"
-    - BROWSER="platform:Windows 8.1,browserName:internet explorer,version:11"
-    - BROWSER="platform:Windows 7,browserName:internet explorer,version:10"
-    - BROWSER="platform:Windows 7,browserName:internet explorer,version:9"
-    - BROWSER="platform:Windows 7,browserName:internet explorer,version:8"
-    - BROWSER="platform:Windows 7,browserName:opera,version:12"
-    - BROWSER="platform:OS X 10.8,browserName:safari,version:6"
-  global:
-    - secure: "X9AvF9DYKjG/E52ZKQGxxrMe/Z1FsuwJU9jk39NLia3aA3WyFKuE66BotqeZGi9Jk0V2IQWekMgZcAFIcRH6qbvMKcMtnhD+Wr8aiV7uby3wRjmPi2FznTiy+FvYwm8WiNBHw4Ek++nSCDkly0QGBUmJVvfe3zxNHSHSKx5E/yg="
-    - secure: "CvB/BK4EhZIiruAuiIFw/Bn80Wv/5jGiS2tOCaXd54v7lhld2VBxyCfccIcizKlSkIXzDausw24zEF0HV4E6k4z8AB12h1DH/6p31+epbrvDnQOZ1Br2grusOqMbjOutRkJ0w+upI+BTaeSI9bmYXZQdpkLA5mJCv0sBbqi4SPA="
-    - ROBOT_BUILD_NUMBER=plone.app.widgets-travis-$TRAVIS_BUILD_NUMBER
-    - ROBOT_REMOTE_URL=http://$SAUCE_USERNAME:$SAUCE_ACCESS_KEY@ondemand.saucelabs.com:80/wd/hub
+- bin/createcoverage
+- pip install -q coveralls
+- coveralls
+# env:
+#   matrix:
+#     - BROWSER="platform:OS X 10.8,browserName:iphone,version:6.1,device-orientation:portrait"
+#     - BROWSER="platform:OS X 10.8,browserName:ipad,version:6.1,device-orientation:portrait"
+#     - BROWSER="platform:Linux,browserName:android,version:4.0,device-type:tablet,device-orientation:portrait"
+#     - BROWSER="platform:Windows 7,browserName:firefox,version:25"
+#     - BROWSER="platform:Windows 7,browserName:chrome,version:31"
+#     - BROWSER="platform:Windows 8.1,browserName:internet explorer,version:11"
+#     - BROWSER="platform:Windows 7,browserName:internet explorer,version:10"
+#     - BROWSER="platform:Windows 7,browserName:internet explorer,version:9"
+#     - BROWSER="platform:Windows 7,browserName:internet explorer,version:8"
+#     - BROWSER="platform:Windows 7,browserName:opera,version:12"
+#     - BROWSER="platform:OS X 10.8,browserName:safari,version:6"
+#   global:
+#     - secure: "X9AvF9DYKjG/E52ZKQGxxrMe/Z1FsuwJU9jk39NLia3aA3WyFKuE66BotqeZGi9Jk0V2IQWekMgZcAFIcRH6qbvMKcMtnhD+Wr8aiV7uby3wRjmPi2FznTiy+FvYwm8WiNBHw4Ek++nSCDkly0QGBUmJVvfe3zxNHSHSKx5E/yg="
+#     - secure: "CvB/BK4EhZIiruAuiIFw/Bn80Wv/5jGiS2tOCaXd54v7lhld2VBxyCfccIcizKlSkIXzDausw24zEF0HV4E6k4z8AB12h1DH/6p31+epbrvDnQOZ1Br2grusOqMbjOutRkJ0w+upI+BTaeSI9bmYXZQdpkLA5mJCv0sBbqi4SPA="
+#     - ROBOT_BUILD_NUMBER=plone.app.widgets-travis-$TRAVIS_BUILD_NUMBER
+#     - ROBOT_REMOTE_URL=http://$SAUCE_USERNAME:$SAUCE_ACCESS_KEY@ondemand.saucelabs.com:80/wd/hub
 matrix:
   allow_failures:
     - env: BROWSER="platform:OS X 10.8,browserName:iphone,version:6.1,device-orientation:portrait"
@@ -47,3 +51,4 @@ matrix:
     - env: BROWSER="platform:Windows 7,browserName:internet explorer,version:8"
     - env: BROWSER="platform:Windows 7,browserName:opera,version:12"
     - env: BROWSER="platform:OS X 10.8,browserName:safari,version:6"
+  fast_finish: true
diff --git a/Makefile b/Makefile
deleted file mode 100644
index 1153a4b..0000000
--- a/Makefile
+++ /dev/null
@@ -1,22 +0,0 @@
-NIX_PATH=~/.nix-defexpr/channels/
-
-all: bootstrap
-	bin/buildout -v
-
-travis: bootstrap
-	bin/buildout -c travis.cfg -v
-
-bootstrap:
-	NIX_PATH=${NIX_PATH} nix-build --out-link nixenv dev.nix
-	./nixenv/bin/virtualenv --distribute --clear .
-	echo ../../../nixenv/lib/python2.7/site-packages > lib/python2.7/site-packages/nixenv.pth
-	./bin/easy_install -H "" zc.buildout
-	mkdir -p buildout-cache/downloads
-
-test:
-	bin/test
-
-print-syspath:
-	./bin/python -c 'import sys,pprint;pprint.pprint(sys.path)'
-
-.PHONY: all bootstrap print-syspath
diff --git a/README.rst b/README.rst
index 9742d01..be2c893 100644
--- a/README.rst
+++ b/README.rst
@@ -4,9 +4,11 @@ project. It overrides explicit widgets used in dexterity and archetypes to
 provide tested and modularized widgets based on the concept of *patterns*.
 
 .. image:: https://travis-ci.org/plone/plone.app.widgets.png?branch=master
+    :alt: Travis CI badge
     :target: https://travis-ci.org/plone/plone.app.widgets
 
 .. image:: https://coveralls.io/repos/plone/plone.app.widgets/badge.png?branch=master
+    :alt: Coveralls badge
     :target: https://coveralls.io/r/plone/plone.app.widgets?branch=master
 
 .. image:: https://pypip.in/v/plone.app.widgets/badge.png
@@ -34,20 +36,6 @@ This package should be safe to install and easy to uninstall (there is also
 uninstall profile). That means its fairly safe to give it a try, but just in
 case don't forget to create backup before testing it.
 
-As of version 1.4.0 there is quite comprehensive unittest coverage of python
-code as well as high coverage of our javascript code. There are also some robot
-tests which are testing integration with Plone, but this will be improved with
-future releases.
-
-This project will be integrated with Plone 5 and will never reach version
-2.0.0. You can monitor progress of `PLIP here`_.
-
-If you wonder why there is no Alpha/Beta marker in version, its because version
-of this package is kept in sync with other projects deriving from `Mockup`_
-(eg. `plone.app.toolbar`_).  Version 1.4.1 would then mean we're using
-`Mockup`_ version 1.4 and there was one bugfix only to the python code. Version
-packaged javascript inside is still in sync with `Mockup`_ project.
-
 
 What is included?
 =================
diff --git a/bootstrap.py b/bootstrap.py
index ed57894..a629566 100644
--- a/bootstrap.py
+++ b/bootstrap.py
@@ -35,7 +35,7 @@
 Simply run this script in a directory containing a buildout.cfg, using the
 Python that you want bin/buildout to use.
 
-Note that by using --find-links to point to local resources, you can keep 
+Note that by using --find-links to point to local resources, you can keep
 this script from going over the network.
 '''
 
@@ -59,6 +59,8 @@
 parser.add_option("--allow-site-packages",
                   action="store_true", default=False,
                   help=("Let bootstrap.py use existing site packages"))
+parser.add_option("--setuptools-version",
+                  help="use a specific setuptools version")
 
 
 options, args = parser.parse_args()
@@ -79,16 +81,20 @@
 
 if not options.allow_site_packages:
     # ez_setup imports site, which adds site packages
-    # this will remove them from the path to ensure that incompatible versions 
+    # this will remove them from the path to ensure that incompatible versions
     # of setuptools are not in the path
     import site
-    # inside a virtualenv, there is no 'getsitepackages'. 
+    # inside a virtualenv, there is no 'getsitepackages'.
     # We can't remove these reliably
     if hasattr(site, 'getsitepackages'):
         for sitepackage_path in site.getsitepackages():
             sys.path[:] = [x for x in sys.path if sitepackage_path not in x]
 
 setup_args = dict(to_dir=tmpeggs, download_delay=0)
+
+if options.setuptools_version is not None:
+    setup_args['version'] = options.setuptools_version
+
 ez['use_setuptools'](**setup_args)
 import setuptools
 import pkg_resources
@@ -128,10 +134,15 @@
     _final_parts = '*final-', '*final'
 
     def _final_version(parsed_version):
-        for part in parsed_version:
-            if (part[:1] == '*') and (part not in _final_parts):
-                return False
-        return True
+        try:
+            return not parsed_version.is_prerelease
+        except AttributeError:
+            # Older setuptools
+            for part in parsed_version:
+                if (part[:1] == '*') and (part not in _final_parts):
+                    return False
+            return True
+
     index = setuptools.package_index.PackageIndex(
         search_path=[setuptools_path])
     if find_links:
diff --git a/buildout.cfg b/buildout.cfg
new file mode 100644
index 0000000..3d34976
--- /dev/null
+++ b/buildout.cfg
@@ -0,0 +1,40 @@
+[buildout]
+extends =
+    https://raw.github.com/collective/buildout.plonetest/master/test-5.0.x.cfg
+    https://raw.github.com/collective/buildout.plonetest/master/qa.cfg
+    https://raw.github.com/plone/plone.app.robotframework/master/versions.cfg
+    sphinx.cfg
+
+package-name = plone.app.widgets
+package-extras = [archetypes, dexterity, test]
+test-eggs = plone.app.contenttypes
+
+parts +=
+    createcoverage
+    omelette
+    robot
+
+[code-analysis]
+directory = ${buildout:directory}/plone/app/widgets
+pre-commit-hook = True
+flake8-ignore = E501
+return-status-codes = False
+
+[omelette]
+recipe = collective.recipe.omelette
+eggs = ${test:eggs}
+
+[robot]
+recipe = zc.recipe.egg
+eggs =
+    ${test:eggs}
+    robotframework-debuglibrary
+    plone.app.robotframework[reload]
+scripts =
+    robot-server
+    robot
+
+[versions]
+plone.app.widgets =
+# use latest version of setuptools
+setuptools =
diff --git a/buildout.cfg.in b/buildout.cfg.in
deleted file mode 100644
index a5befa9..0000000
--- a/buildout.cfg.in
+++ /dev/null
@@ -1,3 +0,0 @@
-[buildout]
-extends =
-    develop.cfg
diff --git a/dev.nix b/dev.nix
deleted file mode 100644
index b57e3a9..0000000
--- a/dev.nix
+++ /dev/null
@@ -1,17 +0,0 @@
-{ }:
-
-let
-    pkgs = import <nixpkgs> { };
-in
-
-with pkgs;
-
-buildEnv {
-  name = "plone-app-widgets-env";
-  paths = [
-    python27
-    python27Packages.recursivePthLoader
-    python27Packages.virtualenv
-    python27Packages.Plone
-  ] ++ lib.attrValues python27.modules;
-}
diff --git a/develop.cfg b/develop.cfg
deleted file mode 100644
index 5f32c3a..0000000
--- a/develop.cfg
+++ /dev/null
@@ -1,51 +0,0 @@
-[buildout]
-extends =
-    http://dist.plone.org/release/4.3-latest/versions.cfg
-    sphinx.cfg
-    versions.cfg
-
-versions = versions
-parts +=
-    instance
-    test
-    robot
-
-develop = .
-
-extensions = mr.developer
-auto-checkout = *
-
-[sources]
-# Looks like, `develop = .` doesn't work here - buildout is downloading the
-# plone.app.widgets 1.5.0 egg. So we checkout plone.app.widgets to the buildout
-# directory path.
-plone.app.widgets = git git@github.com:plone/plone.app.widgets.git branch=master full-path=${buildout:directory}
-
-[robot]
-recipe = zc.recipe.egg
-eggs =
-    ${test:eggs}
-    robotframework-debuglibrary
-    plone.app.robotframework[reload]
-scripts =
-    robot-server
-    robot
-
-[instance]
-recipe = plone.recipe.zope2instance
-blob-storage = ${buildout:directory}/var/blobstorage
-user = admin:admin
-http-address = 8080
-debug-mode = on
-verbose-security = on
-interpreter = instance-python
-eggs =
-    Pillow
-    Plone
-    plone.app.widgets[archetypes,dexterity]
-
-[test]
-recipe = zc.recipe.testrunner
-eggs = plone.app.widgets[test,archetypes,dexterity]
-defaults = ['--auto-color', '--auto-progress']
-
diff --git a/plone/app/widgets/tests/test_base.py b/plone/app/widgets/tests/test_base.py
index 6c02c37..2754bad 100644
--- a/plone/app/widgets/tests/test_base.py
+++ b/plone/app/widgets/tests/test_base.py
@@ -1,10 +1,5 @@
 # -*- coding: utf-8 -*-
-
-try:
-    import unittest2 as unittest
-except ImportError:  # pragma: nocover
-    import unittest  # pragma: nocover
-    assert unittest  # pragma: nocover
+import unittest
 
 
 class BaseWidgetTests(unittest.TestCase):
diff --git a/plone/app/widgets/tests/test_robot.py b/plone/app/widgets/tests/test_robot.py
index a9252ef..47989f6 100644
--- a/plone/app/widgets/tests/test_robot.py
+++ b/plone/app/widgets/tests/test_robot.py
@@ -1,5 +1,6 @@
 from plone.app.widgets.testing import PLONEAPPWIDGETS_DX_ROBOT_TESTING
 from plone.testing import layered
+
 import os
 import robotsuite
 import unittest
diff --git a/plone/app/widgets/tests/test_utils.py b/plone/app/widgets/tests/test_utils.py
index 6228607..8b39c44 100644
--- a/plone/app/widgets/tests/test_utils.py
+++ b/plone/app/widgets/tests/test_utils.py
@@ -1,11 +1,7 @@
 from mock import Mock
 from mock import patch
 
-try:
-    import unittest2 as unittest
-except ImportError:  # pragma: nocover
-    import unittest  # pragma: nocover
-    assert unittest  # pragma: nocover
+import unittest
 
 
 class MockTool(Mock):
diff --git a/setup.py b/setup.py
index aed0238..f448c16 100644
--- a/setup.py
+++ b/setup.py
@@ -11,45 +11,54 @@
         open("CHANGES.rst").read(),
     ),
     classifiers=[
-        "Framework :: Plone",
-        "Programming Language :: Python",
+        'Development Status :: 3 - Alpha',
+        'Environment :: Web Environment',
+        'Framework :: Plone',
+        'Framework :: Plone :: 5.0',
+        'Intended Audience :: End Users/Desktop',
+        'License :: OSI Approved :: GNU General Public License v2 (GPLv2)',
+        'Operating System :: OS Independent',
+        'Programming Language :: JavaScript',
+        'Programming Language :: Python',
+        'Programming Language :: Python :: 2.7',
+        'Topic :: Software Development :: Libraries :: Python Modules',
     ],
     keywords='plone widgets z3cform archetypes',
     author='Nathan Van Gheem',
     author_email='vangheem@gmail.com',
     url='https://github.com/plone/plone.app.widgets',
-    license='GPL',
     packages=find_packages(),
     namespace_packages=['plone', 'plone.app'],
     include_package_data=True,
     zip_safe=False,
     install_requires=[
-        'setuptools',
-        # needed because we use bundles
-        'Products.ResourceRegistries>=2.1',
-        # nedded because users vocabulary was added here
-        'plone.app.vocabularies>=2.1.12dev',
-        # needed for compatibility with jQuery 1.9+
+        'five.globalrequest',
+        'plone.app.layout',
+        'plone.app.vocabularies',
+        'plone.namedfile',
         'Products.CMFPlone>=5.0.dev0',
-        'five.globalrequest'
+        'Products.ResourceRegistries',
+        'setuptools',
+        'zope.component',
+        'zope.interface',
+        'zope.schema',
     ],
     extras_require={
         'test': [
-            'plone.app.robotframework[debug]',
-            'plone.app.widgets[archetypes, dexterity]',
-            'plone.app.testing>=4.2.4',  # we need ROBOT_TEST_LEVEL
             'mock',
+            'plone.app.robotframework[debug]',
+            'plone.app.testing',
+            'plone.testing',
+            'robotsuite',
         ],
         'archetypes': [
+            'archetypes.schemaextender',
             'DateTime',
             'Products.Archetypes',
-            'archetypes.schemaextender',
         ],
         'dexterity': [
-            'pytz',
             'plone.app.dexterity',
-            'plone.app.contenttypes>=1.1b1',
-            'plone.app.event>=1.2',
+            'pytz',
         ],
     },
     entry_points="""
diff --git a/travis.cfg b/travis.cfg
deleted file mode 100644
index 6b5edf2..0000000
--- a/travis.cfg
+++ /dev/null
@@ -1,24 +0,0 @@
-[buildout]
-extends =
-    https://raw.github.com/collective/buildout.plonetest/master/travis-4.3.x.cfg
-    versions.cfg
-allow-hosts +=
-    code.google.com
-    robotframework.googlecode.com
-package-name = plone.app.widgets
-package-extras = [test,archetypes,dexterity]
-test-eggs = Pillow
-parts += extra
-develop += plone.app.contenttypes
-
-[extra]
-recipe = zc.recipe.egg
-eggs =
-    flake8
-    createcoverage
-    coveralls
-
-[versions]
-coverage = 3.7
-plone.app.robotframework = 0.8.2
-plone.app.contenttypes =
diff --git a/versions.cfg b/versions.cfg
deleted file mode 100644
index 2a4cef6..0000000
--- a/versions.cfg
+++ /dev/null
@@ -1,21 +0,0 @@
-[buildout]
-extends = https://raw.github.com/plone/plone.app.event/1.2.x/versions.cfg
-versions = versions
-
-[versions]
-# Robot Test Env
-plone.app.robotframework = 0.9.4
-robotframework = 2.8.4
-robotframework-selenium2library = 1.5.0
-robotsuite = 1.5.0
-selenium = 2.42.1
-robotframework-selenium2screenshots = 0.4.0
-sphinxcontrib-robotframework = 0.4.3
-robotframework-debuglibrary = 0.3
-# Test Env
-collective.xmltestreport = 1.3.1
-mock = 1.0.1
-zope.testrunner = 4.1.1
-pep8 = 1.4.6
-Babel = 1.3
-Pygments = 1.6


