Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2015-06-27T10:40:10+02:00
Author: Tom Gross (tomgross) <itconsense@gmail.com>
Commit: https://github.com/plone/plone.app.upgrade/commit/3f3324d6d1f7a1a5e3d68190a0d2cdeea1b90397

provide cmfdefault stubs for migration old Plone sites

Files changed:
M plone/app/upgrade/__init__.py
M plone/app/upgrade/bbb.py

diff --git a/plone/app/upgrade/__init__.py b/plone/app/upgrade/__init__.py
index cf0d7ca..23c5cc0 100644
--- a/plone/app/upgrade/__init__.py
+++ b/plone/app/upgrade/__init__.py
@@ -118,6 +118,19 @@ def getNonInstallableProducts(self):
         alias_module('Products.CMFPlone.MetadataTool', metadata)
 
 try:
+    import Products.CMFDefault.MetadataTool
+    Products.CMFDefault.MetadataTool  # pyflakes
+except ImportError:
+    from Products.ATContentTypes.tool import metadata
+    sys.modules['Products.CMFDefault.MetadataTool'] = metadata
+
+try:
+    import Products.CMFDefault.SyndicationInfo
+    Products.CMFDefault.SyndicationInfo  # pyflakes
+except ImportError:
+    sys.modules['Products.CMFDefault.SyndicationInfo'] = bbb
+
+try:
     from Products.PloneLanguageTool import interfaces
 except ImportError:
     alias_module('Products.PloneLanguageTool.interfaces', bbb)
@@ -130,4 +143,4 @@ def getNonInstallableProducts(self):
     from Products.CMFPlacefulWorkflow.interfaces import portal_placeful_workflow
 except:
     from Products.CMFPlacefulWorkflow import interfaces
-    alias_module('Products.CMFPlacefulWorkflow.interfaces.portal_placeful_workflow', interfaces)
\ No newline at end of file
+    alias_module('Products.CMFPlacefulWorkflow.interfaces.portal_placeful_workflow', interfaces)
diff --git a/plone/app/upgrade/bbb.py b/plone/app/upgrade/bbb.py
index 1d5946b..a0c2f45 100644
--- a/plone/app/upgrade/bbb.py
+++ b/plone/app/upgrade/bbb.py
@@ -8,6 +8,7 @@
 DiscussionTool = SimpleItem
 InterfaceTool = SimpleItem
 SyndicationTool = SimpleItem
+SyndicationInfo = SimpleItem
 UndoTool = SimpleItem
 TinyMCE = SimpleItem
 
@@ -64,3 +65,8 @@ def removeActionIcon(self, category, action_id):
         icons.remove(icon)
         del self._lookup[(category, action_id)]
         self._icons = tuple(icons)
+
+# BBB from CMFDefault
+class SyndicationInformation(SimpleItem):
+        id='syndication_information'
+        meta_type='SyndicationInformation'


Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2015-06-27T10:47:33+02:00
Author: Tom Gross (tomgross) <itconsense@gmail.com>
Commit: https://github.com/plone/plone.app.upgrade/commit/0bded19e33cd1d97df2eab4ab4e7701c91231405

remove unused bbb tool

Files changed:
M plone/app/upgrade/bbb.py

diff --git a/plone/app/upgrade/bbb.py b/plone/app/upgrade/bbb.py
index a0c2f45..287de1c 100644
--- a/plone/app/upgrade/bbb.py
+++ b/plone/app/upgrade/bbb.py
@@ -8,7 +8,6 @@
 DiscussionTool = SimpleItem
 InterfaceTool = SimpleItem
 SyndicationTool = SimpleItem
-SyndicationInfo = SimpleItem
 UndoTool = SimpleItem
 TinyMCE = SimpleItem
 


Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2015-06-27T20:44:41+02:00
Author: Timo Stollenwerk (tisto) <tisto@plone.org>
Commit: https://github.com/plone/plone.app.upgrade/commit/2cf8c76031190cc4b7da3a254c09e9028bb516f0

Merge pull request #35 from plone/tomgross-nocmfdefault

Provide cmfdefault stubs for migration old Plone sites

Files changed:
M plone/app/upgrade/__init__.py
M plone/app/upgrade/bbb.py

diff --git a/plone/app/upgrade/__init__.py b/plone/app/upgrade/__init__.py
index cf0d7ca..23c5cc0 100644
--- a/plone/app/upgrade/__init__.py
+++ b/plone/app/upgrade/__init__.py
@@ -118,6 +118,19 @@ def getNonInstallableProducts(self):
         alias_module('Products.CMFPlone.MetadataTool', metadata)
 
 try:
+    import Products.CMFDefault.MetadataTool
+    Products.CMFDefault.MetadataTool  # pyflakes
+except ImportError:
+    from Products.ATContentTypes.tool import metadata
+    sys.modules['Products.CMFDefault.MetadataTool'] = metadata
+
+try:
+    import Products.CMFDefault.SyndicationInfo
+    Products.CMFDefault.SyndicationInfo  # pyflakes
+except ImportError:
+    sys.modules['Products.CMFDefault.SyndicationInfo'] = bbb
+
+try:
     from Products.PloneLanguageTool import interfaces
 except ImportError:
     alias_module('Products.PloneLanguageTool.interfaces', bbb)
@@ -130,4 +143,4 @@ def getNonInstallableProducts(self):
     from Products.CMFPlacefulWorkflow.interfaces import portal_placeful_workflow
 except:
     from Products.CMFPlacefulWorkflow import interfaces
-    alias_module('Products.CMFPlacefulWorkflow.interfaces.portal_placeful_workflow', interfaces)
\ No newline at end of file
+    alias_module('Products.CMFPlacefulWorkflow.interfaces.portal_placeful_workflow', interfaces)
diff --git a/plone/app/upgrade/bbb.py b/plone/app/upgrade/bbb.py
index 1d5946b..287de1c 100644
--- a/plone/app/upgrade/bbb.py
+++ b/plone/app/upgrade/bbb.py
@@ -64,3 +64,8 @@ def removeActionIcon(self, category, action_id):
         icons.remove(icon)
         del self._lookup[(category, action_id)]
         self._icons = tuple(icons)
+
+# BBB from CMFDefault
+class SyndicationInformation(SimpleItem):
+        id='syndication_information'
+        meta_type='SyndicationInformation'


