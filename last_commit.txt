Repository: plone.app.controlpanel
Branch: refs/heads/master
Date: 2015-06-02T19:09:54+02:00
Author: Timo Stollenwerk (tisto) <tisto@plone.org>
Commit: https://github.com/plone/plone.app.controlpanel/commit/64d320f1ca0ff22f218fe1108ba064f78b3744bb

Remove ConfigurationChangedEvent.

Files changed:
M CHANGES.rst
M plone/app/controlpanel/events.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 786abb2..7d77840 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,6 +4,9 @@ Changelog
 3.0.3 (unreleased)
 ------------------
 
+- Remove ConfigurationChangedEvent. Import from new location to keep bbb.
+  [timo]
+
 - Remove RAM control panel (has been moved to p.a.caching).
   [timo]
 
diff --git a/plone/app/controlpanel/events.py b/plone/app/controlpanel/events.py
index 3cfcfb0..309d8e9 100644
--- a/plone/app/controlpanel/events.py
+++ b/plone/app/controlpanel/events.py
@@ -1,21 +1,5 @@
-from zope.component import adapter
-from zope.component import queryUtility
-from zope.interface import implements
-from zope.ramcache.interfaces.ram import IRAMCache
-
-from plone.app.controlpanel.interfaces import IConfigurationChangedEvent
-
-
-class ConfigurationChangedEvent(object):
-    implements(IConfigurationChangedEvent)
-
-    def __init__(self, context, data):
-        self.context = context
-        self.data = data
-
-
-@adapter(IConfigurationChangedEvent)
-def handleConfigurationChangedEvent(event):
-    util = queryUtility(IRAMCache)
-    if util is not None:
-        util.invalidateAll()
+# Control panels for Plone 5 have been moved to CMFPlone. We keep those imports
+# for backwards compatibility.
+from Products.CMFPlone.interfaces import IConfigurationChangedEvent  # noqa
+from Products.CMFPlone.controlpanel.event import ConfigurationChangedEvent  # noqa
+from Products.CMFPlone.controlpanel.event import handleConfigurationChangedEvent  # noqa


Repository: plone.app.controlpanel
Branch: refs/heads/master
Date: 2015-06-02T19:16:51+02:00
Author: Timo Stollenwerk (tisto) <tisto@plone.org>
Commit: https://github.com/plone/plone.app.controlpanel/commit/dbad7227f7cfe0e6eda51f6b26963aa5ee1c2612

Remove unused imports.

Files changed:
M setup.py

diff --git a/setup.py b/setup.py
index 4c2ad2c..702598a 100644
--- a/setup.py
+++ b/setup.py
@@ -28,9 +28,6 @@
       zip_safe=False,
       install_requires=[
         'setuptools',
-        'zope.component',
-        'zope.interface',
-        'zope.ramcache',
         'Products.CMFPlone',
       ],
       extras_require={


Repository: plone.app.controlpanel
Branch: refs/heads/master
Date: 2015-06-02T19:21:30+02:00
Author: Timo Stollenwerk (tisto) <tisto@plone.org>
Commit: https://github.com/plone/plone.app.controlpanel/commit/db9cad1eb303ba94760f47aa825e175320973e7f

Remove event subscriber registration.

Files changed:
M plone/app/controlpanel/configure.zcml

diff --git a/plone/app/controlpanel/configure.zcml b/plone/app/controlpanel/configure.zcml
index 01696f6..759ded6 100644
--- a/plone/app/controlpanel/configure.zcml
+++ b/plone/app/controlpanel/configure.zcml
@@ -5,6 +5,4 @@
 
   <include file="permissions.zcml" />
 
-  <subscriber handler=".events.handleConfigurationChangedEvent" />
-
 </configure>


Repository: plone.app.controlpanel
Branch: refs/heads/master
Date: 2015-06-02T21:00:48+02:00
Author: Timo Stollenwerk (tisto) <tisto@plone.org>
Commit: https://github.com/plone/plone.app.controlpanel/commit/ba1c1e27d872288e667bb1710ac68d6a95f8d22d

Merge pull request #61 from plone/configuration-changed-event

Remove ConfigurationChangedEvent.

Files changed:
M CHANGES.rst
M plone/app/controlpanel/configure.zcml
M plone/app/controlpanel/events.py
M setup.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 786abb2..7d77840 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,6 +4,9 @@ Changelog
 3.0.3 (unreleased)
 ------------------
 
+- Remove ConfigurationChangedEvent. Import from new location to keep bbb.
+  [timo]
+
 - Remove RAM control panel (has been moved to p.a.caching).
   [timo]
 
diff --git a/plone/app/controlpanel/configure.zcml b/plone/app/controlpanel/configure.zcml
index 01696f6..759ded6 100644
--- a/plone/app/controlpanel/configure.zcml
+++ b/plone/app/controlpanel/configure.zcml
@@ -5,6 +5,4 @@
 
   <include file="permissions.zcml" />
 
-  <subscriber handler=".events.handleConfigurationChangedEvent" />
-
 </configure>
diff --git a/plone/app/controlpanel/events.py b/plone/app/controlpanel/events.py
index 3cfcfb0..309d8e9 100644
--- a/plone/app/controlpanel/events.py
+++ b/plone/app/controlpanel/events.py
@@ -1,21 +1,5 @@
-from zope.component import adapter
-from zope.component import queryUtility
-from zope.interface import implements
-from zope.ramcache.interfaces.ram import IRAMCache
-
-from plone.app.controlpanel.interfaces import IConfigurationChangedEvent
-
-
-class ConfigurationChangedEvent(object):
-    implements(IConfigurationChangedEvent)
-
-    def __init__(self, context, data):
-        self.context = context
-        self.data = data
-
-
-@adapter(IConfigurationChangedEvent)
-def handleConfigurationChangedEvent(event):
-    util = queryUtility(IRAMCache)
-    if util is not None:
-        util.invalidateAll()
+# Control panels for Plone 5 have been moved to CMFPlone. We keep those imports
+# for backwards compatibility.
+from Products.CMFPlone.interfaces import IConfigurationChangedEvent  # noqa
+from Products.CMFPlone.controlpanel.event import ConfigurationChangedEvent  # noqa
+from Products.CMFPlone.controlpanel.event import handleConfigurationChangedEvent  # noqa
diff --git a/setup.py b/setup.py
index 4c2ad2c..702598a 100644
--- a/setup.py
+++ b/setup.py
@@ -28,9 +28,6 @@
       zip_safe=False,
       install_requires=[
         'setuptools',
-        'zope.component',
-        'zope.interface',
-        'zope.ramcache',
         'Products.CMFPlone',
       ],
       extras_require={


