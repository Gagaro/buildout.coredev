Repository: mockup


Branch: refs/heads/master
Date: 2015-08-24T13:56:31-05:00
Author: vangheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/mockup/commit/bebbbdbb1c3a88837821922ea046167f74cd2155

change lang set on tinymce before trying to load

Files changed:
M mockup/patterns/tinymce/pattern.js

diff --git a/mockup/patterns/tinymce/pattern.js b/mockup/patterns/tinymce/pattern.js
index 4d9ea50..0fc6cf2 100644
--- a/mockup/patterns/tinymce/pattern.js
+++ b/mockup/patterns/tinymce/pattern.js
@@ -288,7 +288,8 @@ define([
       var self = this;
       var i18n = new I18n();
       var lang = i18n.currentLanguage;
-      if (lang !== 'en' && self.options.tiny.language !== 'en') {
+      if (lang !== 'en' && self.options.tiny.language &&
+          self.options.tiny.languageself.options.tiny.language !== 'en') {
         tinymce.baseURL = self.options.loadingBaseUrl;
         // does the expected language exist?
         $.ajax({


Repository: mockup


Branch: refs/heads/master
Date: 2015-08-24T13:56:57-05:00
Author: vangheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/mockup/commit/cb9d06d1a1f764bf3b81ae312387d6f9e4906600

checkout language with - in addition to _

Files changed:
M CHANGES.rst
M mockup/patterns/tinymce/pattern.js

diff --git a/CHANGES.rst b/CHANGES.rst
index 2d46db0..5a95a9d 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,6 +4,8 @@ Changelog
 2.0.7 (Unreleased)
 ------------------
 
+- checkout tinymce language with - in addition to _
+  [vangheem]
 
 2.0.6 (2015-08-23)
 ------------------
diff --git a/mockup/patterns/tinymce/pattern.js b/mockup/patterns/tinymce/pattern.js
index 0fc6cf2..ce3ee1e 100644
--- a/mockup/patterns/tinymce/pattern.js
+++ b/mockup/patterns/tinymce/pattern.js
@@ -288,8 +288,7 @@ define([
       var self = this;
       var i18n = new I18n();
       var lang = i18n.currentLanguage;
-      if (lang !== 'en' && self.options.tiny.language &&
-          self.options.tiny.languageself.options.tiny.language !== 'en') {
+      if (lang !== 'en-us' && self.options.tiny.language !== 'en') {
         tinymce.baseURL = self.options.loadingBaseUrl;
         // does the expected language exist?
         $.ajax({
@@ -304,7 +303,9 @@ define([
             // expected lang not available, let's fallback to closest one
             if (lang.split('_') > 1){
               lang = lang.split('_')[0];
-            } else {
+            } else if(lang.split('-') > 1){
+              lang = lang.split('-')[0];
+            }else {
               lang = lang + '_' + lang.toUpperCase();
             }
             $.ajax({


