Repository: plone.app.event
Branch: refs/heads/master
Date: 2015-01-28T04:26:38+01:00
Author: Johannes Raggam (thet) <raggam-nl@adm.at>
Commit: https://github.com/plone/plone.app.event/commit/68962d02efd16ceeeef4509b4c1ef26836e04fca

we already have a site object here

Files changed:
M plone/app/event/setuphandlers.py

diff --git a/plone/app/event/setuphandlers.py b/plone/app/event/setuphandlers.py
index 470cbc2..c37b39f 100644
--- a/plone/app/event/setuphandlers.py
+++ b/plone/app/event/setuphandlers.py
@@ -1,7 +1,6 @@
 from Products.CMFCore.utils import getToolByName
 from Products.CMFPlone.interfaces import INonInstallable
 from Products.ZCatalog.Catalog import CatalogError
-from zope.component.hooks import getSite
 from zope.interface import implements
 
 import logging
@@ -34,8 +33,7 @@ def catalog_setup(context):
         emptying-the-indexes-td2302709.html
         https://mail.zope.org/pipermail/zope-cmf/2007-March/025664.html
     """
-    site = getSite()
-    catalog = getToolByName(site, 'portal_catalog')
+    catalog = getToolByName(context, 'portal_catalog')
     date_idxs = ['start', 'end']
     field_idxs = ['sync_uid']
     idxs = date_idxs + field_idxs


