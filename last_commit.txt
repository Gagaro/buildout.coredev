Repository: plone.app.event
Branch: refs/heads/master
Date: 2015-04-06T11:18:48+02:00
Author: Johannes Raggam (thet) <raggam-nl@adm.at>
Commit: https://github.com/plone/plone.app.event/commit/64cd06e253e7f72f5e2e72de2f43c6d32f2a0c76

Fix Plone 4.3 BBB z3c.form portlets to show their fields in Add/Edit Forms.

Files changed:
M CHANGES.rst
M plone/app/event/bbb/portlets/portlet_calendar.py
M plone/app/event/bbb/portlets/portlet_events.py

diff --git a/CHANGES.rst b/CHANGES.rst
index da027bf..6cecf3d 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,7 +4,8 @@ Changelog
 2.0a9 (unreleased)
 ------------------
 
-- Nothing changed yet.
+- Fix Plone 4.3 BBB z3c.form portlets to show their fields in Add/Edit Forms.
+  [thet]
 
 
 2.0a8 (2015-03-26)
diff --git a/plone/app/event/bbb/portlets/portlet_calendar.py b/plone/app/event/bbb/portlets/portlet_calendar.py
index 6e5ba65..7c4ff91 100644
--- a/plone/app/event/bbb/portlets/portlet_calendar.py
+++ b/plone/app/event/bbb/portlets/portlet_calendar.py
@@ -5,6 +5,7 @@
 from plone.app.event.portlets.portlet_calendar import Renderer as RendererBase
 from plone.app.event.portlets.portlet_calendar import ICalendarPortlet
 from plone.app.event.portlets.portlet_calendar import Assignment
+from z3c.form import field
 
 
 class Renderer(RendererBase):
@@ -12,7 +13,7 @@ class Renderer(RendererBase):
 
 
 class AddForm(AddForm):
-    schema = ICalendarPortlet
+    fields = field.Fields(ICalendarPortlet)
     label = _(u"Add Calendar Portlet")
     description = _(u"This portlet displays events in a calendar.")
 
@@ -22,6 +23,6 @@ def create(self, data):
 
 
 class EditForm(EditForm):
-    schema = ICalendarPortlet
+    fields = field.Fields(ICalendarPortlet)
     label = _(u"Edit Calendar Portlet")
     description = _(u"This portlet displays events in a calendar.")
diff --git a/plone/app/event/bbb/portlets/portlet_events.py b/plone/app/event/bbb/portlets/portlet_events.py
index d5a67e5..2fb8abd 100644
--- a/plone/app/event/bbb/portlets/portlet_events.py
+++ b/plone/app/event/bbb/portlets/portlet_events.py
@@ -5,6 +5,7 @@
 from plone.app.event.portlets.portlet_events import Renderer as RendererBase
 from plone.app.event.portlets.portlet_events import Assignment
 from plone.app.event.portlets.portlet_events import IEventsPortlet
+from z3c.form import field
 
 
 class Renderer(RendererBase):
@@ -12,7 +13,7 @@ class Renderer(RendererBase):
 
 
 class AddForm(AddForm):
-    schema = IEventsPortlet
+    fields = field.Fields(IEventsPortlet)
     label = _(u"Add Events Portlet")
     description = _(u"This portlet lists upcoming Events.")
 
@@ -23,6 +24,6 @@ def create(self, data):
 
 
 class EditForm(EditForm):
-    schema = IEventsPortlet
+    fields = field.Fields(IEventsPortlet)
     label = _(u"Edit Events Portlet")
     description = _(u"This portlet lists upcoming Events.")


